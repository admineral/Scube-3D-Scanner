[
    {
        "id": "24aea6a1f2b6cc9a",
        "type": "tab",
        "label": "Flow 1",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "68819360.7e7a7c",
        "type": "tab",
        "label": "HOME",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d6a01399.60299",
        "type": "tab",
        "label": "Scan",
        "disabled": false,
        "info": ""
    },
    {
        "id": "67f0d11b.66aa4",
        "type": "tab",
        "label": "SETTINGS",
        "disabled": false,
        "info": ""
    },
    {
        "id": "532cea09.a25754",
        "type": "tab",
        "label": "Cloud",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a6098217.f379a",
        "type": "tab",
        "label": "DEV",
        "disabled": false,
        "info": ""
    },
    {
        "id": "b5b8f2c0.a6c37",
        "type": "group",
        "z": "68819360.7e7a7c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2f984eaf.bf7712",
            "40ee18a5.154a38",
            "ca7a3a98.d4d7f8",
            "7f325f05ab398112"
        ],
        "x": 34,
        "y": 379,
        "w": 592,
        "h": 169.5
    },
    {
        "id": "2ee92a1b.bee026",
        "type": "group",
        "z": "68819360.7e7a7c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "8284268a.5399e8",
            "c71c9170.f39d5",
            "61578186.d7bfe",
            "7dcc8efb.55029",
            "964602a5.ecf32",
            "145315bb.4e8f0a",
            "888f6424.093d78",
            "9ab2b4e977cca6a8",
            "61751c895e6ca8b5",
            "8c08e0614548e4ce",
            "2d552e2d20489f97"
        ],
        "x": 34,
        "y": 579,
        "w": 952,
        "h": 322
    },
    {
        "id": "21befd58.4401b2",
        "type": "group",
        "z": "68819360.7e7a7c",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4468f691.103eb8",
            "71e72293.91c6fc",
            "df736dcd.e9d38",
            "6560dd25.9e76c4",
            "c7cc1ead.02ead",
            "62cd5288.2805fc",
            "4e47fd3c.83c3d4",
            "852a6dc5.03581",
            "784b4bc6.8d6554",
            "e2e540063faed578"
        ],
        "x": -6,
        "y": 39,
        "w": 462,
        "h": 322
    },
    {
        "id": "26bbdfab.4ebb8",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "e297634f.a71fa",
            "ca9d060f.7ee2a8",
            "aea94ca3.912d",
            "6ed6b9f1.a35c98"
        ],
        "x": 14,
        "y": 39,
        "w": 412,
        "h": 202
    },
    {
        "id": "fe5237f3.2ced18",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2e854876.6b6008",
            "753817f.1b9b3e8",
            "10c3cc83.9a21c3",
            "fbe7dd6b.9782a",
            "9905e0c9.dddcd",
            "555aea34.b3b5e4",
            "46e00b45.c24ca4",
            "86cb4051.17bc5",
            "4de0d2e8.af244c",
            "a8e4056f.671c58",
            "dfa6b870.f875b8"
        ],
        "x": -6,
        "y": 259,
        "w": 602,
        "h": 222
    },
    {
        "id": "e4c78b7f.009588",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "828e5298.d2192",
            "96c7e241.458e6",
            "65ca15d6.b4bfbc",
            "b12e54fb.3141b8",
            "37f52dd4.bd7572",
            "ffb2f29a.22a84",
            "6ab04bf9.304b34",
            "8ed4a4f6.4e9ba8",
            "686d6d27.bfd1c4",
            "e7ba40b3.31032",
            "b4a7a5c3.1d7f58"
        ],
        "x": 594,
        "y": 259,
        "w": 602,
        "h": 222
    },
    {
        "id": "cc8c79d0.d5b758",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "a238d4b1.ddd428",
            "65c0518f.4b72b",
            "ebdb99aa.b6bc68",
            "c40709cc.d9c6b8",
            "3138623e.98929e",
            "852e46e0.9d80b8",
            "15b9ddd0.2cf282"
        ],
        "x": 554,
        "y": 1059,
        "w": 1152,
        "h": 162
    },
    {
        "id": "2b48318d.37064e",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "ec55861d.db0c88",
            "d098c652.525408",
            "f472b69d.2b2b38"
        ],
        "x": 274,
        "y": 919,
        "w": 452,
        "h": 122
    },
    {
        "id": "c36493cc.c72b9",
        "type": "group",
        "z": "532cea09.a25754",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "9bdd12b5.e099",
            "9de4ca9e.c03d88",
            "84cf9870.619df8",
            "ae83845d.58a6a8",
            "fa9287d.2e4b078",
            "80adb53.3844e48",
            "51413076.9b8a6",
            "47df48b0.f98908"
        ],
        "x": 644,
        "y": 119,
        "w": 682,
        "h": 242
    },
    {
        "id": "d58bec1.b1df91",
        "type": "group",
        "z": "532cea09.a25754",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "19313347.fdbe8d",
            "97f788a9.0c4a38",
            "9d2c7f38.d9c95",
            "3ceb5b3.b4f9da4"
        ],
        "x": 1454,
        "y": 59,
        "w": 432,
        "h": 162
    },
    {
        "id": "1276227.fd896de",
        "type": "group",
        "z": "532cea09.a25754",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "d42a47c7.c0df68",
            "fb3e8df1.449ae",
            "ffe78092.30b5",
            "8e437831.caf498",
            "d2f21710.8fbd08"
        ],
        "x": 54,
        "y": 399,
        "w": 402,
        "h": 162
    },
    {
        "id": "7e6ff6c1.11bca8",
        "type": "group",
        "z": "532cea09.a25754",
        "name": "",
        "style": {
            "label": true
        },
        "nodes": [
            "952ce286.4ffd4",
            "8e6e7577.f92658",
            "86e2a44b.335988",
            "8860b3ad.2454d",
            "4ebec302.cde32c"
        ],
        "x": 54,
        "y": 59,
        "w": 502,
        "h": 162
    },
    {
        "id": "90cae723.bb1b28",
        "type": "group",
        "z": "532cea09.a25754",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "1f94d0f5.7da73f",
            "8e81c129.2ebe2",
            "1d1a0978.f12367",
            "7c55acb.95f4e54",
            "255773b8.d57dbc",
            "e9dade29.1e9f9",
            "de8cf887.5d3488",
            "7f91bfd6.00e12",
            "86d5d435.aaa058",
            "c91096fb.56d5d8",
            "3e90dc6c.c8b9a4"
        ],
        "x": 494,
        "y": 399,
        "w": 1032,
        "h": 162
    },
    {
        "id": "54e0acc4.d07814",
        "type": "group",
        "z": "a6098217.f379a",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "cc7bed05.bbd98",
            "1ee53eb5.a8f111",
            "c4023e41.a139b",
            "3abe5dce.856282",
            "a2b8192b.cde238"
        ],
        "x": 34,
        "y": 19,
        "w": 452,
        "h": 182
    },
    {
        "id": "f5f62925.b192f8",
        "type": "group",
        "z": "a6098217.f379a",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "2f5b5fbb.ef085",
            "f0ff2aee.c30f58"
        ],
        "x": 34,
        "y": 679,
        "w": 452,
        "h": 82
    },
    {
        "id": "77ae0818.c9dc48",
        "type": "group",
        "z": "a6098217.f379a",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "4a811291.104e2c",
            "fa6b9cd2.79985",
            "3a9769d9.41eb06",
            "78e72bd8.ec0b74",
            "67ceb623.164d18",
            "7d4e3174.de9e7"
        ],
        "x": 54,
        "y": 239,
        "w": 552,
        "h": 202
    },
    {
        "id": "3241690b.e2fcf6",
        "type": "group",
        "z": "a6098217.f379a",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "e9c00d10.7b867",
            "464cad24.43dff4",
            "916ee39b.c4638"
        ],
        "x": 34,
        "y": 519,
        "w": 712,
        "h": 82
    },
    {
        "id": "632555a4.fd0bac",
        "type": "group",
        "z": "67f0d11b.66aa4",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "c209f680.dfd5a8",
            "5ef49f08.9fd5d",
            "4c5cd254.e6013c",
            "54defe41.1ae97",
            "e9e65bd8.deaae8"
        ],
        "x": -16,
        "y": 19,
        "w": 402,
        "h": 202
    },
    {
        "id": "780ad3b2.21864c",
        "type": "group",
        "z": "67f0d11b.66aa4",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "adb3a465.1c23d8",
            "fe90af7b.bcdc1",
            "3e9d2ca4.953d44",
            "19bc6938.44e717",
            "bc8e5552.04ba68",
            "4bfb5998.ef1028",
            "b856e02b.b64f3",
            "902ef50a.bfd568",
            "ef791d9e.6ee85",
            "aa0eb2e8.2ba11"
        ],
        "x": 1294,
        "y": 79,
        "w": 592,
        "h": 249.5
    },
    {
        "id": "f520521a.b21ff",
        "type": "group",
        "z": "67f0d11b.66aa4",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "9afad387.0e93f",
            "52440334.0fa80c",
            "596b6655.6f8c18",
            "33383870.fb78e8",
            "f493cf3d.8cb4a",
            "9bc0f8b9.3b1738",
            "b5fd55b5.a6ae18",
            "7e0d26a0.e32c08",
            "1e8187ab.c4a128",
            "31c3fea3.6d1bd2",
            "686dc68e.f6e288",
            "e1c7c026.bf90c",
            "35f7bc9e.5f2d74",
            "6091cb32.1af884",
            "dc03a256.9663c",
            "f1f94da9.f8452",
            "1004ce1b.008b12",
            "801f7988.6f4348"
        ],
        "x": 14,
        "y": 239,
        "w": 932,
        "h": 422
    },
    {
        "id": "81f86951.28d478",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "46b01c53.852804",
            "156d06fb.5fcc09",
            "72f22443.47540c",
            "5c70841c.453fac",
            "eb7b1c6d.ce192"
        ],
        "x": 34,
        "y": 499,
        "w": 832,
        "h": 142
    },
    {
        "id": "c5a87acb.2d7258",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "7b8b5ab2.f17ee4",
            "6bf17a51.1a8844",
            "979e4f10.31314",
            "b623ca34.f4e488",
            "8deca115.73c88",
            "a9d6c524.8990b8",
            "104ac669.d1160a",
            "16692560.d48c8b",
            "759846e8.01b538",
            "40afd3cf.b6b4cc",
            "2974ae60f5b2eca9",
            "5819207a55ccd754",
            "fe3246c2351e7cbb",
            "8d312a890fbd0e6d",
            "20cc02855e2a7b40",
            "e01bae156ad54612",
            "3768c653b0e5c1ae",
            "f60d784c.88f6d8"
        ],
        "x": 934,
        "y": 499,
        "w": 812,
        "h": 342
    },
    {
        "id": "fbe1e58a2ba80e36",
        "type": "group",
        "z": "67f0d11b.66aa4",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "8e5e954db3bec3bc",
            "082f6653ea34c6d0",
            "b2d3919e883ce870",
            "89c5230797ea08aa",
            "1e3bfe6362045db2",
            "6782bc5957411d6a",
            "5f8a866eeca48ab8",
            "3507f052e7328dab",
            "07aaf176f2b4e0cd",
            "b32358f38d248d1c",
            "55741069fe2723a2",
            "801924b0968270b0",
            "61beec273e8ee1b9",
            "3e2b69276152a7d5",
            "8264d51e457ff7ad",
            "7ad7618d5308df4e",
            "de39c68c1dde58b1",
            "edecc8ccc4ae714e",
            "809f525e6cf42ad4",
            "74002c45a26113ee",
            "511bc167badd5155",
            "df0f8b1e2cc46166",
            "303ef632ab444a09",
            "8f2fdf57d5d6bbef",
            "55e28d9e425c9da0"
        ],
        "x": -6,
        "y": 699,
        "w": 1252,
        "h": 442
    },
    {
        "id": "87a6529f71d7ae01",
        "type": "group",
        "z": "d6a01399.60299",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "8265a779.7254d8",
            "db82b5fd74d771b3",
            "6871644ce96e1e27",
            "483bcbc7ec272ddb",
            "e4bd7fedee38e794",
            "496869b0b03df90b",
            "9d3dece4a4dacb19",
            "4e9f6f15e27a0784",
            "04513ebedf681ee9",
            "428f658908e16c12",
            "76fafda05615d739"
        ],
        "x": 1224,
        "y": 239,
        "w": 762,
        "h": 262
    },
    {
        "id": "f15aaf51.f4429",
        "type": "ui_base",
        "theme": {
            "name": "theme-custom",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#495055",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#041e48",
                "baseFont": "Arial Black,Arial Black,Gadget,sans-serif",
                "reset": false
            },
            "themeState": {
                "base-color": {
                    "default": "#041e48",
                    "value": "#041e48",
                    "edited": true
                },
                "page-titlebar-backgroundColor": {
                    "value": "#041e48",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#050505",
                    "edited": true
                },
                "page-sidebar-backgroundColor": {
                    "value": "#000000",
                    "edited": true
                },
                "group-textColor": {
                    "value": "#083c90",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#000000",
                    "edited": true
                },
                "group-backgroundColor": {
                    "value": "#000000",
                    "edited": true
                },
                "widget-textColor": {
                    "value": "#eeeeee",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#11418d",
                    "edited": true
                },
                "widget-borderColor": {
                    "value": "#000000",
                    "edited": true
                },
                "base-font": {
                    "value": "Arial Black,Arial Black,Gadget,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "",
            "hideToolbar": "true",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "c19e2c9e.f4b99",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 8,
        "height": 1
    },
    {
        "id": "75afd9cb.6a3ed8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "e49ddca1.744a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "987b4012.f9a07",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 5,
        "width": 6,
        "height": 1
    },
    {
        "id": "caea0d6c.4e75",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "3fadc6db.3997ea",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 1,
        "height": 1
    },
    {
        "id": "f5864201.8e5ff",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "9c6a04ac.e760a8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 1,
        "height": 1
    },
    {
        "id": "bb5bfba5.b3b7b8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 8,
        "height": 1
    },
    {
        "id": "79b73861.bb6048",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 11,
        "width": 8,
        "height": 1
    },
    {
        "id": "1ecaa9e9.4192e6",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "e58f9de6.10904",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "924edf62.f208d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "1303ee2a.fd44f2",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "5d12f9cd.9c4a88",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 5,
        "width": 6,
        "height": 1
    },
    {
        "id": "88a2f658.ac2378",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 6,
        "height": 1
    },
    {
        "id": "ddbd496e.93a288",
        "type": "ui_group",
        "name": "Manage Updates",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "436c5312.8bd37c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 3,
        "height": 1
    },
    {
        "id": "76c2902a.e0813",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 3,
        "height": 1
    },
    {
        "id": "e3c989ac.ead728",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 6,
        "height": 1
    },
    {
        "id": "b9e9bd43.5257f",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "d77de880.1a5308",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "2da4bd3.c2b1042",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 6,
        "height": 1
    },
    {
        "id": "9f0a90cb.629f4",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 7,
        "width": 6,
        "height": 1
    },
    {
        "id": "120b6320.a5e22d",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 9,
        "width": 9,
        "height": 1
    },
    {
        "id": "1b856f2d.ee2f81",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 20,
        "width": 9,
        "height": 1
    },
    {
        "id": "fb2c4085.a4745",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 6,
        "height": 1
    },
    {
        "id": "45252825.fee608",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 9,
        "width": 6,
        "height": 1
    },
    {
        "id": "ad9b6a27.771fb8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 12,
        "width": 6,
        "height": 1
    },
    {
        "id": "b69edebc.8b32b",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 19,
        "width": 6,
        "height": 1
    },
    {
        "id": "453edabd.318834",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 6,
        "height": 1
    },
    {
        "id": "31161d86.3baa62",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 6,
        "height": 1
    },
    {
        "id": "feedb515.8ba2a8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 6,
        "height": 1
    },
    {
        "id": "58ec052e.d6a8ec",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 7,
        "width": 6,
        "height": 1
    },
    {
        "id": "ebb9ea9b.845978",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 5,
        "width": 5,
        "height": 1
    },
    {
        "id": "404f41e6.f5a04",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 7,
        "width": 5,
        "height": 1
    },
    {
        "id": "10d8d56.f5d9f2b",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "c3ea9d05.8cf78",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "8df9a49e.afb168",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "faa2aaa7.b50e98",
        "type": "ui_tab",
        "name": "Home",
        "icon": "dashboard",
        "order": 1,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "3be89360.d049cc",
        "type": "ui_group",
        "name": "Home",
        "tab": "faa2aaa7.b50e98",
        "order": 1,
        "disp": false,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "82fa21b6.fb85e",
        "type": "ui_tab",
        "name": "Settings",
        "icon": "dashboard",
        "order": 4,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "bb1dd00e.a62b9",
        "type": "ui_group",
        "name": "General",
        "tab": "82fa21b6.fb85e",
        "order": 4,
        "disp": false,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "6a63d9e3.95e668",
        "type": "ui_group",
        "name": "Network",
        "tab": "82fa21b6.fb85e",
        "order": 2,
        "disp": false,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "61d79297.21257c",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "b961bcf7.823e3",
        "order": 2,
        "width": 1,
        "height": 1
    },
    {
        "id": "e6f493e3.fca36",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "69964d6a.08a804",
        "order": 3,
        "width": 1,
        "height": 1
    },
    {
        "id": "8c3a2020.a3c41",
        "type": "ui_tab",
        "name": "Camera",
        "icon": "dashboard",
        "order": 2,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "a3116208.14508",
        "type": "ui_group",
        "name": "Main",
        "tab": "8c3a2020.a3c41",
        "order": 2,
        "disp": false,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "e8b6a9ce.c333b8",
        "type": "ui_group",
        "name": "Files",
        "tab": "a83309b6.f8b308",
        "order": 2,
        "disp": false,
        "width": "18",
        "collapse": false,
        "className": ""
    },
    {
        "id": "a83309b6.f8b308",
        "type": "ui_tab",
        "name": "Files",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "5454a77c.a587d8",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 1,
        "width": 6,
        "height": 1
    },
    {
        "id": "d5240292.8c8b5",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 2,
        "width": 6,
        "height": 1
    },
    {
        "id": "ddad0159.b0b4b",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 3,
        "width": 3,
        "height": 1
    },
    {
        "id": "a50661bc.1fa49",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 5,
        "width": 1,
        "height": 1
    },
    {
        "id": "384b7d50.06da52",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 6,
        "width": 6,
        "height": 1
    },
    {
        "id": "30a6ca20.ffc1c6",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "",
        "order": 8,
        "width": 4,
        "height": 1
    },
    {
        "id": "de6b8056.e888a",
        "type": "ui_spacer",
        "name": "spacer",
        "group": "ddbd496e.93a288",
        "order": 5,
        "width": 6,
        "height": 1
    },
    {
        "id": "b5fdd57b.15eda8",
        "type": "ui_group",
        "name": "Main",
        "tab": "15a222ed.d70a7d",
        "order": 2,
        "disp": false,
        "width": 18,
        "collapse": false
    },
    {
        "id": "db43d646.2074c8",
        "type": "ui_group",
        "name": "OpenScanCloud",
        "tab": "15a222ed.d70a7d",
        "order": 3,
        "disp": true,
        "width": 9,
        "collapse": false
    },
    {
        "id": "88570d39.c5b25",
        "type": "ui_group",
        "name": "OpenScanCloud Settings",
        "tab": "15a222ed.d70a7d",
        "order": 4,
        "disp": true,
        "width": "9",
        "collapse": true,
        "className": ""
    },
    {
        "id": "15a222ed.d70a7d",
        "type": "ui_tab",
        "name": "Files&Cloud",
        "icon": "dashboard",
        "order": 3,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "e7368151.9add3",
        "type": "ui_tab",
        "name": "DEV",
        "icon": "dashboard",
        "order": 7,
        "disabled": false,
        "hidden": false
    },
    {
        "id": "4cc9cd95.16ff14",
        "type": "ui_group",
        "name": "Main",
        "tab": "e7368151.9add3",
        "order": 1,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c4d6e8f2.7f36c8",
        "type": "ui_group",
        "name": "Home",
        "tab": "a83309b6.f8b308",
        "order": 1,
        "disp": false,
        "width": "2",
        "collapse": false,
        "className": ""
    },
    {
        "id": "e432a584.092ce8",
        "type": "ui_spacer",
        "z": "68819360.7e7a7c",
        "name": "spacer",
        "group": "e8b6a9ce.c333b8",
        "order": 1,
        "width": 18,
        "height": 1
    },
    {
        "id": "625c22fc.6d654c",
        "type": "ui_spacer",
        "z": "68819360.7e7a7c",
        "name": "spacer",
        "group": "e8b6a9ce.c333b8",
        "order": 3,
        "width": 5,
        "height": 1
    },
    {
        "id": "c0c6da8d.8f76d8",
        "type": "ui_spacer",
        "z": "68819360.7e7a7c",
        "name": "spacer",
        "group": "e8b6a9ce.c333b8",
        "order": 5,
        "width": 5,
        "height": 1
    },
    {
        "id": "c03d4ec5.8f924",
        "type": "ui_spacer",
        "z": "68819360.7e7a7c",
        "name": "spacer",
        "group": "e8b6a9ce.c333b8",
        "order": 6,
        "width": 5,
        "height": 1
    },
    {
        "id": "df0f05c0.0a1468",
        "type": "ui_spacer",
        "z": "68819360.7e7a7c",
        "name": "spacer",
        "group": "e8b6a9ce.c333b8",
        "order": 8,
        "width": 5,
        "height": 1
    },
    {
        "id": "2ef46cc5.cfde94",
        "type": "ui_group",
        "name": "Home",
        "tab": "15a222ed.d70a7d",
        "order": 1,
        "disp": false,
        "width": "2",
        "collapse": false,
        "className": ""
    },
    {
        "id": "95577a4.4466488",
        "type": "ui_group",
        "name": "Home",
        "tab": "82fa21b6.fb85e",
        "order": 1,
        "disp": false,
        "width": 2,
        "collapse": false,
        "className": ""
    },
    {
        "id": "f80a07a5.54dd98",
        "type": "ui_group",
        "name": "Status",
        "tab": "82fa21b6.fb85e",
        "order": 3,
        "disp": true,
        "width": 18,
        "collapse": false,
        "className": ""
    },
    {
        "id": "c5d3acc.06a805",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "6a63d9e3.95e668",
        "order": 4,
        "width": 5,
        "height": 1
    },
    {
        "id": "63a5ea2.faed514",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "6a63d9e3.95e668",
        "order": 5,
        "width": 3,
        "height": 1
    },
    {
        "id": "95a62d3f.ecf29",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "6a63d9e3.95e668",
        "order": 7,
        "width": 10,
        "height": 1
    },
    {
        "id": "78d1fdd7.22bd44",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "f80a07a5.54dd98",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "6bc9c10e.1104c",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "f80a07a5.54dd98",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "744dfecf.3749",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "bb1dd00e.a62b9",
        "order": 4,
        "width": 5,
        "height": 1
    },
    {
        "id": "796e431.1e116bc",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "bb1dd00e.a62b9",
        "order": 6,
        "width": 1,
        "height": 1
    },
    {
        "id": "314b6485.ef43bc",
        "type": "ui_spacer",
        "z": "67f0d11b.66aa4",
        "name": "spacer",
        "group": "bb1dd00e.a62b9",
        "order": 8,
        "width": 5,
        "height": 1
    },
    {
        "id": "2e578dc9.f58952",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "db43d646.2074c8",
        "order": 2,
        "width": 4,
        "height": 1
    },
    {
        "id": "258b8cd1.e45e14",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "db43d646.2074c8",
        "order": 4,
        "width": 1,
        "height": 1
    },
    {
        "id": "39ce18.cb5c01e8",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "db43d646.2074c8",
        "order": 7,
        "width": 1,
        "height": 1
    },
    {
        "id": "2a36501f.ddc9b",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "db43d646.2074c8",
        "order": 9,
        "width": 1,
        "height": 1
    },
    {
        "id": "71274d9.9387cb4",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 2,
        "width": 16,
        "height": 1
    },
    {
        "id": "d3cad1ac.732c3",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 5,
        "width": 6,
        "height": 1
    },
    {
        "id": "80b6a8a9.5c1858",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 6,
        "width": 2,
        "height": 1
    },
    {
        "id": "c67dff2a.3ce16",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 8,
        "width": 2,
        "height": 1
    },
    {
        "id": "1a4236b9.f84299",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 9,
        "width": 2,
        "height": 1
    },
    {
        "id": "d76fee16.c9234",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 12,
        "width": 7,
        "height": 1
    },
    {
        "id": "454c8b11.7d1da4",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 13,
        "width": 1,
        "height": 1
    },
    {
        "id": "b4c4804e.1a941",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 15,
        "width": 2,
        "height": 1
    },
    {
        "id": "99f84d3d.d86c9",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 17,
        "width": 1,
        "height": 1
    },
    {
        "id": "f921007b.26ee2",
        "type": "ui_spacer",
        "z": "a6098217.f379a",
        "name": "spacer",
        "group": "4cc9cd95.16ff14",
        "order": 18,
        "width": 1,
        "height": 1
    },
    {
        "id": "3d882eae.376e82",
        "type": "ui_group",
        "name": "New Message",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "1ea34d06.1438c3",
        "type": "ui_group",
        "name": "Default",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": "6",
        "collapse": true
    },
    {
        "id": "61d2dced.3db8f4",
        "type": "ui_group",
        "name": "flowtest",
        "tab": "",
        "order": 1,
        "disp": true,
        "width": 16,
        "collapse": false
    },
    {
        "id": "8c6774a4.06e158",
        "type": "ui_group",
        "name": "Default",
        "tab": "",
        "order": 2,
        "disp": true,
        "width": "6",
        "collapse": false
    },
    {
        "id": "cb70a370.3e4ea",
        "type": "ui_spacer",
        "z": "68819360.7e7a7c",
        "name": "spacer",
        "group": "83083b94.7e1958",
        "order": 2,
        "width": 4,
        "height": 1
    },
    {
        "id": "fb90022.6acec",
        "type": "ui_group",
        "name": "Group 2",
        "tab": "",
        "order": 2,
        "disp": true,
        "width": 6
    },
    {
        "id": "c2dede7.492a52",
        "type": "ui_group",
        "name": "Group 3",
        "tab": "",
        "order": 3,
        "disp": true,
        "width": 6
    },
    {
        "id": "9ee9035c.f1732",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 2,
        "width": 15,
        "height": 1
    },
    {
        "id": "b9f050af.7bbad",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 4,
        "width": 18,
        "height": 1
    },
    {
        "id": "eae6e59c.1464a8",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 5,
        "width": 3,
        "height": 1
    },
    {
        "id": "c12b9124.b8efb",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 7,
        "width": 4,
        "height": 1
    },
    {
        "id": "9735a17a.5a4a8",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 9,
        "width": 3,
        "height": 1
    },
    {
        "id": "cba97f3b.a31f1",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 10,
        "width": 3,
        "height": 1
    },
    {
        "id": "5fd83407.29b03c",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 11,
        "width": 4,
        "height": 1
    },
    {
        "id": "35396343.5b8b3c",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 12,
        "width": 3,
        "height": 1
    },
    {
        "id": "4ab8a641.68d048",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 13,
        "width": 3,
        "height": 1
    },
    {
        "id": "69193c2d.c874b4",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 14,
        "width": 4,
        "height": 1
    },
    {
        "id": "90cb4767.44ce38",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 15,
        "width": 3,
        "height": 1
    },
    {
        "id": "883fc4e4.5346f8",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 16,
        "width": 18,
        "height": 1
    },
    {
        "id": "c2c74fb4.a4b98",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 17,
        "width": 3,
        "height": 1
    },
    {
        "id": "515f0237.fdf94c",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 19,
        "width": 4,
        "height": 1
    },
    {
        "id": "d06ede88.1d46d",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 21,
        "width": 3,
        "height": 1
    },
    {
        "id": "91dcf622.48f778",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 22,
        "width": 3,
        "height": 1
    },
    {
        "id": "161d30b0.4854af",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 23,
        "width": 4,
        "height": 1
    },
    {
        "id": "2424ab48.a637a4",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 24,
        "width": 3,
        "height": 1
    },
    {
        "id": "3f6cbe1b.6b0d02",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 25,
        "width": 3,
        "height": 1
    },
    {
        "id": "c9f58a9c.210878",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 26,
        "width": 4,
        "height": 1
    },
    {
        "id": "d37ca939.ae2fb8",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "3be89360.d049cc",
        "order": 27,
        "width": 3,
        "height": 1
    },
    {
        "id": "189a50ad0e14bb28",
        "type": "ui_group",
        "name": "OpenScanCloud",
        "tab": "82fa21b6.fb85e",
        "order": 5,
        "disp": true,
        "width": "6",
        "collapse": true,
        "className": ""
    },
    {
        "id": "818b3394a53efb11",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 3,
        "width": 8,
        "height": 1
    },
    {
        "id": "5397d1513b161d3e",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 4,
        "width": 2,
        "height": 1
    },
    {
        "id": "e7ac3ba20b0636e5",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 6,
        "width": 2,
        "height": 1
    },
    {
        "id": "49a8c20a079686c2",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 10,
        "width": 2,
        "height": 1
    },
    {
        "id": "4c6f1b0982f23881",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 12,
        "width": 2,
        "height": 1
    },
    {
        "id": "b486eca9cc1bc8c2",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 14,
        "width": 2,
        "height": 1
    },
    {
        "id": "641553826a2ec187",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 15,
        "width": 2,
        "height": 1
    },
    {
        "id": "d04fe7e0b0326079",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 16,
        "width": 2,
        "height": 1
    },
    {
        "id": "5bed41c9272b2e9c",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 17,
        "width": 2,
        "height": 1
    },
    {
        "id": "48767ff654610e49",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 18,
        "width": 2,
        "height": 1
    },
    {
        "id": "20ef493ad2a84ca9",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 19,
        "width": 2,
        "height": 1
    },
    {
        "id": "2e085f2c8fdd6041",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 21,
        "width": 1,
        "height": 1
    },
    {
        "id": "e9ebb3f59c20ce23",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 23,
        "width": 2,
        "height": 1
    },
    {
        "id": "21d5748dd3a3a1ac",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 25,
        "width": 2,
        "height": 1
    },
    {
        "id": "722ebbf9e04f1818",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 27,
        "width": 3,
        "height": 1
    },
    {
        "id": "3613d6d0bb780ff0",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 28,
        "width": 2,
        "height": 1
    },
    {
        "id": "5ebcb999ab27aeb4",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 30,
        "width": 2,
        "height": 1
    },
    {
        "id": "0d6369aebc6db30b",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 31,
        "width": 2,
        "height": 1
    },
    {
        "id": "e07bfc89e76b8c29",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 33,
        "width": 2,
        "height": 1
    },
    {
        "id": "df75e4df3c108170",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 34,
        "width": 18,
        "height": 1
    },
    {
        "id": "0ac7a60d6cdac8fb",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 35,
        "width": 18,
        "height": 1
    },
    {
        "id": "3be67c9f7400f32a",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 36,
        "width": 18,
        "height": 1
    },
    {
        "id": "6d2755cc98352c33",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 37,
        "width": 18,
        "height": 1
    },
    {
        "id": "c5f3d7589c68d1e0",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 38,
        "width": 18,
        "height": 1
    },
    {
        "id": "b97f754c6dc3777f",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 39,
        "width": 18,
        "height": 1
    },
    {
        "id": "ec2eaf5696ad4c22",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 40,
        "width": 18,
        "height": 1
    },
    {
        "id": "21d7979c0c8ff4f4",
        "type": "ui_spacer",
        "z": "d6a01399.60299",
        "name": "spacer",
        "group": "a3116208.14508",
        "order": 41,
        "width": 15,
        "height": 1
    },
    {
        "id": "8284268a.5399e8",
        "type": "inject",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0",
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 140,
        "y": 700,
        "wires": [
            [
                "c71c9170.f39d5",
                "9ab2b4e977cca6a8",
                "61751c895e6ca8b5"
            ]
        ]
    },
    {
        "id": "964602a5.ecf32",
        "type": "exec",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "command": "sudo chmod -R 777 /home/pi/shared/",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "set privileges",
        "x": 890,
        "y": 680,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "61578186.d7bfe",
        "type": "python3-function",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "create path",
        "func": "import os.path\nimport os\nflag=False\n\ndef new_path(path):\n    if(os.path.exists(path)==False):\n        os.mkdir(path)\n        flag=True\n    else:\n        pass\n\nnew_path(\"/home/pi/shared/\")\nnew_path(\"/home/pi/shared/ui\")\nnew_path(\"/home/pi/shared/ui/data\")\nnew_path(\"/home/pi/shared/ui/data/old_flows\")\nnew_path(\"/home/pi/shared/ui/data/zip\")\nnew_path(\"/home/pi/shared/ui/data/temp\")\nnew_path(\"/home/pi/shared/log\")\n\n\nif flag==True:\n    os.system(\"sudo systemctl restart nodered\")\nreturn msg",
        "outputs": 1,
        "x": 430,
        "y": 700,
        "wires": [
            [
                "7dcc8efb.55029"
            ]
        ]
    },
    {
        "id": "4468f691.103eb8",
        "type": "ui_button",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "Camera",
        "group": "3be89360.d049cc",
        "order": 6,
        "width": 4,
        "height": 3,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-5x fa-camera",
        "payload": "1",
        "payloadType": "num",
        "topic": "",
        "topicType": "str",
        "x": 120,
        "y": 160,
        "wires": [
            [
                "62cd5288.2805fc"
            ]
        ]
    },
    {
        "id": "6560dd25.9e76c4",
        "type": "ui_button",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "Settings",
        "group": "3be89360.d049cc",
        "order": 1,
        "width": 1,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-cog",
        "payload": "4",
        "payloadType": "num",
        "topic": "",
        "topicType": "str",
        "x": 120,
        "y": 320,
        "wires": [
            [
                "62cd5288.2805fc"
            ]
        ]
    },
    {
        "id": "62cd5288.2805fc",
        "type": "ui_ui_control",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "",
        "events": "change",
        "x": 320,
        "y": 200,
        "wires": [
            [
                "4e47fd3c.83c3d4"
            ]
        ]
    },
    {
        "id": "71e72293.91c6fc",
        "type": "ui_button",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "Files",
        "group": "3be89360.d049cc",
        "order": 20,
        "width": 4,
        "height": 3,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-5x fa-folder-open",
        "payload": "2",
        "payloadType": "num",
        "topic": "",
        "topicType": "str",
        "x": 110,
        "y": 200,
        "wires": [
            [
                "62cd5288.2805fc"
            ]
        ]
    },
    {
        "id": "7dcc8efb.55029",
        "type": "python3-function",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "create new files + content",
        "func": "import os.path\nfrom time import sleep\nimport os\n\nflag=False\n\ndef new_file(filepath,content):\n    if os.path.isfile(filepath):\n        if os.stat(filepath).st_size==0:\n            with open(filepath, \"w\") as file:\n                file.write(content)\n            flag=True\n        else:\n            pass\n    else:\n        with open(filepath, \"w\") as file:\n            file.write(content)\n        flag=True\n\n\n#StepCounter \nnew_file(\"/home/pi/shared/log/home.log\",\"0\")\nnew_file(\"/home/pi/shared/log/homeTT.log\",\"0\")\n\n#LED \nnew_file(\"/home/pi/shared/log/ledstatus.log\",\"0\")\n\n#RPI Status\nnew_file(\"/home/pi/shared/log/currentstatus_rpi.log\",\"--READY--\")\nnew_file(\"/home/pi/shared/log/stopstate.log\",\"run\")\nnew_file(\"/home/pi/shared/log/updatepreview.log\",\"start\")\nnew_file(\"/home/pi/shared/log/preview.log\",\"True\")\n\n\n#Schritte pro umdrehung!\nnew_file(\"/home/pi/shared/log/rotor_stepsperrotation.log\",\"3000\")\nnew_file(\"/home/pi/shared/log/turntable_stepsperrotation.log\",\"3000\")\n\n#Cloud\nnew_file(\"/home/pi/shared/log/cloudstatus.log\",\"\")\nnew_file(\"/home/pi/shared/log/size_to_split.log\",\"200000000\")\nnew_file(\"/home/pi/shared/log/token.log\",\"\")\n\n\n#Camera\nnew_file(\"/home/pi/shared/log/camera_resolution_x.log\",\"3280\")\nnew_file(\"/home/pi/shared/log/camera_resolution_y.log\",\"2464\")\nnew_file(\"/home/pi/shared/log/camera_type.log\",\"v2\")\nnew_file(\"/home/pi/shared/log/cropx.log\",\"0\")\nnew_file(\"/home/pi/shared/log/cropy.log\",\"0\")\nnew_file(\"/home/pi/shared/log/shutterspeed.log\",\"300\")\nnew_file(\"/home/pi/shared/log/awb_red.log\",\"1.7\")\nnew_file(\"/home/pi/shared/log/awb_blue.log\",\"1.7\")\n\n#MotorC\nnew_file(\"/home/pi/shared/log/rotor_acc.log\",\"1\")\nnew_file(\"/home/pi/shared/log/rotor_accramp.log\",\"200\")\nnew_file(\"/home/pi/shared/log/rotor_angle.log\",\"5\")\nnew_file(\"/home/pi/shared/log/rotor_delay.log\",\"0.0005\")\nnew_file(\"/home/pi/shared/log/pin_rotor_dir.log\",\"5\")\nnew_file(\"/home/pi/shared/log/pin_rotor_step.log\",\"6\")\nnew_file(\"/home/pi/shared/log/angle_min.log\",\"-20\")\nnew_file(\"/home/pi/shared/log/angle_max.log\",\"90\")\nnew_file(\"/home/pi/shared/log/startangle.log\",\"0\")\n\n\n#MotorTT\nnew_file(\"/home/pi/shared/log/turntable_angle.log\",\"10\")\nnew_file(\"/home/pi/shared/log/turntable_delay.log\",\"0.0005\")\nnew_file(\"/home/pi/shared/log/pin_turntable_dir.log\",\"9\")\nnew_file(\"/home/pi/shared/log/pin_turntable_step.log\",\"11\")\n\n#General Settings\nnew_file(\"/home/pi/shared/log/ssh.log\",\"true\")\nnew_file(\"/home/pi/shared/log/samba.log\",\"true\")\n\n\nnew_file(\"/home/pi/shared/log/feedback_status.log\",\"\")\nnew_file(\"/home/pi/shared/log/autoupdatestate.log\",\"true\")\nnew_file(\"/home/pi/shared/log/currentserverversion.log\",\"1;\")\nnew_file(\"/home/pi/shared/log/currentversion.log\",\"1\")\nnew_file(\"/home/pi/shared/ui/data/update.log\",\"1\")\nnew_file(\"/home/pi/shared/log/feedback_terms.log\",\"False\")\n\n\n\n\n\n\nif flag==True:\n    os.system(\"sudo systemctl restart nodered\")\nreturn msg\n",
        "outputs": 1,
        "x": 630,
        "y": 700,
        "wires": [
            [
                "964602a5.ecf32",
                "145315bb.4e8f0a"
            ]
        ]
    },
    {
        "id": "145315bb.4e8f0a",
        "type": "python3-function",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "exe",
        "func": "import os\nos.system(\"sudo rfkill unblock wifi\")",
        "outputs": 1,
        "x": 890,
        "y": 760,
        "wires": [
            []
        ]
    },
    {
        "id": "4e47fd3c.83c3d4",
        "type": "link out",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "",
        "links": [],
        "x": 415,
        "y": 200,
        "wires": []
    },
    {
        "id": "c71c9170.f39d5",
        "type": "python3-function",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "GPU",
        "func": "import os\n\nif os.popen('vcgencmd get_mem gpu').read()[0:8]!=\"gpu=256M\":\n    os.system(\"sudo sed -i -e 's/gpu_mem=128/gpu_mem=256/g' /boot/config.txt\")\n    os.system(\"reboot -h\")",
        "outputs": 1,
        "x": 290,
        "y": 700,
        "wires": [
            [
                "61578186.d7bfe"
            ]
        ]
    },
    {
        "id": "df736dcd.e9d38",
        "type": "ui_button",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "Cloud",
        "group": "3be89360.d049cc",
        "order": 8,
        "width": 4,
        "height": 3,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-5x fa-cloud",
        "payload": "3",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 110,
        "y": 240,
        "wires": [
            [
                "62cd5288.2805fc"
            ]
        ]
    },
    {
        "id": "40ee18a5.154a38",
        "type": "inject",
        "z": "68819360.7e7a7c",
        "g": "b5b8f2c0.a6c37",
        "name": "Trigger Once At Startup",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "2",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 500,
        "wires": [
            [
                "2f984eaf.bf7712"
            ]
        ]
    },
    {
        "id": "2f984eaf.bf7712",
        "type": "exec",
        "z": "68819360.7e7a7c",
        "g": "b5b8f2c0.a6c37",
        "command": "bash startChromium.sh",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Start Chromium If It Is Not Running",
        "x": 460,
        "y": 500,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "c7cc1ead.02ead",
        "type": "ui_button",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "Scan",
        "group": "3be89360.d049cc",
        "order": 18,
        "width": 4,
        "height": 3,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-5x fa-play",
        "payload": "5",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 110,
        "y": 280,
        "wires": [
            [
                "62cd5288.2805fc"
            ]
        ]
    },
    {
        "id": "ca7a3a98.d4d7f8",
        "type": "comment",
        "z": "68819360.7e7a7c",
        "g": "b5b8f2c0.a6c37",
        "name": "Starts Chromium and NodeRed",
        "info": "",
        "x": 190,
        "y": 420,
        "wires": []
    },
    {
        "id": "888f6424.093d78",
        "type": "comment",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "creates Files and  RPI Settings",
        "info": "",
        "x": 180,
        "y": 620,
        "wires": []
    },
    {
        "id": "852a6dc5.03581",
        "type": "comment",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "Main Menu / HOME",
        "info": "",
        "x": 150,
        "y": 80,
        "wires": []
    },
    {
        "id": "784b4bc6.8d6554",
        "type": "ui_template",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "group": "3be89360.d049cc",
        "name": "",
        "order": 3,
        "width": 2,
        "height": 1,
        "format": "<style>\n.md-button {\n  border-radius: 10%\n}\n\n\n</style>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 320,
        "y": 300,
        "wires": [
            []
        ]
    },
    {
        "id": "9ab2b4e977cca6a8",
        "type": "python3-function",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "install modules",
        "func": "import os\n\nimport pkg_resources\n\nfrom pip._internal import main as pipmain\n\n\nos.system(\"sudo rfkill unblock wifi\")\n\nmodules=['requests']\n\npackages = pkg_resources.working_set\nlist = sorted([\"%s\" % (i.key)   for i in packages])\n\nflag = False\n\nfor module in modules:\n    if module not in list:\n        pipmain(['install', module])\n        flag = True\n        \nif flag:\n    os.system('sudo reboot -h')\n\nreturn msg",
        "outputs": 1,
        "x": 320,
        "y": 800,
        "wires": [
            []
        ]
    },
    {
        "id": "61751c895e6ca8b5",
        "type": "python3-function",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "diskspace",
        "func": "import os\nimport subprocess\n\ndiskspace_threshold = 80\n\nmsg2=[]\n\ntry:\n    os.system(\"df| awk -F '%' 'NR==2{print $1}'>tmp\")\n    percentage = int(open('tmp', 'r').read()[-4:-1])\n    os.remove('tmp')\n    msg2['payload'] = str(percentage)+'& used'\n    if percentage > diskspace_threshold:\n        msg['payload'] = 'Diskspace warning! ' + str(percentage) +'% of diskspace in use, please delete some files.'\n        return msg,msg2\nexcept:\n    pass",
        "outputs": 1,
        "x": 300,
        "y": 860,
        "wires": [
            [
                "8c08e0614548e4ce"
            ]
        ]
    },
    {
        "id": "8c08e0614548e4ce",
        "type": "ui_toast",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 470,
        "y": 860,
        "wires": [
            []
        ]
    },
    {
        "id": "2d552e2d20489f97",
        "type": "comment",
        "z": "68819360.7e7a7c",
        "g": "2ee92a1b.bee026",
        "name": "OK",
        "info": "",
        "x": 370,
        "y": 620,
        "wires": []
    },
    {
        "id": "e2e540063faed578",
        "type": "comment",
        "z": "68819360.7e7a7c",
        "g": "21befd58.4401b2",
        "name": "OK",
        "info": "",
        "x": 330,
        "y": 80,
        "wires": []
    },
    {
        "id": "7f325f05ab398112",
        "type": "comment",
        "z": "68819360.7e7a7c",
        "g": "b5b8f2c0.a6c37",
        "name": "OK",
        "info": "",
        "x": 390,
        "y": 420,
        "wires": []
    },
    {
        "id": "ec55861d.db0c88",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "2b48318d.37064e",
        "name": "start routine FCam",
        "group": "4cc9cd95.16ff14",
        "order": 24,
        "width": 4,
        "height": 2,
        "passthru": false,
        "label": "",
        "tooltip": "start the routine",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-play",
        "payload": "",
        "payloadType": "date",
        "topic": "enabled",
        "topicType": "str",
        "x": 390,
        "y": 960,
        "wires": [
            [
                "d098c652.525408",
                "f472b69d.2b2b38"
            ]
        ]
    },
    {
        "id": "828e5298.d2192",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "LEFT",
        "group": "a3116208.14508",
        "order": 22,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-arrow-left",
        "payload": "595",
        "payloadType": "num",
        "topic": "payload",
        "topicType": "msg",
        "x": 710,
        "y": 360,
        "wires": [
            [
                "b12e54fb.3141b8"
            ]
        ]
    },
    {
        "id": "96c7e241.458e6",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "RIGHT",
        "group": "a3116208.14508",
        "order": 26,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-arrow-right",
        "payload": "595",
        "payloadType": "num",
        "topic": "",
        "topicType": "str",
        "x": 710,
        "y": 400,
        "wires": [
            [
                "37f52dd4.bd7572"
            ]
        ]
    },
    {
        "id": "2e854876.6b6008",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "UP",
        "group": "a3116208.14508",
        "order": 9,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-arrow-up",
        "payload": "500",
        "payloadType": "num",
        "topic": "",
        "topicType": "str",
        "x": 110,
        "y": 360,
        "wires": [
            [
                "555aea34.b3b5e4"
            ]
        ]
    },
    {
        "id": "753817f.1b9b3e8",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "DOWN",
        "group": "a3116208.14508",
        "order": 13,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-arrow-down",
        "payload": "500",
        "payloadType": "num",
        "topic": "",
        "topicType": "str",
        "x": 120,
        "y": 400,
        "wires": [
            [
                "9905e0c9.dddcd"
            ]
        ]
    },
    {
        "id": "6ab04bf9.304b34",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "TurnTable Left",
        "func": "#->Hier werden die Module importiert\n\nimport time\nfrom time import sleep\nimport RPi.GPIO as GPIO\n\n##################################################################\n#::Varialben definieren::\n\n#->Payload wird in der Variable value gespeichert. \nvalue=int(msg['payload'])\n\n#->Hier werden die Pins für den Drehteller-Motor definiert:\ncontrol_pins = [26,19,13,6]\n\n\n\n###################################################################\n#Hier werden die Ausgänge auf dem RPi  Eingerichtet (GPIO)\n\nGPIO.setwarnings(False)    \nGPIO.setmode(GPIO.BCM)\n\n###################################################################\n\n#Hier wird die Klasse erstellt, mit der man Daten schreiben kann. In diesem Fall die .log Files. \n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\n#Hier wird die Klasse erstellt, mit der man Daten lesen kann mit dem Befehl ->. load(\"Name\")\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n    \n##################################################################    \n    \n#Hier wird die .log Datei mit der load(\"\") Klasse aufgerufen. \n#und in der Variable homecounter zwischengespeichert.\nhomecounter = int(load(\"homeTT\"))\n\n##################################################################\n\n#Hier wird eine Schleife erstellt für die Motorsteuerung.\n\nfor pin in control_pins:\n    \n  GPIO.setup(pin, GPIO.OUT)\n  GPIO.output(pin, 0)\n\n#in dieser Liste sind die einzelnen Positionen/Schritte des Motors hinterlegt.   \n  halfstep_seq = [\n  \n    [1,0,0,0],\n    [1,1,0,0],\n    [0,1,0,0],\n    [0,1,1,0],\n    [0,0,1,0],\n    [0,0,1,1],\n    [0,0,0,1],\n    [1,0,0,1]\n  ]\n  \n#Hier bekommt eine Schleife den Wert in einer range von value. Diese Variable \"value\" haben wir deifniert.\n#info: value ist die payload, welche wir von außerhalb bekommen. \n#Diese Payload haben wir ja in der Variable value zwischengespeichert!\n\nfor i in range(value):\n  for halfstep in range(8):\n      \n#Hier wird eine Schleife 8 mal ausgeführt, weil wir 8 Motorstellungen pro umdrehung haben.\n    for pin in range(4):\n#Hier läuft eine Schleife 4 mal, weil wir 4 Kabel an unseren Pins angeschlossen haben.        \n      GPIO.output(control_pins[pin], halfstep_seq[halfstep][pin])\n      \n    time.sleep(0.001)\nGPIO.cleanup()\n\nnewHome = homecounter + value   \nwrite(\"homeTT\",newHome)\n\nreturn msg",
        "outputs": 1,
        "x": 1020,
        "y": 360,
        "wires": [
            [
                "e7ba40b3.31032"
            ]
        ]
    },
    {
        "id": "8ed4a4f6.4e9ba8",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "TurnTable Right",
        "func": "#->Hier werden die Module importiert\n\nimport time\nfrom time import sleep\nimport RPi.GPIO as GPIO\n\n##################################################################\n#\n#:::::::Varialben definieren::::::::\n\n#->Payload wird in der Variable value gespeichert. \nvalue=int(msg['payload'])\n\n#->Hier werden die Pins für den Drehteller-Motor definiert:\ncontrol_pins = [26,19,13,6]\n\n\n\n###################################################################\n\n#Hier werden die Ausgänge auf dem RPi  Eingerichtet (GPIO)\n\nGPIO.setwarnings(False)    \nGPIO.setmode(GPIO.BCM)\n\n###################################################################\n\n#Hier wird die Klasse erstellt, mit der man Daten schreiben kann. In diesem Fall die .log Files. \n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\n#Hier wird die Klasse erstellt, mit der man Daten lesen kann mit dem Befehl ->. load(\"Name\")\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n    \n##################################################################    \n    \n#Hier wird die .log Datei mit der load(\"\") Klasse aufgerufen. \n#und in der Variable homecounter zwischengespeichert.\n\nhomecounterTT = int(load(\"homeTT\"))\n\n##################################################################\n\n#Hier wird eine Schleife erstellt für die Motorsteuerung.\n\nfor pin in control_pins:\n    \n  GPIO.setup(pin, GPIO.OUT)\n  GPIO.output(pin, 0)\n\n#in dieser Liste sind die einzelnen Positionen/Schritte des Motors hinterlegt.   \n  halfstep_seq = [\n    [1,0,0,1],\n    [0,0,0,1],\n    [0,0,1,1],\n    [0,0,1,0],\n    [0,1,1,0],\n    [0,1,0,0],\n    [1,1,0,0],\n    [1,0,0,0]\n  ]\n  \n#Hier bekommt eine Schleife den Wert in einer range von value. Diese Variable \"value\" haben wir deifniert.\n#info: value ist die payload, welche wir von außerhalb bekommen. \n#Diese Payload haben wir ja in der Variable value zwischengespeichert!\n\nfor i in range(value):\n  for halfstep in range(8):\n      \n#Hier wird eine Schleife 8 mal ausgeführt, weil wir 8 Motorstellungen pro umdrehung haben.\n    for pin in range(4):\n#Hier läuft eine Schleife 4 mal, weil wir 4 Kabel an unseren Pins angeschlossen haben.        \n      GPIO.output(control_pins[pin], halfstep_seq[halfstep][pin])\n      \n    time.sleep(0.001)\n\n\nnewHome = homecounterTT - value   \nwrite(\"homeTT\",newHome)\n\nGPIO.cleanup()\nreturn msg",
        "outputs": 1,
        "x": 1020,
        "y": 400,
        "wires": [
            [
                "e7ba40b3.31032"
            ]
        ]
    },
    {
        "id": "46e00b45.c24ca4",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "Camera up",
        "func": "#->Hier werden die Module importiert\n\nimport time\nfrom time import sleep\nimport RPi.GPIO as GPIO\n\n##################################################################\n#::Varialben definieren::\n\n#->Payload wird in der Variable value gespeichert. \nvalue=int(msg['payload'])\n\n#->Hier werden die Pins für den Drehteller-Motor definiert:\ncontrol_pins = [5,11,9,10]\n\n\n\n###################################################################\n#Hier werden die Ausgänge auf dem RPi  Eingerichtet (GPIO)\n\nGPIO.setwarnings(False)    \nGPIO.setmode(GPIO.BCM)\n\n###################################################################\n\n#Hier wird die Klasse erstellt, mit der man Daten schreiben kann. In diesem Fall die .log Files. \n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\n#Hier wird die Klasse erstellt, mit der man Daten lesen kann mit dem Befehl ->. load(\"Name\")\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n    \n##################################################################    \n    \n#Hier wird die .log Datei mit der load(\"\") Klasse aufgerufen. \n#und in der Variable homecounter zwischengespeichert.\nhomecounter = int(load(\"home\"))\n\n##################################################################\n\n#Hier wird eine Schleife erstellt für die Motorsteuerung.\n\nfor pin in control_pins:\n    \n  GPIO.setup(pin, GPIO.OUT)\n  GPIO.output(pin, 0)\n\n#in dieser Liste sind die einzelnen Positionen/Schritte des Motors hinterlegt.   \n  halfstep_seq = [\n  \n    [1,0,0,0],\n    [1,1,0,0],\n    [0,1,0,0],\n    [0,1,1,0],\n    [0,0,1,0],\n    [0,0,1,1],\n    [0,0,0,1],\n    [1,0,0,1]\n  ]\n  \n#Hier bekommt eine Schleife den Wert in einer range von value. Diese Variable \"value\" haben wir deifniert.\n#info: value ist die payload, welche wir von außerhalb bekommen. \n#Diese Payload haben wir ja in der Variable value zwischengespeichert!\n\nfor i in range(value):\n  for halfstep in range(8):\n      \n#Hier wird eine Schleife 8 mal ausgeführt, weil wir 8 Motorstellungen pro umdrehung haben.\n    for pin in range(4):\n#Hier läuft eine Schleife 4 mal, weil wir 4 Kabel an unseren Pins angeschlossen haben.        \n      GPIO.output(control_pins[pin], halfstep_seq[halfstep][pin])\n      \n    time.sleep(0.001)\nGPIO.cleanup()\n\nnewHome = homecounter + value   \nwrite(\"home\",newHome)\n\nreturn msg",
        "outputs": 1,
        "x": 410,
        "y": 360,
        "wires": [
            [
                "a8e4056f.671c58"
            ]
        ]
    },
    {
        "id": "e7ba40b3.31032",
        "type": "link out",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "",
        "links": [
            "8265a779.7254d8"
        ],
        "x": 1155,
        "y": 380,
        "wires": []
    },
    {
        "id": "a8e4056f.671c58",
        "type": "link out",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "",
        "links": [
            "8265a779.7254d8"
        ],
        "x": 555,
        "y": 380,
        "wires": []
    },
    {
        "id": "555aea34.b3b5e4",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "lmt 0.2/s",
        "pauseType": "rate",
        "timeout": "0.1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.2",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 260,
        "y": 360,
        "wires": [
            [
                "46e00b45.c24ca4"
            ]
        ]
    },
    {
        "id": "9905e0c9.dddcd",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "lmt 0.2/s",
        "pauseType": "rate",
        "timeout": "0.1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.2",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 260,
        "y": 400,
        "wires": [
            [
                "86cb4051.17bc5"
            ]
        ]
    },
    {
        "id": "b12e54fb.3141b8",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "lmt 0.2/s",
        "pauseType": "rate",
        "timeout": "0.1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.2",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 860,
        "y": 360,
        "wires": [
            [
                "6ab04bf9.304b34"
            ]
        ]
    },
    {
        "id": "37f52dd4.bd7572",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "lmt 0.2/s",
        "pauseType": "rate",
        "timeout": "0.1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.2",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 860,
        "y": 400,
        "wires": [
            [
                "8ed4a4f6.4e9ba8"
            ]
        ]
    },
    {
        "id": "8265a779.7254d8",
        "type": "link in",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "Update Preview RPi",
        "links": [
            "a8e4056f.671c58",
            "e7ba40b3.31032"
        ],
        "x": 1385,
        "y": 400,
        "wires": [
            [
                "6871644ce96e1e27"
            ]
        ]
    },
    {
        "id": "7b8b5ab2.f17ee4",
        "type": "ui_slider",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "shutter ",
        "label": "Shutter",
        "tooltip": "",
        "group": "a3116208.14508",
        "order": 8,
        "width": 1,
        "height": 7,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": "1",
        "max": "200",
        "step": "1",
        "className": "",
        "x": 1370,
        "y": 600,
        "wires": [
            [
                "a9d6c524.8990b8"
            ]
        ]
    },
    {
        "id": "6bf17a51.1a8844",
        "type": "ui_slider",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "cropx",
        "label": "X",
        "tooltip": "",
        "group": "a3116208.14508",
        "order": 29,
        "width": 14,
        "height": 1,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": "0",
        "max": "90",
        "step": "1",
        "className": "",
        "x": 1360,
        "y": 640,
        "wires": [
            [
                "b623ca34.f4e488"
            ]
        ]
    },
    {
        "id": "979e4f10.31314",
        "type": "ui_slider",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "cropy",
        "label": "Y",
        "tooltip": "",
        "group": "a3116208.14508",
        "order": 32,
        "width": 14,
        "height": 1,
        "passthru": true,
        "outs": "end",
        "topic": "",
        "topicType": "str",
        "min": "0",
        "max": "90",
        "step": "1",
        "className": "",
        "x": 1360,
        "y": 680,
        "wires": [
            [
                "8deca115.73c88"
            ]
        ]
    },
    {
        "id": "b623ca34.f4e488",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "save",
        "func": "value=str(msg['payload'])\nwith open(\"/home/pi/shared/log/cropx.log\", \"w\") as file:\n    file.write(value)",
        "outputs": 1,
        "x": 1500,
        "y": 640,
        "wires": [
            []
        ]
    },
    {
        "id": "8deca115.73c88",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "save",
        "func": "value=str(msg['payload'])\nwith open(\"/home/pi/shared/log/cropy.log\", \"w\") as file:\n    file.write(value)\n",
        "outputs": 1,
        "x": 1500,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "a9d6c524.8990b8",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "save",
        "func": "value=str(msg['payload'])\nwith open(\"/home/pi/shared/log/shutterspeed.log\", \"w\") as file:\n    file.write(value)\n",
        "outputs": 1,
        "x": 1500,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "104ac669.d1160a",
        "type": "file in",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "CropY",
        "filename": "/home/pi/shared/log/cropy.log",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 1200,
        "y": 680,
        "wires": [
            [
                "979e4f10.31314"
            ]
        ]
    },
    {
        "id": "16692560.d48c8b",
        "type": "file in",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "CropX",
        "filename": "/home/pi/shared/log/cropx.log",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 1200,
        "y": 640,
        "wires": [
            [
                "6bf17a51.1a8844"
            ]
        ]
    },
    {
        "id": "759846e8.01b538",
        "type": "file in",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "Shutter",
        "filename": "/home/pi/shared/log/shutterspeed.log",
        "format": "",
        "chunk": false,
        "sendError": false,
        "encoding": "none",
        "x": 1200,
        "y": 600,
        "wires": [
            [
                "7b8b5ab2.f17ee4"
            ]
        ]
    },
    {
        "id": "f60d784c.88f6d8",
        "type": "inject",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "start",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "num",
        "x": 1030,
        "y": 680,
        "wires": [
            [
                "759846e8.01b538",
                "16692560.d48c8b",
                "104ac669.d1160a",
                "5819207a55ccd754",
                "20cc02855e2a7b40"
            ]
        ]
    },
    {
        "id": "d098c652.525408",
        "type": "change",
        "z": "d6a01399.60299",
        "g": "2b48318d.37064e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "numberofphotos",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 610,
        "y": 960,
        "wires": [
            []
        ]
    },
    {
        "id": "ebdb99aa.b6bc68",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "cc8c79d0.d5b758",
        "name": "Show Features ",
        "group": "a3116208.14508",
        "order": 42,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Show Features",
        "tooltip": "Calculate Features on the current preview image",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "date",
        "topic": "",
        "topicType": "str",
        "x": 1000,
        "y": 1140,
        "wires": [
            [
                "c40709cc.d9c6b8"
            ]
        ]
    },
    {
        "id": "c40709cc.d9c6b8",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "cc8c79d0.d5b758",
        "name": "Preview for features",
        "func": "import time\nimport picamera\nfrom time import sleep\nfrom PIL import Image\nfrom picamera import PiCamera\n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\nif load(\"feedback_terms\")==\"False\":\n    msg['payload']=\"Please read and agree to the Terms of Use (See Settings Menu) before you can use this function\"\n    return None,msg\n\nif load(\"currentstatus_rpi\")[:5]==\"Routi\":\n    return\n\nwrite(\"currentstatus_rpi\",\"Feature-Initialize\")\nsleep(1.5)\n\nshutterspeed=100*int(load(\"shutterspeed\"))\nresx=int(load(\"camera_resolution_x\"))\nresy=int(load(\"camera_resolution_y\"))\ncropx=float(load(\"cropx\"))\ncropy=float(load(\"cropy\"))\nawb_red=float(load(\"awb_red\"))\nawb_blue=float(load(\"awb_blue\"))\n\nmodel=load(\"openscan_model\")\n\nfilepath=\"./shared/ui/data/preview.jpg\"\n\ncamera = PiCamera(resolution=(resx,resy))\ncamera.iso = 100\ncamera.meter_mode = 'spot'\ncamera.shutter_speed = shutterspeed\ncamera.exposure_mode = 'off'\ncamera.awb_mode = 'off'\ncamera.awb_gains = (awb_red,awb_blue)\ncamera.brightness = 50\ncamera.contrast = 0\ncamera.exposure_compensation = 0 \nzoom_x_center=cropx/200\nzoom_y_center=cropy/200\nzoom_x_width=1-cropx/100\nzoom_y_height=1-cropy/100\nx=int(resx*zoom_x_width)\ny=int(resy*zoom_y_height)\ncamera.zoom=(zoom_x_center,zoom_y_center,zoom_x_width,zoom_y_height)\ncamera.capture(filepath,quality=100,resize=(x,y))\ncamera.close()\nimg = Image.open(filepath)\nif model==\"OpenScanMini\":\n    img  = img.transpose(Image.ROTATE_90)\nimg.save(filepath)\nimg.close()\nreturn msg\n",
        "outputs": 2,
        "x": 1240,
        "y": 1140,
        "wires": [
            [
                "3138623e.98929e"
            ],
            [
                "852e46e0.9d80b8"
            ]
        ]
    },
    {
        "id": "3138623e.98929e",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "cc8c79d0.d5b758",
        "name": "features",
        "func": "import os\nimport os\nfrom PIL import Image\nimport uuid\nfrom time import time\nfrom time import sleep\nrepeats=5\ndelay=3\n\n\nfilepath=\"/home/pi/shared/ui/data/preview.jpg\"\n\nkey=uuid.uuid4().hex[:30].replace('0','X').replace('O','Y')\n\npw=\"MKN3iOE4u9qICzHzBmjwuWNt8UD62aP8uPxcOqsrwramqrMcoPJd7dJLz44B4VGRUOKk9W5C4viKrrINagKxvmrLDajrgg8Wkh4I\"\nuser=\"feature\"\nserver=\"openscanfeedback.dnsuser.de\"\nport=str(1312)\npw_down=\"nnEDBxDrDPFPWKZIylxbL21U9QhUrnBWIqsnYUgmLPsCd1ZiJtClrS2bxc8wJq7DSIZNOoiWnMNrLnuJadNagCKhsDCyCVRiUBpf\"\nuser_down=\"download\"\ntarget=\"/home/pi/shared/log/\"+key+\".jpg\"\ntarget_feature=\"/home/pi/shared/ui/data/feature.jpg\"\nos.system(\"sudo cp \"+filepath+\" \"+target)\n\ndef status(text):\n    with open(\"/home/pi/shared/log/currentstatus_rpi.log\", \"w\") as file:\n        file.write(text)\n    msg['payload']=text\n    pass\n\ndef onlinetest():\n    if os.system(\"nc -w 1 \"+server+\" \"+port)==0:\n        status(\"server is online\")\n        \n    else:\n        status(\"server not reachable\")\n        end()\n    pass\n\ndef upload():\n    command=\"curl -k --user \"+user+\":\"+pw+\" sftp://\"+server+\":\"+port+\"/\"+user+\"/ -T \"+target\n    if os.system(command)!=0:\n        status(\"upload failed\")\n        end()\n\n\ndef download():\n    command=\"curl -k --user \"+user_down+\":\"+pw_down+\" sftp://\"+server+\":\"+port+\"/\"+user_down+\"/\"+key+\".jpg -o \"+filepath\n    test=os.system(command)\n    return test\n\nstatus(\"Feature-Testing connection\")\ntry:\n    onlinetest()\nexcept:\n    status(\"Feature-Connection failed\")\n    return\n\nstatus(\"Feature-Uploading\")\ntry:\n    upload()\nexcept:\n    status(\"Feature-Upload failed\")\n    return\nsleep(delay/2)\nstatus(\"Feature-Waiting for file\")\nsleep(delay)\n\nfor x in range (repeats):\n    if download()!=0:\n        status(\"Feature-try: (\"+str(x+1)+\")\")\n        sleep(delay/2)\n    else:\n        sleep(1)\n        os.system(\"sudo cp \"+filepath+\" \"+target_feature)\n        os.system(\"sudo rm \"+target)\n        status(\"--READY--\")\n        timestamp =str(int(time()))\n        msg['payload']='<img src=\"/ui/data/feature.jpg?ts='+timestamp+'\" alt=\"Feature\" style=\"width: auto; height: auto;max-width: 700px;max-height: 600px\">'\n        return msg\n\nfor x in range (3):\n    status(\"Feature-failed (\"+str(3-x)+\"s)\")\n    sleep(1)\n\nos.system(\"sudo rm \"+target)\nstatus(\"--READY--\")\n",
        "outputs": 1,
        "x": 1440,
        "y": 1100,
        "wires": [
            [
                "15b9ddd0.2cf282"
            ]
        ]
    },
    {
        "id": "852e46e0.9d80b8",
        "type": "ui_toast",
        "z": "d6a01399.60299",
        "g": "cc8c79d0.d5b758",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1450,
        "y": 1180,
        "wires": [
            []
        ]
    },
    {
        "id": "a238d4b1.ddd428",
        "type": "inject",
        "z": "d6a01399.60299",
        "g": "cc8c79d0.d5b758",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 670,
        "y": 1140,
        "wires": [
            [
                "65c0518f.4b72b"
            ]
        ]
    },
    {
        "id": "15b9ddd0.2cf282",
        "type": "ui_toast",
        "z": "d6a01399.60299",
        "g": "cc8c79d0.d5b758",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1590,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "f472b69d.2b2b38",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "2b48318d.37064e",
        "name": "disable",
        "func": "msg[\"enabled\"]=False\nreturn msg",
        "outputs": 1,
        "x": 580,
        "y": 1000,
        "wires": [
            [
                "ebdb99aa.b6bc68"
            ]
        ]
    },
    {
        "id": "65c0518f.4b72b",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "cc8c79d0.d5b758",
        "name": "enable",
        "func": "msg[\"enabled\"]=True\n\nreturn msg",
        "outputs": 1,
        "x": 810,
        "y": 1140,
        "wires": [
            [
                "ebdb99aa.b6bc68"
            ]
        ]
    },
    {
        "id": "aea94ca3.912d",
        "type": "ui_template",
        "z": "d6a01399.60299",
        "g": "26bbdfab.4ebb8",
        "group": "a3116208.14508",
        "name": "",
        "order": 20,
        "width": 2,
        "height": 1,
        "format": "<style>\n.md-button {\n  border-radius: 5%\n}\n</style>",
        "storeOutMessages": true,
        "fwdInMessages": true,
        "resendOnRefresh": true,
        "templateScope": "local",
        "className": "",
        "x": 300,
        "y": 140,
        "wires": [
            []
        ]
    },
    {
        "id": "5c70841c.453fac",
        "type": "rpi-neopixels",
        "z": "d6a01399.60299",
        "g": "81f86951.28d478",
        "name": "Neopixel",
        "gpio": 18,
        "pixels": "12",
        "bgnd": "",
        "fgnd": "",
        "wipe": "1",
        "mode": "pcent",
        "rgb": "rgb",
        "brightness": "100",
        "gamma": true,
        "x": 740,
        "y": 600,
        "wires": []
    },
    {
        "id": "ca9d060f.7ee2a8",
        "type": "ui_ui_control",
        "z": "d6a01399.60299",
        "g": "26bbdfab.4ebb8",
        "name": "",
        "events": "change",
        "x": 300,
        "y": 200,
        "wires": [
            []
        ]
    },
    {
        "id": "e297634f.a71fa",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "26bbdfab.4ebb8",
        "name": "return Menu",
        "group": "a3116208.14508",
        "order": 1,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-reply",
        "payload": "0",
        "payloadType": "num",
        "topic": "topic",
        "topicType": "str",
        "x": 130,
        "y": 200,
        "wires": [
            [
                "ca9d060f.7ee2a8"
            ]
        ]
    },
    {
        "id": "10c3cc83.9a21c3",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "Home C",
        "group": "a3116208.14508",
        "order": 11,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-home",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 120,
        "y": 440,
        "wires": [
            [
                "fbe7dd6b.9782a"
            ]
        ]
    },
    {
        "id": "4de0d2e8.af244c",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "Camera Home",
        "func": "import time\nfrom time import sleep\nimport RPi.GPIO as GPIO\n\nGPIO.setmode(GPIO.BCM)\nGPIO.setwarnings(False)\n\n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\n\n#Motor-Pins\n\ncontrol_pins = [5,11,9,10]\n\nhomecounter = str(load(\"home\"))\n\nstepshome=int(homecounter) + int(5)\n\nfor pin in control_pins:\n    \n  GPIO.setup(pin, GPIO.OUT)\n  GPIO.output(pin, 0)\n  halfstep_seq = [\n    [1,0,0,1],\n    [0,0,0,1],\n    [0,0,1,1],\n    [0,0,1,0],\n    [0,1,1,0],\n    [0,1,0,0],\n    [1,1,0,0],\n    [1,0,0,0]\n  ]\n  \nfor i in range(stepshome):\n  for halfstep in range(8):\n\n    for pin in range(4):\n      GPIO.output(control_pins[pin], halfstep_seq[halfstep][pin])\n    time.sleep(0.001)\n \nGPIO.cleanup()\n\nwrite(\"home\",0)\n\nmsg['payload'] = \"0\"\n\nreturn msg\n\n\n\n",
        "outputs": 1,
        "x": 420,
        "y": 440,
        "wires": [
            [
                "156d06fb.5fcc09"
            ]
        ]
    },
    {
        "id": "86cb4051.17bc5",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "Camera down",
        "func": "#->Hier werden die Module importiert\n\nimport time\nfrom time import sleep\nimport RPi.GPIO as GPIO\n\n##################################################################\n#::Varialben definieren::\n\n#->Payload wird in der Variable value gespeichert. \nvalue=int(msg['payload'])\n\n#->Hier werden die Pins für den Drehteller-Motor definiert:\ncontrol_pins = [5,11,9,10]\n\n\n\n###################################################################\n#Hier werden die Ausgänge auf dem RPi  Eingerichtet (GPIO)\n\nGPIO.setwarnings(False)    \nGPIO.setmode(GPIO.BCM)\n\n###################################################################\n\n#Hier wird die Klasse erstellt, mit der man Daten schreiben kann. In diesem Fall die .log Files. \n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\n#Hier wird die Klasse erstellt, mit der man Daten lesen kann mit dem Befehl ->. load(\"Name\")\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n    \n##################################################################    \n    \n#Hier wird die .log Datei mit der load(\"\") Klasse aufgerufen. \n#und in der Variable homecounter zwischengespeichert.\nhomecounter = int(load(\"home\"))\n\n##################################################################\n\n#Hier wird eine Schleife erstellt für die Motorsteuerung.\n\nfor pin in control_pins:\n    \n  GPIO.setup(pin, GPIO.OUT)\n  GPIO.output(pin, 0)\n\n#in dieser Liste sind die einzelnen Positionen/Schritte des Motors hinterlegt.   \n  halfstep_seq = [\n    [1,0,0,1],\n    [0,0,0,1],\n    [0,0,1,1],\n    [0,0,1,0],\n    [0,1,1,0],\n    [0,1,0,0],\n    [1,1,0,0],\n    [1,0,0,0]\n  ]\n  \n#Hier bekommt eine Schleife den Wert in einer range von value. Diese Variable \"value\" haben wir deifniert.\n#info: value ist die payload, welche wir von außerhalb bekommen. \n#Diese Payload haben wir ja in der Variable value zwischengespeichert!\nif homecounter > 0 :\n    for i in range(value):\n        for halfstep in range(8):\n      \n#Hier wird eine Schleife 8 mal ausgeführt, weil wir 8 Motorstellungen pro umdrehung haben.\n            for pin in range(4):\n#Hier läuft eine Schleife 4 mal, weil wir 4 Kabel an unseren Pins angeschlossen haben.        \n                GPIO.output(control_pins[pin], halfstep_seq[halfstep][pin])\n      \n            time.sleep(0.001)\n            \nGPIO.cleanup()\n\nnewHome = homecounter - value   \nwrite(\"home\",newHome)\n\nreturn msg",
        "outputs": 1,
        "x": 420,
        "y": 400,
        "wires": [
            [
                "a8e4056f.671c58"
            ]
        ]
    },
    {
        "id": "156d06fb.5fcc09",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "81f86951.28d478",
        "name": "save ",
        "func": "value=str(msg['payload'])\n\nwith open(\"/home/pi/shared/log/ledstatus.log\", \"w\") as file:\n    file.write(value)\n\n   \nreturn msg",
        "outputs": 1,
        "x": 390,
        "y": 600,
        "wires": [
            [
                "72f22443.47540c"
            ]
        ]
    },
    {
        "id": "72f22443.47540c",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "81f86951.28d478",
        "name": "LED-RGB-Converter",
        "func": "value=int(msg['payload'])\n\nnew = value ,value ,value\n\n\nmsg['payload'] = new\n\nreturn msg\n\n\n\n",
        "outputs": 1,
        "x": 560,
        "y": 600,
        "wires": [
            [
                "5c70841c.453fac"
            ]
        ]
    },
    {
        "id": "46b01c53.852804",
        "type": "ui_slider",
        "z": "d6a01399.60299",
        "g": "81f86951.28d478",
        "name": "LED",
        "label": "LED",
        "tooltip": "",
        "group": "a3116208.14508",
        "order": 7,
        "width": 1,
        "height": 7,
        "passthru": true,
        "outs": "all",
        "topic": "",
        "topicType": "str",
        "min": 0,
        "max": "240",
        "step": "10",
        "className": "",
        "x": 230,
        "y": 600,
        "wires": [
            [
                "156d06fb.5fcc09"
            ]
        ]
    },
    {
        "id": "fbe7dd6b.9782a",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "lmt 0.2/s",
        "pauseType": "rate",
        "timeout": "0.1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.2",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 260,
        "y": 440,
        "wires": [
            [
                "4de0d2e8.af244c"
            ]
        ]
    },
    {
        "id": "65ca15d6.b4bfbc",
        "type": "ui_button",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "Home TT",
        "group": "a3116208.14508",
        "order": 24,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-2x fa-home",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 720,
        "y": 440,
        "wires": [
            [
                "ffb2f29a.22a84"
            ]
        ]
    },
    {
        "id": "ffb2f29a.22a84",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "lmt 0.2/s",
        "pauseType": "rate",
        "timeout": "0.1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.2",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": true,
        "outputs": 1,
        "x": 860,
        "y": 440,
        "wires": [
            [
                "686d6d27.bfd1c4"
            ]
        ]
    },
    {
        "id": "686d6d27.bfd1c4",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "Turn Table Home",
        "func": "import time\nfrom time import sleep\nimport RPi.GPIO as GPIO\n\nGPIO.setmode(GPIO.BCM)\nGPIO.setwarnings(False)\n\n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\n\n#Motor-Pins\n\ncontrol_pins = [26,19,13,6]\n\nhomecounter = int(load(\"homeTT\")) \nhalfstep_seq = []\n \n      \n    \nif homecounter > 0: \n    halfstep_seq = [\n    [1,0,0,1],\n    [0,0,0,1],\n    [0,0,1,1],\n    [0,0,1,0],\n    [0,1,1,0],\n    [0,1,0,0],\n    [1,1,0,0],\n    [1,0,0,0]\n    ] \n          \n    \n    \n          \n    \n    \nelse: \n    halfstep_seq = [\n    [1,0,0,0],\n    [1,1,0,0],\n    [0,1,0,0],\n    [0,1,1,0],\n    [0,0,1,0],\n    [0,0,1,1],\n    [0,0,0,1],\n    [1,0,0,1]\n    ] \n    homecounter = homecounter *-1\n\n\nfor pin in control_pins:\n    \n  GPIO.setup(pin, GPIO.OUT)\n  GPIO.output(pin, 0)\n  \n  \nfor i in range(homecounter):\n  for halfstep in range(8):\n\n    for pin in range(4):\n      GPIO.output(control_pins[pin], halfstep_seq[halfstep][pin])\n    time.sleep(0.001)\n \nGPIO.cleanup()\n\n\nwrite(\"homeTT\", 0)\n\nmsg['payload'] = \"0\"\n\nreturn msg\n\n\n\n",
        "outputs": 1,
        "x": 1030,
        "y": 440,
        "wires": [
            [
                "156d06fb.5fcc09"
            ]
        ]
    },
    {
        "id": "eb7b1c6d.ce192",
        "type": "comment",
        "z": "d6a01399.60299",
        "g": "81f86951.28d478",
        "name": "LED Control",
        "info": "",
        "x": 130,
        "y": 540,
        "wires": []
    },
    {
        "id": "40afd3cf.b6b4cc",
        "type": "comment",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "Settings",
        "info": "",
        "x": 1210,
        "y": 540,
        "wires": []
    },
    {
        "id": "dfa6b870.f875b8",
        "type": "comment",
        "z": "d6a01399.60299",
        "g": "fe5237f3.2ced18",
        "name": "Camera Motor Control",
        "info": "### ",
        "x": 160,
        "y": 300,
        "wires": []
    },
    {
        "id": "b4a7a5c3.1d7f58",
        "type": "comment",
        "z": "d6a01399.60299",
        "g": "e4c78b7f.009588",
        "name": "TurnTable Motor Control",
        "info": "",
        "x": 770,
        "y": 300,
        "wires": []
    },
    {
        "id": "6ed6b9f1.a35c98",
        "type": "comment",
        "z": "d6a01399.60299",
        "g": "26bbdfab.4ebb8",
        "name": "Template & Home",
        "info": "",
        "x": 150,
        "y": 80,
        "wires": []
    },
    {
        "id": "db82b5fd74d771b3",
        "type": "inject",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "",
        "props": [
            {
                "p": "payload",
                "v": "0.2",
                "vt": "str"
            },
            {
                "p": "topic",
                "v": "Repeat",
                "vt": "string"
            }
        ],
        "repeat": "0.2",
        "crontab": "",
        "once": true,
        "onceDelay": "2.4",
        "topic": "",
        "x": 1320,
        "y": 340,
        "wires": [
            [
                "483bcbc7ec272ddb",
                "6871644ce96e1e27"
            ]
        ]
    },
    {
        "id": "6871644ce96e1e27",
        "type": "function",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "enable",
        "func": "if (global.get('preview') === false){\n    return msg\n}",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 1500,
        "y": 380,
        "wires": [
            [
                "496869b0b03df90b",
                "9d3dece4a4dacb19"
            ]
        ]
    },
    {
        "id": "483bcbc7ec272ddb",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "load&color",
        "func": "def load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\ntry:\n    msg['payload']=load(\"currentstatus_rpi\")\nexcept:\n    msg['payload']=\"\"\n\nif msg['payload']==\"no camera found\":\n    msg['color']=\"red\"\n    pass\nreturn msg",
        "outputs": 1,
        "x": 1520,
        "y": 340,
        "wires": [
            [
                "e4bd7fedee38e794"
            ]
        ]
    },
    {
        "id": "e4bd7fedee38e794",
        "type": "ui_text",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "group": "a3116208.14508",
        "order": 2,
        "width": 8,
        "height": 1,
        "name": "",
        "label": "Current Status:",
        "format": "<font color= {{msg.color}} > {{msg.payload}} </font>",
        "layout": "row-spread",
        "className": "",
        "x": 1770,
        "y": 340,
        "wires": []
    },
    {
        "id": "496869b0b03df90b",
        "type": "python3-function",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "Take Preview Shot",
        "func": "from time import sleep\nfrom time import time\nimport subprocess\nfrom PIL import Image\nfrom picamera import PiCamera\n\n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\nstatus= load(\"currentstatus_rpi\")\nmsg['payload']=\"/ui/data/preview.jpg?ts=\"+str(int(time()*10))\n\n\n\nif status!=\"--READY--\":\n    return msg,None\n    \n\nif subprocess.check_output([\"vcgencmd\",\"get_camera\"])[-2:-1]==\"0\":\n    write(\"currentstatus_rpi\",\"no camera found\")\n\n\n\nshutterspeed=130*int(load(\"shutterspeed\"))\nresx=int(load(\"camera_resolution_x\"))\nresy=int(load(\"camera_resolution_y\"))\ncropx=float(load(\"cropx\"))\ncropy=float(load(\"cropy\"))\nawb_red=float(load(\"awb_red\"))\nawb_blue=float(load(\"awb_blue\"))\n\n\ndownscale = 3\nif cropx > 40 and cropy > 40:\n    downscale=1\n    \nfilepath=\"./shared/ui/data/preview.jpg\"\n\n\ntry:\n    camera = PiCamera(resolution=(resx/downscale,resy/downscale))\nexcept:\n    return msg\n\ncamera.iso = 100\ncamera.meter_mode = 'spot'\ncamera.shutter_speed = shutterspeed\ncamera.exposure_mode = 'off'\ncamera.awb_mode = 'off'\ncamera.awb_gains = (awb_red,awb_blue)\ncamera.brightness = 50\ncamera.contrast = 0\ncamera.exposure_compensation = 0 \n    \nzoom_x_center=cropx/200\nzoom_y_center=cropy/200\nzoom_x_width=1-cropx/100\nzoom_y_height=1-cropy/100\n\nx=int(resx/downscale*zoom_x_width)\ny=int(resy/downscale*zoom_y_height)\n\ncamera.zoom=(zoom_x_center,zoom_y_center,zoom_x_width,zoom_y_height)\ncamera.capture(filepath,quality=90,resize=(x,y))\ncamera.close()\n    \n\n\nreturn msg,None\n",
        "outputs": 2,
        "x": 1660,
        "y": 380,
        "wires": [
            [
                "428f658908e16c12",
                "04513ebedf681ee9"
            ],
            []
        ]
    },
    {
        "id": "9d3dece4a4dacb19",
        "type": "change",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "preview=true",
        "rules": [
            {
                "t": "set",
                "p": "preview",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1640,
        "y": 420,
        "wires": [
            []
        ]
    },
    {
        "id": "4e9f6f15e27a0784",
        "type": "inject",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "date"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "x": 1640,
        "y": 460,
        "wires": [
            [
                "04513ebedf681ee9"
            ]
        ]
    },
    {
        "id": "04513ebedf681ee9",
        "type": "change",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "preview=false",
        "rules": [
            {
                "t": "set",
                "p": "preview",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1880,
        "y": 460,
        "wires": [
            []
        ]
    },
    {
        "id": "428f658908e16c12",
        "type": "ui_template",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "group": "a3116208.14508",
        "name": "preview",
        "order": 5,
        "width": 14,
        "height": 10,
        "format": "<div align=\"center\" >\n<img ng-src= {{msg.payload}} style=\"width: auto; height: auto;max-width: 660px;max-height: 503px\"</img>\n<a src=\"/data/preview.jpg\" </a>\n</div>\n",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 1850,
        "y": 380,
        "wires": [
            []
        ]
    },
    {
        "id": "2974ae60f5b2eca9",
        "type": "function",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "Rainbow Effect",
        "func": "\nvar numberOfLEDs = 12;\nvar setColor1= \"0,0,0\"\n\nfor(i=0; i<255; i++){\n    \n    for(j=0; j<numberOfLEDs; j++){\n        \n        var pos = 0;\n        pos = Math.round(((j*255/numberOfLEDs)+i))&255;\n        \n        if(pos<85){\n            var red = pos*3;\n            var green = 255-pos*3;\n            var blue = 0;\n        }\n        else if(pos < 170){\n            pos -= 85;\n            var red = 255 - pos*3;\n            var green = 0;\n            var blue = pos*3;\n        }\n        else{\n            pos -= 170;\n            var red = 0;\n            var green = pos*3;\n            var blue = 255-pos*3;\n        }\n        var setColor = j+','+ red +','+ green +','+ blue;\n        node.send({payload:setColor});\n    }\n}\nfor(i=0; i<255; i++){\n    \n    for(j=0; j<numberOfLEDs; j++){\n        \n        var pos = 0;\n        pos = Math.round(((j*255/numberOfLEDs)+i))&255;\n        \n        if(pos<85){\n            var red = pos*3;\n            var green = 255-pos*3;\n            var blue = 0;\n        }\n        else if(pos < 170){\n            pos -= 85;\n            var red = 255 - pos*3;\n            var green = 0;\n            var blue = pos*3;\n        }\n        else{\n            pos -= 170;\n            var red = 0;\n            var green = pos*3;\n            var blue = 255-pos*3;\n        }\n        var setColor = j+','+ red +','+ green +','+ blue;\n        node.send({payload:setColor});\n    }\n}\n\n\nnode.send({payload:setColor1});",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1340,
        "y": 800,
        "wires": [
            [
                "fe3246c2351e7cbb"
            ]
        ]
    },
    {
        "id": "5819207a55ccd754",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "Delay",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 1190,
        "y": 800,
        "wires": [
            [
                "2974ae60f5b2eca9"
            ]
        ]
    },
    {
        "id": "fe3246c2351e7cbb",
        "type": "delay",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "delay",
        "pauseType": "rate",
        "timeout": "1",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "0.00001",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1490,
        "y": 800,
        "wires": [
            [
                "8d312a890fbd0e6d"
            ]
        ]
    },
    {
        "id": "8d312a890fbd0e6d",
        "type": "rpi-neopixels",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "Neopixel",
        "gpio": 18,
        "pixels": "12",
        "bgnd": "",
        "fgnd": "",
        "wipe": "1",
        "mode": "pcent",
        "rgb": "rgb",
        "brightness": "100",
        "gamma": true,
        "x": 1620,
        "y": 800,
        "wires": []
    },
    {
        "id": "20cc02855e2a7b40",
        "type": "function",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "Reset Project Name",
        "func": "msg.payload=\"default\"\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 1240,
        "y": 740,
        "wires": [
            [
                "3768c653b0e5c1ae",
                "e01bae156ad54612"
            ]
        ]
    },
    {
        "id": "e01bae156ad54612",
        "type": "ui_text_input",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "",
        "label": "Project Name",
        "tooltip": "",
        "group": "4cc9cd95.16ff14",
        "order": 25,
        "width": 2,
        "height": 1,
        "passthru": true,
        "mode": "text",
        "delay": "300",
        "topic": "",
        "sendOnBlur": true,
        "className": "",
        "topicType": "str",
        "x": 1440,
        "y": 740,
        "wires": [
            [
                "3768c653b0e5c1ae"
            ]
        ]
    },
    {
        "id": "3768c653b0e5c1ae",
        "type": "file",
        "z": "d6a01399.60299",
        "g": "c5a87acb.2d7258",
        "name": "save",
        "filename": "/home/pi/shared/log/projectname.log",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 1590,
        "y": 740,
        "wires": [
            []
        ]
    },
    {
        "id": "76fafda05615d739",
        "type": "comment",
        "z": "d6a01399.60299",
        "g": "87a6529f71d7ae01",
        "name": "Preview",
        "info": "",
        "x": 1310,
        "y": 280,
        "wires": []
    },
    {
        "id": "4bfb5998.ef1028",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "command": "sudo reboot",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Reboot",
        "x": 1760,
        "y": 160,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "b856e02b.b64f3",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "command": "sudo shutdown -h now",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "Shutdown",
        "x": 1770,
        "y": 280,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "bc8e5552.04ba68",
        "type": "delay",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "Delay",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1570,
        "y": 280,
        "wires": [
            [
                "b856e02b.b64f3"
            ]
        ]
    },
    {
        "id": "3e9d2ca4.953d44",
        "type": "delay",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "Delay",
        "pauseType": "delay",
        "timeout": "2",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "outputs": 1,
        "x": 1570,
        "y": 160,
        "wires": [
            [
                "4bfb5998.ef1028"
            ]
        ]
    },
    {
        "id": "19bc6938.44e717",
        "type": "python3-function",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "LED OFF",
        "func": "import RPi.GPIO as GPIO\nGPIO.setwarnings(False)\nGPIO.setmode(GPIO.BCM)\n\nwith open(\"/home/pi/shared/log/ledstatus.log\", \"r\") as file:\n    ledstatus=int(file.read())\n\nwith open(\"/home/pi/shared/log/ledstatus.log\", \"w\") as file:\n    file.write(\"0\")\n\nmsg['payload']=\"0,0,0\"\n\nreturn msg",
        "outputs": 1,
        "x": 1580,
        "y": 220,
        "wires": [
            [
                "902ef50a.bfd568"
            ]
        ]
    },
    {
        "id": "52440334.0fa80c",
        "type": "file",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "save",
        "filename": "/home/pi/shared/log/ssh.log",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 650,
        "y": 360,
        "wires": [
            []
        ]
    },
    {
        "id": "596b6655.6f8c18",
        "type": "ui_switch",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "",
        "label": "SSH Off/On",
        "tooltip": "Start/Stop SSH Service, which allows remote access to the device",
        "group": "bb1dd00e.a62b9",
        "order": 3,
        "width": 5,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "x": 470,
        "y": 360,
        "wires": [
            [
                "52440334.0fa80c",
                "f493cf3d.8cb4a"
            ]
        ]
    },
    {
        "id": "33383870.fb78e8",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "command": "sudo /etc/init.d/ssh stop ",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "SSH OFF",
        "x": 820,
        "y": 460,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "f493cf3d.8cb4a",
        "type": "function",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "exec",
        "func": "if (msg.payload === true){\n    return [msg,null]\n}\nif (msg.payload ===false){\n    return [null,msg]\n}",
        "outputs": 2,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "x": 650,
        "y": 420,
        "wires": [
            [
                "9bc0f8b9.3b1738"
            ],
            [
                "33383870.fb78e8"
            ]
        ]
    },
    {
        "id": "9bc0f8b9.3b1738",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "command": "sudo /etc/init.d/ssh start",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "SSH ON",
        "x": 820,
        "y": 400,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "b5fd55b5.a6ae18",
        "type": "inject",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.5",
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 120,
        "y": 500,
        "wires": [
            [
                "e1c7c026.bf90c",
                "35f7bc9e.5f2d74",
                "dc03a256.9663c"
            ]
        ]
    },
    {
        "id": "7e0d26a0.e32c08",
        "type": "file",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "save",
        "filename": "/home/pi/shared/log/samba.log",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 650,
        "y": 500,
        "wires": [
            []
        ]
    },
    {
        "id": "1e8187ab.c4a128",
        "type": "ui_switch",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "",
        "label": "Samba Off/On",
        "tooltip": "Start/Stop Samba Filesharing Server to remotely access the Pi's filesystem",
        "group": "bb1dd00e.a62b9",
        "order": 2,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "x": 480,
        "y": 500,
        "wires": [
            [
                "7e0d26a0.e32c08",
                "686dc68e.f6e288"
            ]
        ]
    },
    {
        "id": "31c3fea3.6d1bd2",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "command": "sudo /etc/init.d/smbd stop",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "SAMBA OFF",
        "x": 830,
        "y": 580,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "686dc68e.f6e288",
        "type": "function",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "exec",
        "func": "if (msg.payload === true){\n    return [msg,null]\n}\nreturn [null,msg]\n",
        "outputs": 2,
        "noerr": 0,
        "x": 650,
        "y": 560,
        "wires": [
            [
                "9afad387.0e93f"
            ],
            [
                "31c3fea3.6d1bd2"
            ]
        ]
    },
    {
        "id": "9afad387.0e93f",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "command": "sudo /etc/init.d/smbd start",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "SAMBA ON",
        "x": 830,
        "y": 520,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "e1c7c026.bf90c",
        "type": "python3-function",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "check ssh",
        "func": "\nwith open(\"/home/pi/shared/log/ssh.log\", \"r\") as file:\n    state=file.read()\nmsg['payload']=False\nif state==\"true\":\n    msg['payload']=True\nreturn msg",
        "outputs": 1,
        "x": 300,
        "y": 360,
        "wires": [
            [
                "596b6655.6f8c18"
            ]
        ]
    },
    {
        "id": "35f7bc9e.5f2d74",
        "type": "python3-function",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "check samba",
        "func": "\nwith open(\"/home/pi/shared/log/samba.log\", \"r\") as file:\n    state=file.read()\nmsg['payload']=False\nif state==\"true\":\n    msg['payload']=True\nreturn msg",
        "outputs": 1,
        "x": 300,
        "y": 500,
        "wires": [
            [
                "1e8187ab.c4a128"
            ]
        ]
    },
    {
        "id": "adb3a465.1c23d8",
        "type": "ui_button",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "reboot",
        "group": "bb1dd00e.a62b9",
        "order": 7,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "reboot the raspberry pi",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-repeat",
        "payload": "",
        "payloadType": "date",
        "topic": "",
        "topicType": "str",
        "x": 1410,
        "y": 180,
        "wires": [
            [
                "3e9d2ca4.953d44",
                "19bc6938.44e717"
            ]
        ]
    },
    {
        "id": "fe90af7b.bcdc1",
        "type": "ui_button",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "shutdown",
        "group": "bb1dd00e.a62b9",
        "order": 5,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "shutdown the raspberry pi",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-power-off",
        "payload": "",
        "payloadType": "date",
        "topic": "",
        "topicType": "str",
        "x": 1420,
        "y": 240,
        "wires": [
            [
                "19bc6938.44e717",
                "bc8e5552.04ba68"
            ]
        ]
    },
    {
        "id": "6091cb32.1af884",
        "type": "ui_switch",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "",
        "label": "Preview Off/On",
        "tooltip": "Show preview while routine is running, this slows down the overall process by 1s per photo",
        "group": "bb1dd00e.a62b9",
        "order": 1,
        "width": 4,
        "height": 1,
        "passthru": true,
        "decouple": "false",
        "topic": "",
        "topicType": "str",
        "style": "",
        "onvalue": "true",
        "onvalueType": "bool",
        "onicon": "",
        "oncolor": "",
        "offvalue": "false",
        "offvalueType": "bool",
        "officon": "",
        "offcolor": "",
        "animate": true,
        "className": "",
        "x": 480,
        "y": 620,
        "wires": [
            [
                "f1f94da9.f8452"
            ]
        ]
    },
    {
        "id": "dc03a256.9663c",
        "type": "python3-function",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "load var",
        "func": "\nwith open(\"/home/pi/shared/log/preview.log\", \"r\") as file:\n    state=file.read()\nmsg['payload']=False\nif state==\"true\":\n    msg['payload']=True\nreturn msg",
        "outputs": 1,
        "x": 300,
        "y": 620,
        "wires": [
            [
                "6091cb32.1af884"
            ]
        ]
    },
    {
        "id": "f1f94da9.f8452",
        "type": "file",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "save",
        "filename": "/home/pi/shared/log/preview.log",
        "appendNewline": false,
        "createDir": true,
        "overwriteFile": "true",
        "encoding": "none",
        "x": 650,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "4c5cd254.e6013c",
        "type": "ui_template",
        "z": "67f0d11b.66aa4",
        "g": "632555a4.fd0bac",
        "group": "6a63d9e3.95e668",
        "name": "Virtual Keyboard",
        "order": 1,
        "width": 3,
        "height": 1,
        "format": "<script> \n    \n// the semi-colon before function invocation is a safety net against concatenated\n// scripts and/or other plugins which may not be closed properly.\n; (function ($, window, document, undefined) {\n\n    // undefined is used here as the undefined global variable in ECMAScript 3 is\n    // mutable (ie. it can be changed by someone else). undefined isn't really being\n    // passed in so we can ensure the value of it is truly undefined. In ES5, undefined\n    // can no longer be modified.\n\n    // window and document are passed through as local variable rather than global\n    // as this (slightly) quickens the resolution process and can be more efficiently\n    // minified (especially when both are regularly referenced in your plugin).\n\n    // Create the defaults once\n    var pluginName = \"jkeyboard\",\n        defaults = {\n            layout: \"english\",\n            input: $('#input'),\n            customLayouts: {\n                selectable: []\n            },\n        };\n\n\n    var function_keys = {\n        backspace: {\n            text: 'DEL',\n        },\n        return: {\n            text: 'Enter'\n        },\n        shift: {\n            text: 'Shift'\n        },\n        space: {\n            text: 'Space'\n        },\n        numeric_switch: {\n            text: '123',\n            command: function () {\n                this.createKeyboard('numeric');\n                this.events();\n            }\n        },\n        layout_switch: {\n            text: '<i class=\"fa fa-keyboard-o\" aria-hidden=\"true\"></i>',\n            command: function () {\n                var l = this.toggleLayout();\n                this.createKeyboard(l);\n                this.events();\n            }\n        },\n        character_switch: {\n            text: 'ABC',\n            command: function () {\n                this.createKeyboard(layout);\n                this.events();\n            }\n        },\n        symbol_switch: {\n            text: '#+=',\n            command: function () {\n                this.createKeyboard('symbolic');\n                this.events();\n            }\n        }\n    };\n\n\n    var layouts = {\n        selectable: ['azeri', 'english', 'russian','french', 'emoji'],\n        azeri: [\n            ['q', 'ü', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p', 'ö', 'ğ'],\n            ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'ı', 'ə'],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm', 'ç', 'ş', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        english: [\n            ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p',],\n            ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l',],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        russian: [\n            ['й', 'ц', 'у', 'к', 'е', 'н', 'г', 'ш', 'щ', 'з', 'х'],\n            ['ф', 'ы', 'в', 'а', 'п', 'р', 'о', 'л', 'д', 'ж', 'э'],\n            ['shift', 'я', 'ч', 'с', 'м', 'и', 'т', 'ь', 'б', 'ю', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        french: [\n            ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p',],\n            ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l','à','ç'],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm','é','è', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        emoji: [\n            ['😀', '😁', '😂', '🤣', '😃', '😄', '😅', '😆', '😉', '😊',],\n            ['😋', '😎', '😍', '😘', 'g', 'h', 'j', 'k', 'l','à','ç'],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm','é','è', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],            \n        numeric: [\n            ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],\n            ['-', '/', ':', ';', '(', ')', '$', '&', '@', '\"'],\n            ['symbol_switch', '.', ',', '?', '!', \"'\", 'backspace'],\n            ['character_switch', 'layout_switch', 'space', 'return'],\n        ],\n        numbers_only: [\n            ['1', '2', '3',],\n            ['4', '5', '6',],\n            ['7', '8', '9',],\n            ['0', 'backspace'],\n        ],\n        symbolic: [\n            ['[', ']', '{', '}', '#', '%', '^', '*', '+', '='],\n            ['_', '\\\\', '|', '~', '<', '>'],\n            ['numeric_switch', '.', ',', '?', '!', \"'\", 'backspace'],\n            ['character_switch', 'layout_switch', 'space', 'return'],\n\n        ]\n    }\n\n    var shift = false, capslock = false, layout = 'english', layout_id = 0;\n\n    // The actual plugin constructor\n    function Plugin(element, options) {\n        this.element = element;\n        // jQuery has an extend method which merges the contents of two or\n        // more objects, storing the result in the first object. The first object\n        // is generally empty as we don't want to alter the default options for\n        // future instances of the plugin\n        this.settings = $.extend({}, defaults, options);\n        // Extend & Merge the cusom layouts\n        layouts = $.extend(true, {}, this.settings.customLayouts, layouts);\n        if (Array.isArray(this.settings.customLayouts.selectable)) {\n            $.merge(layouts.selectable, this.settings.customLayouts.selectable);\n        }\n        this._defaults = defaults;\n        this._name = pluginName;\n        this.init();\n    }\n\n    Plugin.prototype = {\n        init: function () {\n            layout = this.settings.layout;\n            this.createKeyboard(layout);\n            this.events();\n        },\n\n        setInput: function (newInputField) {\n            this.settings.input = newInputField;\n        },\n\n        createKeyboard: function (layout) {\n            shift = false;\n            capslock = false;\n\n            var keyboard_container = $('<ul/>').addClass('jkeyboard'),\n                me = this;\n\n            layouts[layout].forEach(function (line, index) {\n                var line_container = $('<li/>').addClass('jline');\n                line_container.append(me.createLine(line));\n                keyboard_container.append(line_container);\n            });\n\n            $(this.element).html('').append(keyboard_container);\n        },\n\n        createLine: function (line) {\n            var line_container = $('<ul/>');\n\n            line.forEach(function (key, index) {\n                var key_container = $('<li/>').addClass('jkey').data('command', key);\n\n                if (function_keys[key]) {\n                    key_container.addClass(key).html(function_keys[key].text);\n                }\n                else {\n                    key_container.addClass('letter').html(key);\n                }\n\n                line_container.append(key_container);\n            })\n\n            return line_container;\n        },\n\n        events: function () {\n            var letters = $(this.element).find('.letter'),\n                shift_key = $(this.element).find('.shift'),\n                space_key = $(this.element).find('.space'),\n                backspace_key = $(this.element).find('.backspace'),\n                return_key = $(this.element).find('.return'),\n\n                me = this,\n                fkeys = Object.keys(function_keys).map(function (k) {\n                    return '.' + k;\n                }).join(',');\n\n            letters.on('click', function () {\n                me.type((shift || capslock) ? $(this).text().toUpperCase() : $(this).text());\n            });\n\n            space_key.on('click', function () {\n                me.type(' ');\n            });\n\n            return_key.on('click', function () {\n                me.type(\"\\n\");\n                me.settings.input.parents('form').submit();\n            });\n\n            backspace_key.on('click', function () {\n                me.backspace();\n            });\n\n            shift_key.on('click', function () {\n                if (capslock) {\n                    me.toggleShiftOff();\n                    capslock = false;\n                } else {\n                    me.toggleShiftOn();\n                }\n            }).on('dblclick', function () {\n                capslock = true;\n            });\n\n\n            $(fkeys).on('click', function () {\n                var command = function_keys[$(this).data('command')].command;\n                if (!command) return;\n\n                command.call(me);\n            });\n        },\n\n        type: function (key) {\n            var input = this.settings.input,\n                val = input.val(),\n                input_node = input.get(0),\n                start = input_node.selectionStart,\n                end = input_node.selectionEnd;\n\n            var max_length = $(input).attr(\"maxlength\");\n            if (start == end && end == val.length) {\n                if (!max_length || val.length < max_length) {\n                    input.val(val + key);\n                    input.change()\n                    $('#vkeyname').text(val + key)\n                }\n            } else {\n                if (input_node.type == \"text\"){\n                    var new_string = this.insertToString(start, end, val, key);\n                    input.val(new_string);\n                    start++;\n                    end = start;\n                    input_node.setSelectionRange(start, end);\n                }else{\n                    input.val(val + key);\n                }\n                input.change()\n                $('#vkeyname').text(val + key)\n                \n            }\n            input.trigger('focus');\n\n            if (shift && !capslock) {\n                this.toggleShiftOff();\n            }\n        },\n\n        backspace: function () {\n            var input = this.settings.input,\n                val = input.val();\n                input_node = input.get(0),\n                start = input_node.selectionStart,\n                end = input_node.selectionEnd;\n            if (input.type == \"text\"){\n                input.val(val.slice(0, start-1) + val.slice(start))\n                input_node.setSelectionRange(start-1, start-1);\n                console.log(val)\n                $('#vkeyname').text(val)\n            }else{\n                input.val(val.slice(0,-1))\n                $('#vkeyname').text(val.slice(0,-1))\n            }\n            input.change()\n            input.focus()\n        },\n\n        toggleShiftOn: function () {\n            var letters = $(this.element).find('.letter'),\n                shift_key = $(this.element).find('.shift');\n\n            letters.addClass('uppercase');\n            shift_key.addClass('active')\n            shift = true;\n        },\n\n        toggleShiftOff: function () {\n            var letters = $(this.element).find('.letter'),\n                shift_key = $(this.element).find('.shift');\n\n            letters.removeClass('uppercase');\n            shift_key.removeClass('active');\n            shift = false;\n        },\n\n        toggleLayout: function () {\n            layout_id = layout_id || 0;\n            var plain_layouts = layouts.selectable;\n            layout_id++;\n\n            var current_id = layout_id % plain_layouts.length;\n            var SelectedLayoutName = plain_layouts[current_id];\n            $('#vkeyname').text('V-Keyboard ' + SelectedLayoutName )\n            return plain_layouts[current_id];\n        },\n\n        insertToString: function (start, end, string, insert_string) {\n            return string.substring(0, start) + insert_string + string.substring(end, string.length);\n        }\n    };\n\n        /*\n\t\t// A really lightweight plugin wrapper around the constructor,\n\t\t// preventing against multiple instantiations\n\t\t$.fn[ pluginName ] = function ( options ) {\n\t\t\t\treturn this.each(function() {\n\t\t\t\t\t\tif ( !$.data( this, \"plugin_\" + pluginName ) ) {\n\t\t\t\t\t\t\t\t$.data( this, \"plugin_\" + pluginName, new Plugin( this, options ) );\n\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t};\n        */\n        var methods = {\n            init: function(options) {\n                if (!this.data(\"plugin_\" + pluginName)) {\n                    this.data(\"plugin_\" + pluginName, new Plugin(this, options));\n                }\n            },\n\t\t\tsetInput: function(content) {\n\t\t\t\tthis.data(\"plugin_\" + pluginName).setInput($(content));\n            },\n            setLayout: function(layoutname) {\n                // change layout if it is not match current\n                object = this.data(\"plugin_\" + pluginName);\n                if (typeof(layouts[layoutname]) !== 'undefined' && object.settings.layout != layoutname) {\n                    object.settings.layout = layoutname;\n                    object.createKeyboard(layoutname);\n                    object.events();\n                };\n            },\n        };\n\n\t\t$.fn[pluginName] = function (methodOrOptions) {\n            if (methods[methodOrOptions]) {\n                return methods[methodOrOptions].apply(this.first(), Array.prototype.slice.call( arguments, 1));\n            } else if (typeof methodOrOptions === 'object' || ! methodOrOptions) {\n                // Default to \"init\"\n                return methods.init.apply(this.first(), arguments);\n            } else {\n                $.error('Method ' +  methodOrOptions + ' does not exist on jQuery.tooltip');\n            }\n        };\n\n})(jQuery, window, document);\n</script>\n<style>\n    .jkeyboard {\n  display: inline-block;\n}\n.jkeyboard, .jkeyboard .jline, .jkeyboard .jline ul {\n  display: block;\n  margin: 0;\n  padding: 0;\n}\n.jkeyboard .jline {\n  text-align: center;\n  margin-left: -14px;\n}\n.jkeyboard .jline ul li {\n  font-family: arial, sans-serif;\n  font-size: 20px;\n  display: inline-block;\n  border: 1px solid #468db3;\n  -webkit-box-shadow: 0 0 3px #468db3;\n  -webkit-box-shadow: inset 0 0 3px #468db3;\n  margin: 5px 0 1px 6px;\n  color: #000000;\n  border-radius: 5px;\n  width: 52px;\n  height: 52px;\n  box-sizing: border-box;\n  text-align: center;\n  line-height: 52px;\n  overflow: hidden;\n  cursor: pointer;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: -moz-none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.jkeyboard .jline ul li.uppercase {\n  text-transform: uppercase;\n}\n.jkeyboard .jline ul li:hover, .jkeyboard .jline ul li:active {\n  background-color: #185a82;\n}\n.jkeyboard .jline .return {\n  width: 80px;\n}\n.jkeyboard .jline .space {\n  width: 366px;\n}\n.jkeyboard .jline .numeric_switch {\n  width: 65px;\n}\n.jkeyboard .jline .layout_switch {\n}\n.jkeyboard .jline .shift {\n  width: 60px;\n}\n.jkeyboard .jline .backspace {\n  width: 69px;\n}\n</style>\n\n\n\n\n<style>\nbody {font-family: Arial, Helvetica, sans-serif;}\n\n.nr-dashboard-theme .nr-dashboard-template .md-button:not(:first-of-type) {\n    margin-top: 0px;\n}\n\n/* The Modal (background) */\n.modal {\n    display: none; /* Hidden by default */\n    position: fixed; /* Stay in place */\n    opacity:0.99;\n    z-index: 100; /* Sit on top */\n    left: 0;\n    top: 0;\n    width: 100%; /* Full width */\n    height: 100%; /* Full height */\n    overflow: auto; /* Enable scroll if needed */\n    background-color: rgb(0,0,0); /* Fallback color */\n    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */\n}\n\n/* Modal Content */\n.modal-content {\n    position: fixed;\n    background-color: #fefefe;\n    margin: auto;\n    padding: 0;\n    bottom: 0%;\n    left: 50%;\n    transform: translate(-50%, 0%);\n    border: 1px solid #888;\n    width: fit-content;\n    max-width: 100%;\n    max-height: 100%;\n    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);\n    -webkit-animation-name: animate;\n    -webkit-animation-duration: 0.4s;\n    animation-name: animate;\n    animation-duration: 0.4s\n}\n\n/* Add Animation */\n@-webkit-keyframes animate {\n    from {bottom:100%; opacity:0} \n    to {bottom:0%; opacity:1}\n}\n\n@keyframes animate {\n    from {bottom:100%; opacity:0}\n    to {bottom:0%; opacity:1}\n}\n\n/* The Close Button */\n.close {\n    color: black;\n    float: right;\n    font-size: 28px;\n    font-weight: bold;\n}\n\n.close:hover,\n.close:focus {\n    color: #000;\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.modal-header {\n    padding: 2px 16px;\n    background-color: aliceblue;\n    color: white;\n}\n\n.modal-body {padding: 2px 16px;}\n\n.modal-footer {\n    padding: 2px 16px;\n    background-color: #5cb85c;\n    color: white;\n}\n</style>\n\n<!-- The Modal -->\n<div id=\"myModal\" class=\"modal\">\n\n  <!-- Modal content -->\n  <div class=\"modal-content\">\n      <div class=\"modal-header\">\n      <span class=\"close\" onclick=\"closeModal()\">&times;</span>\n      <h2 id=\"vkeyname\" style=\"background-color: aliceblue !important; color: black !important; text-align: center; min-height: 30px;\">V-Keyboard</h2>\n    </div>\n    <div class=\"modal-body\">\n        <div id=\"keyboard\"></div>\n        <div>\n        </div>\n    </div>\n  </div>\n</div>\n\n\n<script>\n    // Get the modal\nvar modal = document.getElementById('myModal');\n\n/*\n$('input[type=text]').click(function () {\n    $('#keyboard').unbind().removeData();\n        $('#keyboard').jkeyboard({\n            layout: \"english\",\n            input: $('#'+$(this).attr('id'))\n    });\n});\n\n$('input[type=number]').click(function () {\n    $('#keyboard').unbind().removeData();\n        $('#keyboard').jkeyboard({\n            layout: \"numbers_only\",\n            input: $('#'+$(this).attr('id'))\n    });\n});\n*/\n\nvar inputTags;\nvar inputType;\n\nvar getinputs = function() {\n    inputTags = document.getElementsByTagName(\"input\");\n    console.log(inputTags)\n    for (var i = 0; i < inputTags.length; i++) {\n        inputTags[i].addEventListener('click', openModal, false)\n    }\n}\n\nsetTimeout(function(){ getinputs(); }, 1000);\n\nvar inputTarget;\n\nvar openModal = function() {\n    inputType = event.target.type\n    inputTarget = event.target\n    var layoutName;\n    if (inputType == \"number\"){\n        //inputTarget.type = \"number\" //hack because chrome doesn't allow setselection in number inputs\n        //inputTarget.value = \"\"\n        layoutName = \"numbers_only\"\n    }else{\n        layoutName = \"english\"\n    }\n    $('#vkeyname').text(event.target.value)\n    $('#keyboard').unbind().removeData();\n    modal.style.display = \"block\";\n    $('#keyboard').jkeyboard({\n        layout: layoutName,\n        input: $('#'+$(this).attr('id'))\n    });\n}\n\n\n// Get the <span> element that closes the modal\nvar span = document.getElementsByClassName(\"close\")[0];\n\n// When the user clicks on <span> (x), close the modal\n//span.onclick = function(event) {\n  //closeModal()\n//}\n\n// When the user clicks anywhere outside of the modal, close it\nwindow.onclick = function(event) {\n    var source = event.target;\n    if (source == modal || source == span) {\n        closeModal(source)\n    }\n};\n\nvar closeModal = function(source){\n    //console.log(\"closing\")\n    modal.style.display = \"none\";\n   \n    if (inputType == \"number\"){\n        inputTarget.type = \"number\" //hack because chrome doesn't allow selectionstart on number inputs\n    }\n}\n\n</script>\n<script>\n\nvar clickState = 1;\nvar btn = document.querySelector('.VK');\n\nbtn.addEventListener('click', function(){\n\n  if (clickState == 0) {\n    this.textContent = 'V-KeyBoard On';\n    modal = document.getElementById('myModal');\n    clickState = 1;\n  } else {\n    this.textContent = 'V-KeyBoard Off';\n    modal = document.getElementById('empty');\n    clickState = 0;\n  }\n\n});\n</script>\n\n<style>\n.VK{\n    position: fixed;\n    top: 60px;\n    right: 20px;\n    height: 30px;\n}\n</style>\n\n<div id=\"empty\"></div>\n<button class=\"VK\">V-KeyBoard On</button> ",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "x": 180,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "c209f680.dfd5a8",
        "type": "ui_ui_control",
        "z": "67f0d11b.66aa4",
        "g": "632555a4.fd0bac",
        "name": "",
        "events": "change",
        "x": 260,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "5ef49f08.9fd5d",
        "type": "ui_button",
        "z": "67f0d11b.66aa4",
        "g": "632555a4.fd0bac",
        "name": "Home",
        "group": "95577a4.4466488",
        "order": 1,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-home",
        "payload": "0",
        "payloadType": "num",
        "topic": "topic",
        "topicType": "str",
        "x": 100,
        "y": 120,
        "wires": [
            [
                "c209f680.dfd5a8"
            ]
        ]
    },
    {
        "id": "902ef50a.bfd568",
        "type": "rpi-neopixels",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "Neopixel",
        "gpio": 18,
        "pixels": "12",
        "bgnd": "",
        "fgnd": "",
        "wipe": "1",
        "mode": "pcent",
        "rgb": "rgb",
        "brightness": "100",
        "gamma": true,
        "x": 1760,
        "y": 220,
        "wires": []
    },
    {
        "id": "54defe41.1ae97",
        "type": "comment",
        "z": "67f0d11b.66aa4",
        "g": "632555a4.fd0bac",
        "name": "Home",
        "info": "",
        "x": 90,
        "y": 60,
        "wires": []
    },
    {
        "id": "ef791d9e.6ee85",
        "type": "comment",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "Boot & Reboot",
        "info": "",
        "x": 1440,
        "y": 120,
        "wires": []
    },
    {
        "id": "1004ce1b.008b12",
        "type": "comment",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "General Settings",
        "info": "",
        "x": 120,
        "y": 280,
        "wires": []
    },
    {
        "id": "e9e65bd8.deaae8",
        "type": "comment",
        "z": "67f0d11b.66aa4",
        "g": "632555a4.fd0bac",
        "name": "CHECK",
        "info": "",
        "x": 290,
        "y": 60,
        "wires": []
    },
    {
        "id": "aa0eb2e8.2ba11",
        "type": "comment",
        "z": "67f0d11b.66aa4",
        "g": "780ad3b2.21864c",
        "name": "CHECK",
        "info": "",
        "x": 1770,
        "y": 120,
        "wires": []
    },
    {
        "id": "801f7988.6f4348",
        "type": "comment",
        "z": "67f0d11b.66aa4",
        "g": "f520521a.b21ff",
        "name": "CHECK",
        "info": "",
        "x": 870,
        "y": 280,
        "wires": []
    },
    {
        "id": "8e5e954db3bec3bc",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "command": "sudo iwlist wlan0 scan | grep ESSID | sed 's/ESSID://g;s/\"//g;s/^ *//;s/ *$//'",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "scan",
        "x": 410,
        "y": 880,
        "wires": [
            [
                "082f6653ea34c6d0"
            ],
            [],
            []
        ]
    },
    {
        "id": "082f6653ea34c6d0",
        "type": "function",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "parseOptions",
        "func": "var ssids = msg.payload.split('\\n').filter(s => !!s)\n\nssids = [...new Set(ssids)];\n\nmsg.options = ssids\nmsg.payload = null\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 570,
        "y": 860,
        "wires": [
            [
                "b2d3919e883ce870"
            ]
        ]
    },
    {
        "id": "b2d3919e883ce870",
        "type": "ui_dropdown",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "",
        "label": "Wifi",
        "tooltip": "",
        "place": "Select a WIFI",
        "group": "6a63d9e3.95e668",
        "order": 6,
        "width": 0,
        "height": 0,
        "passthru": false,
        "options": [],
        "payload": "",
        "topic": "",
        "x": 730,
        "y": 860,
        "wires": [
            [
                "6782bc5957411d6a"
            ]
        ]
    },
    {
        "id": "89c5230797ea08aa",
        "type": "ui_button",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "",
        "group": "6a63d9e3.95e668",
        "order": 5,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "Scan",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "true",
        "payloadType": "bool",
        "topic": "",
        "topicType": "str",
        "x": 110,
        "y": 920,
        "wires": [
            [
                "de39c68c1dde58b1"
            ]
        ]
    },
    {
        "id": "1e3bfe6362045db2",
        "type": "ui_form",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "",
        "label": "",
        "group": "6a63d9e3.95e668",
        "order": 7,
        "width": 6,
        "height": 4,
        "options": [
            {
                "label": "SSID",
                "value": "ssid",
                "type": "text",
                "required": true,
                "rows": null
            },
            {
                "label": "Password",
                "value": "password",
                "type": "password",
                "required": true,
                "rows": null
            },
            {
                "label": "Country Code (ISO/IEC)",
                "value": "country",
                "type": "text",
                "required": true,
                "rows": null
            }
        ],
        "formValue": {
            "ssid": "",
            "password": "",
            "country": ""
        },
        "payload": "",
        "submit": "UPDATE",
        "cancel": "RESET",
        "topic": "",
        "x": 110,
        "y": 1040,
        "wires": [
            [
                "5f8a866eeca48ab8",
                "8264d51e457ff7ad"
            ]
        ]
    },
    {
        "id": "6782bc5957411d6a",
        "type": "function",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "",
        "func": "\nmsg.payload = {ssid: msg.payload}\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 850,
        "y": 860,
        "wires": [
            [
                "1e3bfe6362045db2"
            ]
        ]
    },
    {
        "id": "5f8a866eeca48ab8",
        "type": "function",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "getPassphrase",
        "func": "var data = msg.payload\n\nvar command = `wpa_passphrase \"${data.ssid}\" \"${data.password}\" | sed '/#psk=\".*\"/d'`\n \nmsg.payload = command\nmsg.status = \"updating Wifi settings\"\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "x": 260,
        "y": 1040,
        "wires": [
            [
                "3507f052e7328dab",
                "edecc8ccc4ae714e"
            ]
        ]
    },
    {
        "id": "3507f052e7328dab",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "command": "",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "",
        "x": 410,
        "y": 1040,
        "wires": [
            [
                "7ad7618d5308df4e"
            ],
            [],
            []
        ]
    },
    {
        "id": "07aaf176f2b4e0cd",
        "type": "function",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "updateWpasupplicant",
        "func": "var template = `sudo tee /etc/wpa_supplicant/wpa_supplicant.conf <<EOF\nctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\ncountry=${msg.country}\n\n${msg.payload}\nEOF\\n\n`\n\nmsg.payload = template\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 609,
        "y": 1033,
        "wires": [
            [
                "b32358f38d248d1c"
            ]
        ]
    },
    {
        "id": "b32358f38d248d1c",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "command": "",
        "addpay": true,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "updateConf",
        "x": 810,
        "y": 1040,
        "wires": [
            [
                "55741069fe2723a2"
            ],
            [],
            []
        ]
    },
    {
        "id": "55741069fe2723a2",
        "type": "exec",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "command": "sudo wpa_cli -i wlan0 reconfigure",
        "addpay": false,
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "oldrc": false,
        "name": "reconfigure",
        "x": 970,
        "y": 1040,
        "wires": [
            [
                "801924b0968270b0"
            ],
            [],
            []
        ]
    },
    {
        "id": "801924b0968270b0",
        "type": "function",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "showMessage",
        "func": "\nmsg.payload = msg.payload.trim() === 'OK' ? \"Wifi configuration updated successfully\" : \"Error while updating wifi configuration\"\n\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "x": 1140,
        "y": 1040,
        "wires": [
            [
                "61beec273e8ee1b9"
            ]
        ]
    },
    {
        "id": "61beec273e8ee1b9",
        "type": "ui_toast",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "topic": "",
        "name": "",
        "x": 1130,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "3e2b69276152a7d5",
        "type": "switch",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "ifWifi",
        "property": "name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "Wifi",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 210,
        "y": 880,
        "wires": [
            [
                "8e5e954db3bec3bc",
                "511bc167badd5155"
            ]
        ]
    },
    {
        "id": "8264d51e457ff7ad",
        "type": "change",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "country",
                "pt": "global",
                "to": "payload.country",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 280,
        "y": 1100,
        "wires": [
            []
        ]
    },
    {
        "id": "7ad7618d5308df4e",
        "type": "change",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "country",
                "pt": "msg",
                "to": "country",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 1100,
        "wires": [
            [
                "07aaf176f2b4e0cd"
            ]
        ]
    },
    {
        "id": "511bc167badd5155",
        "type": "python3-function",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "check ip address",
        "func": "import socket\nimport subprocess\n\nrouting = subprocess.check_output(\"route | grep '^default' | grep -o '[^ ]*$'\", shell=True)\nif routing==\"wlan0\\n\":\n    routing=\"Wifi\"\nelif routing==\"eth0\\n\":\n    routing=\"Ethernet\"\nelif routing==\"eth0\\nwlan0\\n\" or routing==\"wlan0\\neth0\\n\":\n    routing=\"Ethernet+Wifi\"\nelse:\n    routing=\"none\"\n\n\ntestIP = \"8.8.8.8\"\ns = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)\ns.connect((testIP, 0))\nipaddr = s.getsockname()[0]\nhost = socket.gethostname()\n\n\n\nmsg['routing']=routing\nmsg['ip']=ipaddr\nmsg['hostname']=host\n\nreturn msg",
        "outputs": 1,
        "x": 450,
        "y": 820,
        "wires": [
            [
                "df0f8b1e2cc46166",
                "303ef632ab444a09",
                "8f2fdf57d5d6bbef"
            ]
        ]
    },
    {
        "id": "df0f8b1e2cc46166",
        "type": "ui_text",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "group": "6a63d9e3.95e668",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Hostname:",
        "format": "{{msg.hostname}}",
        "layout": "row-spread",
        "x": 630,
        "y": 820,
        "wires": []
    },
    {
        "id": "303ef632ab444a09",
        "type": "ui_text",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "group": "6a63d9e3.95e668",
        "order": 1,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Your local IP:",
        "format": "{{msg.ip}}",
        "layout": "row-spread",
        "x": 630,
        "y": 780,
        "wires": []
    },
    {
        "id": "74002c45a26113ee",
        "type": "inject",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "",
        "topic": "",
        "payload": "Started!",
        "payloadType": "str",
        "x": 220,
        "y": 820,
        "wires": [
            [
                "8e5e954db3bec3bc",
                "511bc167badd5155"
            ]
        ]
    },
    {
        "id": "55e28d9e425c9da0",
        "type": "comment",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "WIFI",
        "info": "",
        "x": 90,
        "y": 740,
        "wires": []
    },
    {
        "id": "8f2fdf57d5d6bbef",
        "type": "ui_text",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "group": "6a63d9e3.95e668",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Connected by",
        "format": "{{msg.routing}}",
        "layout": "row-spread",
        "className": "",
        "x": 640,
        "y": 740,
        "wires": []
    },
    {
        "id": "de39c68c1dde58b1",
        "type": "ui_ui_control",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "onTab",
        "events": "all",
        "x": 230,
        "y": 920,
        "wires": [
            [
                "8e5e954db3bec3bc",
                "511bc167badd5155",
                "809f525e6cf42ad4"
            ]
        ]
    },
    {
        "id": "edecc8ccc4ae714e",
        "type": "ui_text",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "group": "6a63d9e3.95e668",
        "order": 8,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "",
        "format": "{{msg.status}}",
        "layout": "row-spread",
        "x": 680,
        "y": 940,
        "wires": []
    },
    {
        "id": "809f525e6cf42ad4",
        "type": "python3-function",
        "z": "67f0d11b.66aa4",
        "g": "fbe1e58a2ba80e36",
        "name": "check ip address",
        "func": "msg['status']=\"\"\nreturn msg",
        "outputs": 1,
        "x": 450,
        "y": 920,
        "wires": [
            [
                "edecc8ccc4ae714e"
            ]
        ]
    },
    {
        "id": "952ce286.4ffd4",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "g": "7e6ff6c1.11bca8",
        "group": "db43d646.2074c8",
        "order": 1,
        "width": 5,
        "height": 1,
        "name": "Status",
        "label": "Status",
        "format": "{{msg.text}}",
        "layout": "row-spread",
        "className": "",
        "x": 450,
        "y": 180,
        "wires": []
    },
    {
        "id": "86e2a44b.335988",
        "type": "inject",
        "z": "532cea09.a25754",
        "g": "7e6ff6c1.11bca8",
        "name": "Started",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "0.1",
        "crontab": "",
        "once": true,
        "onceDelay": "10",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 160,
        "y": 180,
        "wires": [
            [
                "8e6e7577.f92658"
            ]
        ]
    },
    {
        "id": "8e6e7577.f92658",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "g": "7e6ff6c1.11bca8",
        "name": "msg",
        "func": "with open('/home/pi/shared/log/cloudstatus.log', 'r') as file:\n    text = file.read()\n    \ntry: \n    if text[0:9] == 'uploading':\n        with open(\"/home/pi/shared/ui/data/uploadprogress\",'r') as file:\n            progress=file.read()[-6:]\n            if progress[-1] == '%':\n                text = text + ' (' + progress + ')'\n    msg['text'] = text\n    return msg\nexcept:\n    pass",
        "outputs": 1,
        "x": 310,
        "y": 180,
        "wires": [
            [
                "952ce286.4ffd4"
            ]
        ]
    },
    {
        "id": "9bdd12b5.e099",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "name": "Refresh",
        "group": "db43d646.2074c8",
        "order": 8,
        "width": 8,
        "height": 1,
        "passthru": false,
        "label": "Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "updating status ...",
        "x": 760,
        "y": 280,
        "wires": [
            [
                "9de4ca9e.c03d88"
            ]
        ]
    },
    {
        "id": "9de4ca9e.c03d88",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "name": "refresh",
        "func": "import requests\nimport os\n\nuser = 'openscan'\npw = 'free'\n\nserver = 'http://openscanfeedback.dnsuser.de:1334/'\nbasepath=\"/home/pi/shared/ui/data/zip/\"\n\nwith open('/home/pi/shared/log/token.log', 'r') as file:\n    token = file.read().strip('\\n')\n\n\ndef OpenScanCloud(cmd, msg):\n    r = requests.get(server + cmd, auth=(user, pw), params=msg)\n    if r.status_code == 200:\n        return r.json()\n    else:\n        return {}\n\nmsg={}\nprojects = []\nfor i in os.listdir(basepath):\n    if os.path.isdir(basepath+ '/'+i):\n        if os.path.isfile(basepath+'/'+i+'/status'):\n            with open(basepath+'/'+i+'/status', 'r') as file:\n                status = file.read().strip('\\n')\n                if status in ['expired', 'processing done', 'processing failed']:\n                    continue\n        projects.append(i)\n\nfor p in projects:\n    answer = OpenScanCloud('getProjectInfo',{'token':token, 'project':p+'.zip'})\n    if answer == {}:\n        os.system('sudo rm -r ' + basepath + '/' + p)\n    else:\n        with open(basepath + '/' + p + '/status', 'w+') as file:\n            file.write(answer['status'])\n        with open(basepath + '/' + p + '/download', 'w+') as file:\n            file.write(answer['dlink'])\n\nmsg1 = OpenScanCloud('getTokenInfo', {'token':token})\n\nmsg['list'] = projects\ntry:\n    msg1['limit_filesize']=float(msg1['limit_filesize'])/1000000000\n    msg1['credit']=float((msg1['credit'])/1000000)/1000\n    return msg,msg1\nexcept:\n    return msg\n",
        "outputs": 2,
        "x": 910,
        "y": 280,
        "wires": [
            [
                "84cf9870.619df8"
            ],
            [
                "fa9287d.2e4b078",
                "ae83845d.58a6a8",
                "80adb53.3844e48"
            ]
        ]
    },
    {
        "id": "84cf9870.619df8",
        "type": "link out",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "name": "",
        "links": [
            "2f4c0f98.dee2",
            "c20357dd.374108",
            "e9aab326.a6896",
            "edd22cc7.befe1",
            "19b81967.49db87",
            "8ee1b3bb.7b0b3",
            "f78df45d7a66d862"
        ],
        "x": 1075,
        "y": 200,
        "wires": []
    },
    {
        "id": "d2f21710.8fbd08",
        "type": "link out",
        "z": "532cea09.a25754",
        "g": "1276227.fd896de",
        "name": "",
        "links": [
            "b33d604c.5f1a6",
            "1f94d0f5.7da73f",
            "122c68f6b995d7e1"
        ],
        "x": 415,
        "y": 440,
        "wires": []
    },
    {
        "id": "ae83845d.58a6a8",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "group": "88570d39.c5b25",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Max. Number of Photos:",
        "format": "{{msg.limit_photos}}",
        "layout": "row-spread",
        "className": "",
        "x": 1170,
        "y": 240,
        "wires": []
    },
    {
        "id": "fa9287d.2e4b078",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "group": "88570d39.c5b25",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Max. Filesize (GB):",
        "format": "{{msg.limit_filesize}}",
        "layout": "row-spread",
        "x": 1150,
        "y": 280,
        "wires": []
    },
    {
        "id": "80adb53.3844e48",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "group": "88570d39.c5b25",
        "order": 2,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Credit (GB):",
        "format": "{{msg.credit}}",
        "layout": "row-spread",
        "x": 1130,
        "y": 320,
        "wires": []
    },
    {
        "id": "de8cf887.5d3488",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "save",
        "func": "if msg['payload']!=\"Yes\":\n    return None,msg\n\nwith open(\"/home/pi/shared/log/token.log\",\"w+\") as file:\n    file.write(str(msg['token']))\nmsg['payload'] = 'Token Saved'\nreturn msg, msg",
        "outputs": 2,
        "x": 1210,
        "y": 520,
        "wires": [
            [
                "7f91bfd6.00e12"
            ],
            [
                "86d5d435.aaa058"
            ]
        ]
    },
    {
        "id": "7f91bfd6.00e12",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "topic": "",
        "name": "",
        "x": 1405,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "1d1a0978.f12367",
        "type": "ui_text_input",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "",
        "label": "Token",
        "tooltip": "",
        "group": "88570d39.c5b25",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "x": 785,
        "y": 520,
        "wires": [
            [
                "7c55acb.95f4e54"
            ]
        ]
    },
    {
        "id": "7c55acb.95f4e54",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "Save?",
        "func": "msg['token'] = msg['payload']\n\nif len(msg['payload'])>=14:\n    \n    msg[\"payload\"]='Save Token ' + msg['payload']\n    return msg\nelse:\n    return None,msg",
        "outputs": 2,
        "x": 905,
        "y": 520,
        "wires": [
            [
                "255773b8.d57dbc"
            ],
            [
                "e9dade29.1e9f9"
            ]
        ]
    },
    {
        "id": "8e81c129.2ebe2",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "text",
        "func": "with open('/home/pi/shared/log/token.log','r') as file:\n    id=file.read()[0:8]\nmsg['payload']=id+\"...\"\nif len(id)==0:\n    msg['payload']=\"enter token\"\nreturn msg",
        "outputs": 1,
        "x": 665,
        "y": 520,
        "wires": [
            [
                "1d1a0978.f12367"
            ]
        ]
    },
    {
        "id": "1f94d0f5.7da73f",
        "type": "link in",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "",
        "links": [
            "d2f21710.8fbd08",
            "e9dade29.1e9f9",
            "86d5d435.aaa058"
        ],
        "x": 535,
        "y": 520,
        "wires": [
            [
                "8e81c129.2ebe2"
            ]
        ]
    },
    {
        "id": "8e437831.caf498",
        "type": "link out",
        "z": "532cea09.a25754",
        "g": "1276227.fd896de",
        "name": "",
        "links": [
            "2f4c0f98.dee2",
            "c20357dd.374108",
            "e9aab326.a6896",
            "edd22cc7.befe1",
            "19b81967.49db87",
            "8ee1b3bb.7b0b3"
        ],
        "x": 295,
        "y": 520,
        "wires": []
    },
    {
        "id": "fb3e8df1.449ae",
        "type": "change",
        "z": "532cea09.a25754",
        "g": "1276227.fd896de",
        "name": "flag.true",
        "rules": [
            {
                "t": "set",
                "p": "flag",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 440,
        "wires": [
            [
                "d2f21710.8fbd08"
            ]
        ]
    },
    {
        "id": "d42a47c7.c0df68",
        "type": "inject",
        "z": "532cea09.a25754",
        "g": "1276227.fd896de",
        "name": "Started",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 160,
        "y": 440,
        "wires": [
            [
                "8e437831.caf498",
                "fb3e8df1.449ae",
                "ffe78092.30b5"
            ]
        ]
    },
    {
        "id": "255773b8.d57dbc",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "No",
        "cancel": "Yes",
        "raw": false,
        "topic": "",
        "name": "",
        "x": 1065,
        "y": 520,
        "wires": [
            [
                "de8cf887.5d3488"
            ]
        ]
    },
    {
        "id": "e9dade29.1e9f9",
        "type": "link out",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "",
        "links": [
            "1f94d0f5.7da73f"
        ],
        "x": 995,
        "y": 480,
        "wires": []
    },
    {
        "id": "86d5d435.aaa058",
        "type": "link out",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "",
        "links": [
            "1f94d0f5.7da73f"
        ],
        "x": 1335,
        "y": 480,
        "wires": []
    },
    {
        "id": "ffe78092.30b5",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "g": "1276227.fd896de",
        "name": "msg",
        "func": "with open('/home/pi/shared/log/cloudstatus.log', 'w+') as file:\n    file.write('ready')\n    \n",
        "outputs": 1,
        "x": 310,
        "y": 480,
        "wires": [
            []
        ]
    },
    {
        "id": "97f788a9.0c4a38",
        "type": "ui_ui_control",
        "z": "532cea09.a25754",
        "g": "d58bec1.b1df91",
        "name": "",
        "events": "change",
        "x": 1710,
        "y": 180,
        "wires": [
            []
        ]
    },
    {
        "id": "19313347.fdbe8d",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "g": "d58bec1.b1df91",
        "name": "Home",
        "group": "2ef46cc5.cfde94",
        "order": 1,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "fa-home",
        "payload": "0",
        "payloadType": "num",
        "topic": "topic",
        "topicType": "str",
        "x": 1570,
        "y": 180,
        "wires": [
            [
                "97f788a9.0c4a38"
            ]
        ]
    },
    {
        "id": "9d2c7f38.d9c95",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "d58bec1.b1df91",
        "name": "CHECK",
        "info": "",
        "x": 1810,
        "y": 100,
        "wires": []
    },
    {
        "id": "3ceb5b3.b4f9da4",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "d58bec1.b1df91",
        "name": "Home",
        "info": "",
        "x": 1570,
        "y": 100,
        "wires": []
    },
    {
        "id": "8860b3ad.2454d",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "7e6ff6c1.11bca8",
        "name": "Status",
        "info": "",
        "x": 130,
        "y": 100,
        "wires": []
    },
    {
        "id": "4ebec302.cde32c",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "7e6ff6c1.11bca8",
        "name": "CHECK",
        "info": "",
        "x": 470,
        "y": 100,
        "wires": []
    },
    {
        "id": "51413076.9b8a6",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "name": "CHECK",
        "info": "",
        "x": 1250,
        "y": 160,
        "wires": []
    },
    {
        "id": "47df48b0.f98908",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "c36493cc.c72b9",
        "name": "Cloud Credit",
        "info": "",
        "x": 760,
        "y": 160,
        "wires": []
    },
    {
        "id": "c91096fb.56d5d8",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "Cloud Token ",
        "info": "",
        "x": 590,
        "y": 460,
        "wires": []
    },
    {
        "id": "3e90dc6c.c8b9a4",
        "type": "comment",
        "z": "532cea09.a25754",
        "g": "90cae723.bb1b28",
        "name": "CHECK",
        "info": "",
        "x": 1450,
        "y": 440,
        "wires": []
    },
    {
        "id": "70db38966641784d",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "get dirs",
        "func": "from glob import glob\nimport os\nfrom zipfile import ZipFile\n\n\ndef set_stats(stat):\n    try:\n        with open(directory+set[:-4]+\"/\"+stat,\"r\") as file:\n            stat=file.read()\n    except:\n        stat=\"\"\n    return stat\n\ntable=[]\ndirectory=\"/home/pi/shared/ui/data/zip/\"\n\nfor d in glob(directory+\"*.zip\"):\n    set=os.path.basename(d)\n\n    with ZipFile(d, 'r') as f:\n        photos = len(f.namelist())\n\n    size = float(int(float(os.path.getsize(d))/100000))/10\n    size_full= os.path.getsize(d)\n    status=set_stats(\"status\")\n    expiration=set_stats(\"expiration\")\n    download=set_stats(\"download\")\n\n    if len(download)!=0:\n        table.append({\n            \"Set\":set,\n            \"Photos\":photos,\n            \"Size\":str(size)+\"MB\",\n            \"Date\":set[:16],\n            \"Name\":(set[20:-4]),\n            \"Status\":status,\n            \"Download\":\"<a href=\"+download+\">RESULT</a>\",\n            \"Size_full\":size_full,\n            \"Zip\":\"<a href=/ui/data/zip/\"+set+\">ZIP</a>\",\n\n            })\n    else:\n        table.append({\n            \"Set\":set,\n            \"Photos\":photos,\n            \"Size\":str(size)+\"MB\",\n            \"Date\":set[:16],\n            \"Name\":(set[20:-4]),\n            \"Status\":status,\n            \"Size_full\":size_full,\n            \"Zip\":\"<a href=/ui/data/zip/\"+set+\">ZIP</a>\",\n\n            })\n\n\nmsg['payload']=table\nmsg['topic']=\"\"\nreturn msg",
        "outputs": 1,
        "x": 620,
        "y": 900,
        "wires": [
            [
                "82c52f682141beb3"
            ]
        ]
    },
    {
        "id": "f78df45d7a66d862",
        "type": "link in",
        "z": "532cea09.a25754",
        "name": "files",
        "links": [
            "31787cb7.9ba1b4",
            "47063317.6eaffc",
            "84cf9870.619df8",
            "8c0865c6.c219b8",
            "9bd276395edf15c1",
            "ca666433.f92b08",
            "fc09407e.7278",
            "cd05063f8c0e63e9"
        ],
        "x": 495,
        "y": 860,
        "wires": [
            [
                "70db38966641784d"
            ]
        ]
    },
    {
        "id": "82c52f682141beb3",
        "type": "ui_table",
        "z": "532cea09.a25754",
        "group": "b5fdd57b.15eda8",
        "name": "",
        "order": 1,
        "width": 15,
        "height": 12,
        "columns": [
            {
                "field": "Date",
                "title": "Date",
                "width": "150",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "Name",
                "title": "Name",
                "width": "210",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "Photos",
                "title": "Photos",
                "width": "80",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "Size",
                "title": "Size",
                "width": "80",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "Zip",
                "title": "Local",
                "width": "80",
                "align": "center",
                "formatter": "html",
                "formatterParams": {
                    "target": "_blank"
                }
            },
            {
                "field": "Status",
                "title": "Status",
                "width": "140",
                "align": "center",
                "formatter": "plaintext",
                "formatterParams": {
                    "target": "_blank"
                }
            }
        ],
        "outputs": 1,
        "cts": true,
        "x": 750,
        "y": 900,
        "wires": [
            [
                "94364014275292cb",
                "a99e76673208fa0e",
                "66b879845e1108af"
            ]
        ]
    },
    {
        "id": "848ee811969aab53",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "group": "db43d646.2074c8",
        "order": 2,
        "width": 6,
        "height": 1,
        "name": "Status",
        "label": "Status",
        "format": "{{msg.text}}",
        "layout": "row-spread",
        "className": "",
        "x": 530,
        "y": 780,
        "wires": []
    },
    {
        "id": "0d92f7352e862e82",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "prepare",
        "func": "import requests\nimport os\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\nif load(\"feedback_terms\")==\"False\":\n    msg['payload']=\"Please read and agree to the Terms of Use (See Settings Menu) before you can use the OpenScanCloud\"\n    msg['topic'] = 'OpenScanCloud - Terms of Use'\n    return None,msg\n\n\nmsg = msg['payload']\n\nbasedir = '/home/pi/shared/ui/data/'\n\nwith open('/home/pi/shared/log/size_to_split.log', 'r') as file:\n    size_to_split = int(file.read())\nuser = 'openscan'\npw = 'free'\nserver = 'http://openscanfeedback.dnsuser.de:1334/'\ntokenpath = '/home/pi/shared/log/token.log'\n\ndef status(msg):\n    with open('/home/pi/shared/log/cloudstatus.log', 'w+') as file:\n        file.write(msg)\n\ndef OpenScanCloud(cmd, msg):\n    try:\n        r = requests.get(server + cmd, auth=(user, pw), params=msg)\n    except:\n        return {'error':True}\n    if r.status_code == 200:\n        return r.json()\n    else:\n        return {}\n\ndef upload(filelist, ulinks):\n    i = 0\n    for file in filelist:\n        link = ulinks[i]\n        status('uploading ' + str(i+1) + '/' + str(len(filelist)))\n        cmd = 'curl -# -X POST ' + link + ' --header Content-Type:application/octet-stream --data-binary @\"' + file + '\" 2>&1 | tee /home/pi/shared/ui/data/uploadprogress'\n        #if os.system(cmd)!=0:'\n        i = i+1\n        os.system(cmd)\n\n########\nif not os.path.isfile(tokenpath):\n    msg['flag'] = True\n    status('please enter token first')\n    return msg\nwith open(tokenpath, 'r') as file:\n    token = file.read().strip('\\n')\n\n########\nmsg1 = OpenScanCloud('getTokenInfo', {'token':token})\n\nif 'error' in msg1:\n    msg['topic'] = 'Connection to OpenScanCloud failed'\n    msg['payload'] = 'Please check your internet connection'\n    return None,msg\n\nif len(msg1) <= 1:\n    msg['flag'] = True\n    status('invalid token')\n    return msg1\n    \n########\nif msg['Photos'] > msg1['limit_photos'] or msg['Size_full'] > msg1['limit_filesize']:\n    msg['flag'] = True\n    status('limit(s) exceeded')\n    return msg\n\n########\ntemp =  OpenScanCloud('getProjectInfo', {'token':token, 'project':msg['Set']})\nif temp != {}:\n    if temp['status'] != 'created':\n        status('already exists')\n        with open(basedir + 'zip/' + msg['Set'][:-4] + '/status', 'w') as file:\n            file.write(temp['status'])\n        return msg\n\nmsg2={}\nmsg2['token'] = token\nmsg2['parts'] = 1\nmsg['partslist']=[]\n\n#######\nif msg['Size_full'] > size_to_split:\n    for file in os.listdir(basedir + 'temp/'):\n        os.remove(basedir + 'temp/' + file)\n    status('zipping files, please wait ...')\n    #cmd = 'zip ' + basedir + 'zip/' + msg['Set'] + ' --out '+basedir+'temp/'+msg['Set']+ ' -s ' + str(size_to_split/1000000)+'m'\n    cmd = 'split -b ' + str(size_to_split) + ' ' + basedir + 'zip/' + msg['Set'] + ' ' +basedir+'temp/'+msg['Set']\n    os.system(cmd)\n    status('zip done')\n    list = os.listdir(basedir + 'temp/')\n    for l in list:\n        msg['partslist'].append(basedir + 'temp/' + l)\n        msg['partslist'].sort()\n    msg2['parts']=len(msg['partslist'])\nelse:\n    msg['partslist'] = [basedir + 'zip/' +msg['Set']]\n\n#######\nmsg2['photos'] = msg['Photos']\nmsg2['filesize'] = msg['Size_full']\nmsg2['project'] = msg['Set']\n\nmsg1 = OpenScanCloud('createProject', msg2)\n\nif not os.path.isdir(basedir+ 'zip/' + msg['Set'][:-4]):\n    os.mkdir(basedir+ 'zip/' + msg['Set'][:-4])\nwith open(basedir+ 'zip/' + msg['Set'][:-4]+'/status', 'w+') as file:\n    file.write('prepared')\n\nstatus('uploading')\nupload(msg['partslist'], msg1['ulink'])\nstatus('uploaded')\n\nmsg3 = OpenScanCloud('startProject', msg2)\nstatus('project started')\n\nreturn msg",
        "outputs": 2,
        "x": 740,
        "y": 1160,
        "wires": [
            [
                "b05184d6641bb2b8"
            ],
            [
                "2dc686c2a67af804",
                "b05184d6641bb2b8"
            ]
        ]
    },
    {
        "id": "3805d80d5c4330df",
        "type": "inject",
        "z": "532cea09.a25754",
        "name": "Started",
        "props": [
            {
                "p": "payload",
                "v": "",
                "vt": "str"
            },
            {
                "p": "topic",
                "v": "",
                "vt": "string"
            }
        ],
        "repeat": "0.1",
        "crontab": "",
        "once": true,
        "onceDelay": "1",
        "topic": "",
        "x": 240,
        "y": 780,
        "wires": [
            [
                "0c1af0bca861c5e3"
            ]
        ]
    },
    {
        "id": "0c1af0bca861c5e3",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "msg",
        "func": "from time import sleep\n\nwith open('/home/pi/shared/log/cloudstatus.log', 'r') as file:\n    text = file.read()\n    \ntry: \n    if text[0:9] == 'uploading':\n        with open(\"/home/pi/shared/ui/data/uploadprogress\",'r') as file:\n            progress=file.read()[-6:]\n            if progress[-1] == '%':\n                text = text + ' (' + progress + ')'\n    msg['text'] = text\n    return msg\nexcept:\n    pass",
        "outputs": 1,
        "x": 390,
        "y": 780,
        "wires": [
            [
                "848ee811969aab53"
            ]
        ]
    },
    {
        "id": "5575764d0cca9e4d",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "Upload",
        "group": "db43d646.2074c8",
        "order": 4,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Upload",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 420,
        "y": 1160,
        "wires": [
            [
                "e7dc8e99772d573e",
                "ca7c48cb394d5515"
            ]
        ]
    },
    {
        "id": "94364014275292cb",
        "type": "change",
        "z": "532cea09.a25754",
        "name": "set",
        "rules": [
            {
                "t": "set",
                "p": "set",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 890,
        "y": 900,
        "wires": [
            []
        ]
    },
    {
        "id": "66b879845e1108af",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "group": "db43d646.2074c8",
        "order": 3,
        "width": 6,
        "height": 1,
        "name": "Set",
        "label": "Set",
        "format": "{{msg.payload.Set}}",
        "layout": "row-spread",
        "x": 890,
        "y": 940,
        "wires": []
    },
    {
        "id": "b05184d6641bb2b8",
        "type": "change",
        "z": "532cea09.a25754",
        "name": "flag.true",
        "rules": [
            {
                "t": "set",
                "p": "flag",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 920,
        "y": 1160,
        "wires": [
            [
                "193d61f0ef86313b"
            ]
        ]
    },
    {
        "id": "be491724ed831523",
        "type": "function",
        "z": "532cea09.a25754",
        "name": "enable",
        "func": "if (global.get('flag') === false){\n    msg.enabled = false\n    msg.color=\"white\"\n}\nelse{\n    msg.enabled = true\n    msg.color=\"red\"\n    \n}\n\nreturn msg",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 270,
        "y": 1080,
        "wires": [
            [
                "5575764d0cca9e4d",
                "82d81f394957a544",
                "a4ad0ab7e2b0b346",
                "dd57afdace55aeef"
            ]
        ]
    },
    {
        "id": "e7dc8e99772d573e",
        "type": "change",
        "z": "532cea09.a25754",
        "name": "flag.false",
        "rules": [
            {
                "t": "set",
                "p": "flag",
                "pt": "global",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 560,
        "y": 1200,
        "wires": [
            [
                "572911cae73bf634"
            ]
        ]
    },
    {
        "id": "3f494ced7f0160d2",
        "type": "link in",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "a99e76673208fa0e",
            "572911cae73bf634",
            "193d61f0ef86313b",
            "ec9c820eee68a964",
            "23ae2d06184ac1b8",
            "0e8ce0ac4d63a105"
        ],
        "x": 175,
        "y": 1040,
        "wires": [
            [
                "be491724ed831523"
            ]
        ]
    },
    {
        "id": "ca7c48cb394d5515",
        "type": "change",
        "z": "532cea09.a25754",
        "name": "set",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "set",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 550,
        "y": 1160,
        "wires": [
            [
                "0d92f7352e862e82"
            ]
        ]
    },
    {
        "id": "a99e76673208fa0e",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "3f494ced7f0160d2",
            "87574a42938afec4"
        ],
        "x": 855,
        "y": 860,
        "wires": []
    },
    {
        "id": "572911cae73bf634",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "3f494ced7f0160d2",
            "87574a42938afec4"
        ],
        "x": 655,
        "y": 1200,
        "wires": []
    },
    {
        "id": "193d61f0ef86313b",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "3f494ced7f0160d2",
            "87574a42938afec4"
        ],
        "x": 1015,
        "y": 1160,
        "wires": []
    },
    {
        "id": "ec9c820eee68a964",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "mode": "link",
        "links": [
            "1e822fff9bb01f8a",
            "3f494ced7f0160d2"
        ],
        "x": 475,
        "y": 660,
        "wires": []
    },
    {
        "id": "82d81f394957a544",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "Delete set",
        "group": "db43d646.2074c8",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Delete set",
        "tooltip": "",
        "color": "{{color}}",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "",
        "payload": "set.Set",
        "payloadType": "global",
        "topic": "",
        "topicType": "str",
        "x": 420,
        "y": 1120,
        "wires": [
            [
                "01ee99f055f5e32a"
            ]
        ]
    },
    {
        "id": "01ee99f055f5e32a",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "del",
        "func": "msg['Set']=msg['payload']\nmsg['payload']=\"Are you sure to delete and ALL associated files: \"+msg['payload']+\"?\"\nreturn msg",
        "outputs": 1,
        "x": 550,
        "y": 1120,
        "wires": [
            [
                "9bc9e2b9a8e3db00"
            ]
        ]
    },
    {
        "id": "9bc9e2b9a8e3db00",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "No",
        "cancel": "Yes",
        "topic": "",
        "name": "",
        "x": 690,
        "y": 1120,
        "wires": [
            [
                "ed6e5b9fcb79ea71"
            ]
        ]
    },
    {
        "id": "ed6e5b9fcb79ea71",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "del",
        "func": "import os\nimport shutil\n\ndirectory=\"/home/pi/shared/ui/data/zip/\"\n\nif msg['payload']==\"No\":\n    return\n\ntry:\n    os.remove(directory+msg['Set'])\n    shutil.rmtree(directory+msg['Set'][:-4])\nexcept:\n    pass\nreturn msg",
        "outputs": 1,
        "x": 830,
        "y": 1120,
        "wires": [
            [
                "cd05063f8c0e63e9"
            ]
        ]
    },
    {
        "id": "cd05063f8c0e63e9",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "f78df45d7a66d862",
            "c20357dd.374108",
            "e9aab326.a6896",
            "edd22cc7.befe1",
            "19b81967.49db87",
            "8ee1b3bb.7b0b3",
            "d5246b3cc796afc6"
        ],
        "x": 935,
        "y": 1100,
        "wires": []
    },
    {
        "id": "9bd276395edf15c1",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "f78df45d7a66d862",
            "c20357dd.374108",
            "e9aab326.a6896",
            "edd22cc7.befe1",
            "19b81967.49db87",
            "8ee1b3bb.7b0b3",
            "d5246b3cc796afc6"
        ],
        "x": 335,
        "y": 740,
        "wires": []
    },
    {
        "id": "f85aeec273daabb6",
        "type": "change",
        "z": "532cea09.a25754",
        "name": "flag.true",
        "rules": [
            {
                "t": "set",
                "p": "flag",
                "pt": "global",
                "to": "true",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 380,
        "y": 660,
        "wires": [
            [
                "ec9c820eee68a964"
            ]
        ]
    },
    {
        "id": "a9a223de23b72382",
        "type": "inject",
        "z": "532cea09.a25754",
        "name": "Started",
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 240,
        "y": 660,
        "wires": [
            [
                "9bd276395edf15c1",
                "f85aeec273daabb6",
                "ca5f2360b8314c8a"
            ]
        ]
    },
    {
        "id": "ca5f2360b8314c8a",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "msg",
        "func": "with open('/home/pi/shared/log/cloudstatus.log', 'w+') as file:\n    file.write('ready')\n    \n",
        "outputs": 1,
        "x": 370,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "dd57afdace55aeef",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "mode": "link",
        "links": [
            "809c9427e14e2448",
            "a674ecfd090b74ab"
        ],
        "x": 375,
        "y": 1200,
        "wires": []
    },
    {
        "id": "e92171f8beac491b",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "Refresh",
        "group": "db43d646.2074c8",
        "order": 5,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Refresh{{text}}",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "updating status",
        "topicType": "str",
        "x": 300,
        "y": 900,
        "wires": [
            [
                "ebeba311a96254a0",
                "f6ee465759f78750"
            ]
        ]
    },
    {
        "id": "f6ee465759f78750",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "refresh",
        "func": "from time import sleep\nimport requests\nimport os\n\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\nif load(\"feedback_terms\")==\"False\":\n    msg['payload']=\"Please read and agree to the Terms of Use (See Settings Menu) before you can use the OpenScanCloud\"\n    msg['topic']='OpenScanCloud - Terms of Use'\n    return None,msg\n\n\nwith open('/home/pi/shared/log/cloudstatus.log', 'w') as file:\n    file.write('refreshing...')\n\n\nuser = 'openscan'\npw = 'free'\n\nserver = 'http://openscanfeedback.dnsuser.de:1334/'\nbasepath=\"/home/pi/shared/ui/data/zip/\"\n\nwith open('/home/pi/shared/log/token.log', 'r') as file:\n    token = file.read().strip('\\n')\n\n\ndef OpenScanCloud(cmd, msg):\n    try:\n        r = requests.get(server + cmd, auth=(user, pw), params=msg)\n    except:\n        return {'error':True}\n    if r.status_code == 200:\n        return r.json()\n    else:\n        return {}\n\ntest = OpenScanCloud('getTokenInfo',{'token':token})\nif 'error' in test:\n    msg['topic'] = 'Connection to OpenScanCloud failed'\n    msg['payload'] = 'Please check your internet connection'\n    return None,msg\n\n\nmsg={}\nprojects = []\nfor i in os.listdir(basepath):\n    if os.path.isdir(basepath+ '/'+i):\n        if os.path.isfile(basepath+'/'+i+'/status'):\n            with open(basepath+'/'+i+'/status', 'r') as file:\n                status = file.read().strip('\\n')\n                if status in ['expired', 'processing done', 'processing failed']:\n                    continue\n        projects.append(i)\n\nfor p in projects:\n    answer = OpenScanCloud('getProjectInfo',{'token':token, 'project':p+'.zip'})\n    if answer == {}:\n        os.system('sudo rm -r ' + basepath + '/' + p)\n    else:\n        with open(basepath + '/' + p + '/status', 'w+') as file:\n            file.write(answer['status'])\n        with open(basepath + '/' + p + '/download', 'w+') as file:\n            file.write(answer['dlink'])\n\nmsg['list'] = projects\n\nsleep(1)\nwith open('/home/pi/shared/log/cloudstatus.log', 'w') as file:\n    file.write('ready')\n\nreturn msg\n",
        "outputs": 2,
        "x": 460,
        "y": 900,
        "wires": [
            [
                "70db38966641784d"
            ],
            [
                "2ddd7b1a63dca931"
            ]
        ]
    },
    {
        "id": "ebeba311a96254a0",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "limit :)",
        "func": "from time import sleep\n\nmsg2={}\nmsg2['enabled'] = True\n\nmsg['enabled'] = False\nnode.send(msg)\n\nwait = 15\n\nfor i in range (wait):\n    msg['text'] = ' ('+ str(wait - i)+')'\n    node.send(msg)\n\nmsg['enabled'] = True\nmsg['text']=\"\"\n\n\nreturn msg",
        "outputs": 1,
        "x": 290,
        "y": 940,
        "wires": [
            [
                "289f8cc1a280caaa"
            ]
        ]
    },
    {
        "id": "289f8cc1a280caaa",
        "type": "delay",
        "z": "532cea09.a25754",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 460,
        "y": 980,
        "wires": [
            [
                "e92171f8beac491b"
            ]
        ]
    },
    {
        "id": "a4ad0ab7e2b0b346",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "Delete all",
        "group": "db43d646.2074c8",
        "order": 7,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Delete All",
        "tooltip": "",
        "color": "{{color}}",
        "bgcolor": "{{background}}",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "",
        "topicType": "str",
        "x": 420,
        "y": 1080,
        "wires": [
            [
                "9ded3c06b7c1957d"
            ]
        ]
    },
    {
        "id": "9ded3c06b7c1957d",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "del",
        "func": "msg['Set']=msg['payload']\nmsg['payload']=\"Are you sure to delete ALL saved image sets? This can not be undone!\"\nreturn msg",
        "outputs": 1,
        "x": 550,
        "y": 1080,
        "wires": [
            [
                "9e150f78356f1431"
            ]
        ]
    },
    {
        "id": "9e150f78356f1431",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "No",
        "cancel": "Yes",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 690,
        "y": 1080,
        "wires": [
            [
                "642962fe1a1cb990"
            ]
        ]
    },
    {
        "id": "a674ecfd090b74ab",
        "type": "link in",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "dd57afdace55aeef"
        ],
        "x": 175,
        "y": 900,
        "wires": [
            [
                "e92171f8beac491b"
            ]
        ]
    },
    {
        "id": "2dc686c2a67af804",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "Terms",
        "x": 910,
        "y": 1200,
        "wires": [
            []
        ]
    },
    {
        "id": "2ddd7b1a63dca931",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "Terms",
        "x": 610,
        "y": 940,
        "wires": [
            []
        ]
    },
    {
        "id": "642962fe1a1cb990",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "del",
        "func": "import os\nimport shutil\n\ndir=\"/home/pi/shared/ui/data/zip/\"\n\nif msg['payload']==\"No\":\n    return\n\nfor i in os.listdir(dir):\n    if os.path.isdir(dir + i):\n        shutil.rmtree(dir + i)\n    else:\n        os.remove(dir + i)\n\nreturn msg",
        "outputs": 1,
        "x": 830,
        "y": 1080,
        "wires": [
            [
                "cd05063f8c0e63e9"
            ]
        ]
    },
    {
        "id": "9045d04f1a8374a3",
        "type": "debug",
        "z": "532cea09.a25754",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "x": 710,
        "y": 800,
        "wires": []
    },
    {
        "id": "4c463e9a26f61e69",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "Refresh",
        "group": "189a50ad0e14bb28",
        "order": 6,
        "width": 3,
        "height": 1,
        "passthru": true,
        "label": "Refresh",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "updating status ...",
        "topicType": "str",
        "x": 280,
        "y": 1440,
        "wires": [
            [
                "88ef66769c7d3e64"
            ]
        ]
    },
    {
        "id": "88ef66769c7d3e64",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "refresh",
        "func": "import requests\nimport os\n\nuser = 'openscan'\npw = 'free'\nserver = 'http://openscanfeedback.dnsuser.de:1334/'\n\nwith open('/home/pi/shared/log/token.log', 'r') as file:\n    token = file.read().strip('\\n')\n\ndef OpenScanCloud(cmd, msg):\n    try:\n        r = requests.get(server + cmd, auth=(user, pw), params=msg)\n    except:\n        return {}\n    if r.status_code == 200:\n        return r.json()\n    else:\n        return {}\n\nmsg={}\n\nmsg = OpenScanCloud('getTokenInfo', {'token':token})\n\nmsg['enabled'] = True\ntry:\n    msg['limit_filesize']=float(msg['limit_filesize'])/1000000000\n    msg['credit']=float((msg['credit'])/1000000)/1000\n    return msg\nexcept:\n    return\n",
        "outputs": 1,
        "x": 420,
        "y": 1440,
        "wires": [
            [
                "0455709bee9764b9"
            ]
        ]
    },
    {
        "id": "32b5fd9d84eea399",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "group": "189a50ad0e14bb28",
        "order": 4,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Max. Number of Photos:",
        "format": "{{msg.limit_photos}}",
        "layout": "row-spread",
        "className": "",
        "x": 450,
        "y": 1500,
        "wires": []
    },
    {
        "id": "2e6e129ea71de211",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "group": "189a50ad0e14bb28",
        "order": 5,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Max. Filesize (GB):",
        "format": "{{msg.limit_filesize}}",
        "layout": "row-spread",
        "className": "",
        "x": 430,
        "y": 1540,
        "wires": []
    },
    {
        "id": "497fdd35bbc94019",
        "type": "ui_text",
        "z": "532cea09.a25754",
        "group": "189a50ad0e14bb28",
        "order": 3,
        "width": 0,
        "height": 0,
        "name": "",
        "label": "Credit (GB):",
        "format": "{{msg.credit}}",
        "layout": "row-spread",
        "className": "",
        "x": 410,
        "y": 1580,
        "wires": []
    },
    {
        "id": "0d685a4bcc120205",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "save",
        "func": "import requests\nimport os\n\nif msg['payload']!=\"Yes\":\n    return None,msg\n\nuser = 'openscan'\npw = 'free'\n\nserver = 'http://openscanfeedback.dnsuser.de:1334/'\nbasepath=\"/home/pi/shared/ui/data/zip/\"\n\ndef OpenScanCloud(cmd, msg):\n    r = requests.get(server + cmd, auth=(user, pw), params=msg)\n    if r.status_code == 200:\n        return r.json()\n    else:\n        return {}\n\ntry:\n    msg1 = OpenScanCloud('getTokenInfo', {'token':msg['token']})\n    if len(msg1) <= 1:\n        msg['payload'] = 'Could not verify token'\n        return msg \n    msg1['limit_filesize']=float(msg1['limit_filesize'])/1000000000\n    msg1['credit']=float((msg1['credit'])/1000000)/1000\n    msg1['enabled'] = True\nexcept:\n    pass\n\nwith open(\"/home/pi/shared/log/token.log\",\"w+\") as file:\n    file.write(str(msg['token']))\n    \nmsg['payload'] = 'Token verified and saved'\nreturn msg, msg1",
        "outputs": 2,
        "x": 970,
        "y": 1320,
        "wires": [
            [
                "1fdb1e53be0ebfcf",
                "eb95cd0b2be38bd7"
            ],
            [
                "03ab70b9611397f1"
            ]
        ]
    },
    {
        "id": "1fdb1e53be0ebfcf",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "topic": "",
        "name": "",
        "x": 1130,
        "y": 1280,
        "wires": [
            []
        ]
    },
    {
        "id": "f2535934168b484d",
        "type": "ui_text_input",
        "z": "532cea09.a25754",
        "name": "",
        "label": "Token",
        "tooltip": "",
        "group": "189a50ad0e14bb28",
        "order": 2,
        "width": 0,
        "height": 0,
        "passthru": false,
        "mode": "text",
        "delay": "0",
        "topic": "",
        "sendOnBlur": true,
        "topicType": "str",
        "x": 570,
        "y": 1340,
        "wires": [
            [
                "3723c9c679def550"
            ]
        ]
    },
    {
        "id": "3723c9c679def550",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "Save?",
        "func": "msg['token'] = msg['payload']\n\nif len(msg['payload'])>=14:\n    \n    msg[\"payload\"]='Save and verify token: ' + msg['payload']\n    return msg\nelse:\n    return None,msg",
        "outputs": 2,
        "x": 690,
        "y": 1340,
        "wires": [
            [
                "24a77651b2ccfa1d"
            ],
            [
                "b5f7c9b85ead551e"
            ]
        ]
    },
    {
        "id": "397c9d4924926f9b",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "text",
        "func": "with open('/home/pi/shared/log/token.log','r') as file:\n    id=file.read()[0:8]\nmsg['payload']=id+\"...\"\nif len(id)==0:\n    msg['payload']=\"enter token\"\nreturn msg",
        "outputs": 1,
        "x": 450,
        "y": 1340,
        "wires": [
            [
                "f2535934168b484d"
            ]
        ]
    },
    {
        "id": "122c68f6b995d7e1",
        "type": "link in",
        "z": "532cea09.a25754",
        "name": "tk",
        "links": [
            "eb95cd0b2be38bd7",
            "b5f7c9b85ead551e",
            "d2f21710.8fbd08"
        ],
        "x": 320,
        "y": 1340,
        "wires": [
            [
                "397c9d4924926f9b"
            ]
        ]
    },
    {
        "id": "24a77651b2ccfa1d",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "No",
        "cancel": "Yes",
        "raw": false,
        "topic": "",
        "name": "",
        "x": 830,
        "y": 1320,
        "wires": [
            [
                "0d685a4bcc120205"
            ]
        ]
    },
    {
        "id": "b5f7c9b85ead551e",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "122c68f6b995d7e1",
            "5d267acc10020091"
        ],
        "x": 775,
        "y": 1360,
        "wires": []
    },
    {
        "id": "03ab70b9611397f1",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "5d267acc10020091",
            "d22f9d547fac8d38"
        ],
        "x": 1075,
        "y": 1360,
        "wires": []
    },
    {
        "id": "d22f9d547fac8d38",
        "type": "link in",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "03ab70b9611397f1",
            "0455709bee9764b9"
        ],
        "x": 295,
        "y": 1500,
        "wires": [
            [
                "32b5fd9d84eea399",
                "2e6e129ea71de211",
                "497fdd35bbc94019"
            ]
        ]
    },
    {
        "id": "17fb766eadd0ef95",
        "type": "inject",
        "z": "532cea09.a25754",
        "name": "Started",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "enabled",
                "v": "false",
                "vt": "bool"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": true,
        "onceDelay": "0.1",
        "topic": "",
        "payloadType": "str",
        "x": 300,
        "y": 1400,
        "wires": [
            [
                "0455709bee9764b9"
            ]
        ]
    },
    {
        "id": "076298569fb460ed",
        "type": "comment",
        "z": "532cea09.a25754",
        "name": "CLOUD",
        "info": "",
        "x": 180,
        "y": 1220,
        "wires": []
    },
    {
        "id": "0455709bee9764b9",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "mode": "link",
        "links": [
            "d22f9d547fac8d38"
        ],
        "x": 515,
        "y": 1440,
        "wires": []
    },
    {
        "id": "eb95cd0b2be38bd7",
        "type": "link out",
        "z": "532cea09.a25754",
        "name": "",
        "links": [
            "122c68f6b995d7e1",
            "5d267acc10020091"
        ],
        "x": 1075,
        "y": 1320,
        "wires": []
    },
    {
        "id": "79930322b5a6b444",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "prompt",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "Cancel",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 430,
        "y": 1640,
        "wires": [
            [
                "a39674c7e424b135"
            ]
        ]
    },
    {
        "id": "a39674c7e424b135",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "msg",
        "func": "import re\n\nif msg['payload'] == 'Cancel':\n    return\n\nmail = msg['payload']\nemail_regex = re.compile(r\"[^@]+@[^@]+\\.[^@]+\")\n\nif email_regex.match(mail) != None:\n    msg['mail'] = mail\n    msg['topic'] = 'OpenScanCloud Registration (2/3)'\n    msg['payload'] = 'Enter your first name'\n    return msg\nmsg['payload'] = 'invalid input'\nreturn None,msg\n",
        "outputs": 2,
        "x": 570,
        "y": 1640,
        "wires": [
            [
                "65dd7ab3da1687b9"
            ],
            [
                "6cba41cfa9e632cc"
            ]
        ]
    },
    {
        "id": "6cba41cfa9e632cc",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 710,
        "y": 1680,
        "wires": [
            []
        ]
    },
    {
        "id": "65dd7ab3da1687b9",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "prompt",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "Cancel",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 710,
        "y": 1640,
        "wires": [
            [
                "525c1dcd483e573b"
            ]
        ]
    },
    {
        "id": "525c1dcd483e573b",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "msg",
        "func": "import re\n\nif msg['payload'] == 'Cancel':\n    return\n\nmsg['forename'] = msg['payload']\nmsg['topic'] = 'OpenScanCloud Registration (3/3)'\nmsg['payload'] = 'Enter your last name'\nreturn msg",
        "outputs": 1,
        "x": 850,
        "y": 1640,
        "wires": [
            [
                "afe4528367add771"
            ]
        ]
    },
    {
        "id": "afe4528367add771",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "prompt",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "SUBMIT",
        "cancel": "Cancel",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 990,
        "y": 1640,
        "wires": [
            [
                "17bcf90bbdd57923"
            ]
        ]
    },
    {
        "id": "17bcf90bbdd57923",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "msg",
        "func": "import requests\nimport os\n\nif msg['payload'] == 'Cancel':\n    return\n\nuser = 'openscan'\npw = 'free'\nserver = 'http://openscanfeedback.dnsuser.de:1334/'\n\ndef OpenScanCloud(cmd, msg):\n    try:\n        r = requests.get(server + cmd, auth=(user, pw), params=msg)\n        return r.status_code\n    except:\n        return 400\nmsg['lastname'] = msg['payload']\n\nmsg2 = {}\n\nfor i in ['forename','lastname','mail']:\n    msg2[i] = msg[i]\n\nstatus = OpenScanCloud('requestToken',msg2)\n\nmsg['topic'] = 'OpenScanCloud Registration - Success'\nmsg['payload'] = 'registration done, you will get an email with your token within the next one or two days :)'\nif status != 200:\n    msg['topic'] = 'OpenScanCloud Registration - Failed'\n\n    msg['payload'] = 'Registration failed, please try again.'\n\nreturn msg",
        "outputs": 1,
        "x": 1130,
        "y": 1640,
        "wires": [
            [
                "b9cc3f6f88b1433b"
            ]
        ]
    },
    {
        "id": "4e615ddad0877d2a",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "Register",
        "group": "189a50ad0e14bb28",
        "order": 7,
        "width": 3,
        "height": 1,
        "passthru": false,
        "label": "Register",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "Please enter your email address:",
        "payloadType": "str",
        "topic": "Requesting an OpenScanCloud Token",
        "topicType": "str",
        "x": 280,
        "y": 1640,
        "wires": [
            [
                "79930322b5a6b444"
            ]
        ]
    },
    {
        "id": "b9cc3f6f88b1433b",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": false,
        "className": "",
        "topic": "",
        "name": "",
        "x": 1270,
        "y": 1640,
        "wires": [
            []
        ]
    },
    {
        "id": "1356a70b3708dd57",
        "type": "link in",
        "z": "532cea09.a25754",
        "name": "disable",
        "links": [
            "05762fd6277a4e0a",
            "0295b7fad0351b47"
        ],
        "x": 175,
        "y": 1440,
        "wires": [
            [
                "4c463e9a26f61e69"
            ]
        ]
    },
    {
        "id": "aca1df27761f3214",
        "type": "link in",
        "z": "532cea09.a25754",
        "name": "disable",
        "links": [],
        "x": 175,
        "y": 1640,
        "wires": [
            [
                "4e615ddad0877d2a"
            ]
        ]
    },
    {
        "id": "d9e1f3e22d3c297f",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "Cloud",
        "group": "189a50ad0e14bb28",
        "order": 1,
        "width": 0,
        "height": 0,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "transparent",
        "className": "",
        "icon": "fa-question-circle",
        "payload": "SSH can be used to log in to your Raspberry Pi (for instance with Putty) <br> Activating SSH access poses a security risk and you should only use it for debugging or development. <br> standard user is: pi and password: raspberry <br> please change it as soon as possible",
        "payloadType": "str",
        "topic": "test",
        "topicType": "msg",
        "x": 230,
        "y": 1780,
        "wires": [
            [
                "842c1ad587a7d5fe"
            ]
        ]
    },
    {
        "id": "842c1ad587a7d5fe",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "msg",
        "func": "msg['payload']='''<p style=\"text-align: center;\"><span style=\"font-size: 22px;\"><u><strong>OpenScanCloud</strong></u></span></p>\n<p><strong>Description</strong></p>\n<p style=\"margin-left: 20px;\">The OpenScanCloud is a free processing tool, where you can upload your image sets to the OpenScan Servers.</p>\n<p style=\"margin-left: 20px;\">After uploading an image set to the OpenScanCloud, processing will take some time, and you will receive the resulting 3d model by email.</p>\n<p><strong>Token</strong></p>\n<p id=\"isPasted\" style=\"margin-left: 20px;\">The only thing needed is an individual token, which will be associated with your first and last name and your email address.</p>\n<p style=\"margin-left: 20px;\">You require registering for such a token by clicking the &quot;Apply&quot; button and entering your details.&nbsp;</p>\n<p style=\"margin-left: 20px;\">After your request has been approved, you will get an email with a 32-digit token.</p>\n<p id=\"isPasted\"><strong>Credit</strong></p>\n<p style=\"margin-left: 20px;\">Note, that each user has a given amount of upload credit, which is measured in gigabyte and can be increased at any time by emailing to cloud@openscan.eu</p>\n<p style=\"margin-left: 20px;\">Once you run out of credit, any newly uploaded image sets will be declined.</p>\n<p id=\"isPasted\"><strong>Maximum number of photos</strong></p>\n<p style=\"margin-left: 20px;\">There is a limit on the numbers of photos an image set is allowed to contain.</p>\n<p id=\"isPasted\"><strong>Maximum Filesize</strong></p>\n<p style=\"margin-left: 20px;\">The size of an image set is limited by default in order to reduce processing times and the data traffic.</p>\n<p style=\"margin-left: 20px;\">You can simply reduce the size of an image set by cropping the images in the scan tab</p>\n<p id=\"isPasted\"><strong>Refresh</strong></p>\n<p style=\"margin-left: 20px;\">Hitting refresh will update your credit, max. number of photos and max. filesize with the current values from the servers.</p>\n<p id=\"isPasted\"><strong>Register</strong></p>\n<p style=\"margin-left: 20px;\">Register your personal token by submitting your email address, first and last name. It might take some time until you get an approval and your personal token by email to the given address.</p>'''\nreturn msg",
        "outputs": 1,
        "x": 450,
        "y": 1780,
        "wires": [
            [
                "f44d784485bb9b44"
            ]
        ]
    },
    {
        "id": "f44d784485bb9b44",
        "type": "ui_toast",
        "z": "532cea09.a25754",
        "position": "dialog",
        "displayTime": "3",
        "highlight": "",
        "sendall": true,
        "outputs": 1,
        "ok": "OK",
        "cancel": "",
        "raw": true,
        "className": "",
        "topic": "",
        "name": "",
        "x": 630,
        "y": 1780,
        "wires": [
            []
        ]
    },
    {
        "id": "47a36c60d4f9b32c",
        "type": "comment",
        "z": "532cea09.a25754",
        "name": "HELP",
        "info": "",
        "x": 170,
        "y": 1720,
        "wires": []
    },
    {
        "id": "42247a77e7f46c74",
        "type": "ui_button",
        "z": "532cea09.a25754",
        "name": "OSC",
        "group": "db43d646.2074c8",
        "order": 1,
        "width": 6,
        "height": 1,
        "passthru": false,
        "label": "",
        "tooltip": "",
        "color": "",
        "bgcolor": "transparent",
        "className": "",
        "icon": "fa-question-circle",
        "payload": "",
        "payloadType": "str",
        "topic": "test",
        "topicType": "msg",
        "x": 230,
        "y": 1820,
        "wires": [
            [
                "8d5cec6372564f57"
            ]
        ]
    },
    {
        "id": "8d5cec6372564f57",
        "type": "python3-function",
        "z": "532cea09.a25754",
        "name": "msg",
        "func": "msg['payload']='''<p style=\"text-align: center;\"><span style=\"font-size: 22px;\"><u><strong>OpenScanCloud</strong></u></span></p>\n<p style=\"margin-left: 20px;\">The OpenScanCloud is a free service, where you can upload your datasets to the OpenScan servers. The server will reconstruct<a href=\"http://openscanpi:1880/ui\"></a> your 3d model. The result will be stored on Dropbox for seven days and you will get a private download link by email.&nbsp;</p>\n<p style=\"margin-left: 20px;\">In order to use the service, you need to register (name + email address) via the settings menu and agree to the Terms of Use.</p>\n<p><strong>Upload</strong></p>\n<p style=\"margin-left: 20px;\">First, select an image set from the list. By clicking upload, the set will be split and zipped, which might take some time. After that, the individual 200mb chunks will be uploaded to the OpenScanCloud for processing. Note, that it is not possible to create a new photo set during the upload process and vise versa.</p>\n<p><strong>Refresh</strong></p>\n<p style=\"margin-left: 20px;\">By clicking on refresh, the status of all prior uploaded image sets will be queried from the OpenScanCloud server. And the <em>column&nbsp;</em><em>Status</em> will be updated with on of the following statuses:</p>\n<p style=\"margin-left: 20px;\"><u>started&nbsp;</u>- indicating that your request and files have been transmitted and the server will start working on your set as soon as possible.</p>\n<p style=\"margin-left: 20px;\"><u>file approved</u> - your files have been loaded and approved</p>\n<p style=\"margin-left: 20px;\"><u>processing started</u> - the server started working on your files. You should get an email with the result within the next minutes.</p>\n<p style=\"margin-left: 20px;\"><u>processing done</u> - Processing succeeded and you should find an email with the download link of your 3d model (sender: <a href=\"mailto:cloud@openscan.eu\">cloud@openscan.eu</a>)</p>\n<p style=\"margin-left: 20px;\">processing failed - OpenScanCloud could not create a 3d model of your image set. Please see the email with some further details and possible reasons.</p>\n<p><strong>Delete Files</strong></p>\n<p style=\"margin-left: 20px;\">You can either delete individual or all stored image sets in order to free some memory. Note, that this step can not be undone.</p>\n<p style=\"margin-left: 20px;\">You will get a notification, once the 80% or more of the disc space are in use.</p>\n<p style=\"margin-left: 20px;\">IMPORTANT NOTE: Running out of memory might result in an instable or even inoperable user interface, so please do not ignore the memory warning!</p>\n'''\nreturn msg",
        "outputs": 1,
        "x": 450,
        "y": 1820,
        "wires": [
            [
                "f44d784485bb9b44"
            ]
        ]
    },
    {
        "id": "1ee53eb5.a8f111",
        "type": "ui_button",
        "z": "a6098217.f379a",
        "g": "54e0acc4.d07814",
        "name": "home",
        "group": "4cc9cd95.16ff14",
        "order": 1,
        "width": 2,
        "height": 1,
        "passthru": false,
        "label": "Home",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "0",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 120,
        "wires": [
            [
                "c4023e41.a139b"
            ]
        ]
    },
    {
        "id": "c4023e41.a139b",
        "type": "ui_ui_control",
        "z": "a6098217.f379a",
        "g": "54e0acc4.d07814",
        "name": "",
        "events": "change",
        "x": 360,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "e9c00d10.7b867",
        "type": "python3-function",
        "z": "a6098217.f379a",
        "g": "3241690b.e2fcf6",
        "name": "Turn Table Motor",
        "func": "##Module laden##\n\nimport time\nfrom time import sleep\nimport RPi.GPIO as GPIO\nfrom picamera import PiCamera\nimport math\nfrom zipfile import ZipFile\nimport os\nfrom PIL import Image\n\n##Ausgänge am RPi einrichten\nGPIO.setmode(GPIO.BCM)\nGPIO.setwarnings(False)\n\n#Funktion zum schreiben von Daten in die Log datei!\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n        \n#Funktion zum lesen von Log dateien\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\nif load(\"currentstatus_rpi\")==\"no camera found\" or load(\"currentstatus_rpi\")[:5]==\"Featu\":\n    return\n\n#Variable mit der payload befüllen#\n###################################\n\nnumberofphotos = int(msg['Photos'])\nlevel = int(msg['Ebenen'])\n\n\n#Variable mit log datei befüllen#\n#################################\nttspr = int(load(\"turntable_stepsperrotation\"))\ncspr = int(load(\"rotor_stepsperrotation\"))\nprojectname = load(\"projectname\")\nshutterspeed = 100 * int(load(\"shutterspeed\"))\nresx = int(load(\"camera_resolution_x\"))\nresy = int(load(\"camera_resolution_y\"))\ncurrentstatus = load(\"currentstatus_rpi\")\ncropx = float(load(\"cropx\"))\ncropy = float(load(\"cropy\"))\nawb_red = float(load(\"awb_red\"))\nawb_blue = float(load(\"awb_blue\"))\nhomecounterTT = int(load(\"homeTT\"))\nhomecounterC = int(load(\"home\"))\nstartangle = int(load(\"startangle\"))\nledstatus = str(load(\"ledstatus\"))\n##################################\n#on = 150\n#with open(\"/home/pi/shared/log/ledstatus.log\", \"w\") as file:\n    #file.write(on)\n    \n    \n#Motor-Pins definieren!\n\ncontrol_pinsTT = [26,19,13,6]\ncontrol_pinsC =[5,11,9,10]\n\ndef TTMotor(angle):\n    global step_count\n    \n    step_count = int(angle * ttspr/360)\n    \n    for pin in control_pinsTT:\n        GPIO.setup(pin, GPIO.OUT)\n        GPIO.output(pin, 0)\n   \n    if (step_count > 0):\n        halfstep_seq = [\n        [1,0,0,0],\n        [1,1,0,0],\n        [0,1,0,0],\n        [0,1,1,0],\n        [0,0,1,0],\n        [0,0,1,1],\n        [0,0,0,1],\n        [1,0,0,1]\n        ]\n       \n    else:\n        halfstep_seq = [\n        [1,0,0,1],\n        [0,0,0,1],\n        [0,0,1,1],\n        [0,0,1,0],\n        [0,1,1,0],\n        [0,1,0,0],\n        [1,1,0,0],\n        [1,0,0,0]\n        ]\n        step_count = step_count * -1\n        \n\n\n    for i in range(step_count):\n        for halfstep in range(8):\n\n            for pin in range(4):\n                GPIO.output(control_pinsTT[pin], halfstep_seq[halfstep][pin])\n            time.sleep(0.001)\n            \ndef CameraMotor(angle):\n    global step_count2\n    \n    step_count2 = int(angle * cspr/360)\n    \n    for pin in control_pinsC:\n        GPIO.setup(pin, GPIO.OUT)\n        GPIO.output(pin, 0)\n   \n    if (step_count2 > 0):\n        halfstep_seq = [\n        [1,0,0,0],\n        [1,1,0,0],\n        [0,1,0,0],\n        [0,1,1,0],\n        [0,0,1,0],\n        [0,0,1,1],\n        [0,0,0,1],\n        [1,0,0,1]\n        ]\n       \n    else:\n        halfstep_seq = [\n        [1,0,0,1],\n        [0,0,0,1],\n        [0,0,1,1],\n        [0,0,1,0],\n        [0,1,1,0],\n        [0,1,0,0],\n        [1,1,0,0],\n        [1,0,0,0]\n        ]\n        step_count2 = step_count2 * -1\n        \n\n\n    for i in range(step_count2):\n        for halfstep in range(8):\n\n            for pin in range(4):\n                GPIO.output(control_pinsC[pin], halfstep_seq[halfstep][pin])\n            time.sleep(0.001)\n     \n#########################--------------\ndef zip(filepath):\n    with ZipFile(\"/home/pi/shared/temp.zip\", \"a\") as zip:\n        zip.write(filepath, os.path.basename(filepath))\n    os.remove(filepath)\n    \nwrite(\"currentstatus_rpi\",\"Routine-preparing\")\nsleep(1.5)\n\nprojectcode = time.strftime(\"20%y-%m-%d_%H.%M.%S-\") + projectname + '/'\n\ndirname = '/home/pi/shared/' + projectcode\n\nos.makedirs(dirname)\n\ncamera = PiCamera(resolution=(resx, resy))\n\n\n\n###############+++++++\n\n    \n\n###############+++++\ndef run():\n    counter = 0\n    #CameraMotor(5)\n    \n    for x in range (0, level):\n        if load(\"currentstatus_rpi\")==\"Routine-stopping\":\n            break\n        write(\"currentstatus_rpi\",\"Routine-Photo \"+str(counter)+\" of \"+str(numberofphotos))\n        Cturn = (1500/level) / (cspr/360)\n        CameraMotor(Cturn)\n        ttTurn = 360 / numberofphotos\n        for x in range (0,numberofphotos):\n            counter = counter + 1\n            \n            TTMotor(ttTurn)\n            \n            filepath = dirname + str(counter) + \".jpg\"\n            camera.iso = 100\n            camera.meter_mode = 'spot'\n            camera.shutter_speed = shutterspeed\n            camera.exposure_mode = 'off'\n            camera.awb_mode = 'off'\n            camera.awb_gains = (awb_red, awb_blue)\n            camera.brightness = 50\n            camera.contrast = 0\n            camera.exposure_compensation = 0\n            zoom_x_center = cropx / 200\n            zoom_y_center = cropy / 200\n            zoom_x_width = 1 - cropx / 100\n            zoom_y_height = 1 - cropy / 100\n            x = int(resx * zoom_x_width)\n            y = int(resy * zoom_y_height)\n            camera.zoom = (zoom_x_center, zoom_y_center, zoom_x_width, zoom_y_height)\n            camera.capture(filepath, quality=100, resize=(x, y))\n            if load(\"preview\") == \"true\":\n                img = Image.open(filepath)\n                img = img.resize([int(0.3 * s) for s in img.size])\n                img.save(\"/home/pi/shared/ui/data/preview.jpg\")\n                img.close()\n            zip(filepath)\n        \n    \n################\n    \nrun()\ncamera.close()\ntry:\n    os.rename('/home/pi/shared/temp.zip', '/home/pi/shared/ui/data/zip/' + projectcode[:-1] + '.zip')\n    os.rmdir(dirname)\nexcept:\n    pass\n\n\n\nwrite(\"currentstatus_rpi\",\"Routine-done\")\n\n\n\n\n\n###################################\n\nTTstep = int(homecounterTT) + int(step_count)\nwrite(\"homeTT\",TTstep)\n\nCStep = int(homecounterC) + int(step_count2)\nwrite(\"home\",CStep)\n##################################\n\n\n\nwrite(\"currentstatus_rpi\", \"--READY--\")\nGPIO.cleanup()\n\n\nmsg['enable']=bool(False)\nreturn msg",
        "outputs": 1,
        "x": 630,
        "y": 560,
        "wires": [
            []
        ]
    },
    {
        "id": "916ee39b.c4638",
        "type": "ui_button",
        "z": "a6098217.f379a",
        "g": "3241690b.e2fcf6",
        "name": "",
        "group": "4cc9cd95.16ff14",
        "order": 14,
        "width": 4,
        "height": 2,
        "passthru": false,
        "label": "Routine-v1",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "date",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 560,
        "wires": [
            [
                "464cad24.43dff4"
            ]
        ]
    },
    {
        "id": "fa6b9cd2.79985",
        "type": "ui_dropdown",
        "z": "a6098217.f379a",
        "g": "77ae0818.c9dc48",
        "name": "Number of Photos",
        "label": "",
        "tooltip": "",
        "place": "Number of Photos",
        "group": "4cc9cd95.16ff14",
        "order": 4,
        "width": 6,
        "height": 4,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "5 Photos",
                "value": 5,
                "type": "num"
            },
            {
                "label": "10 Photos",
                "value": 10,
                "type": "num"
            },
            {
                "label": "20 Photos",
                "value": 20,
                "type": "num"
            },
            {
                "label": "30 Photos",
                "value": 30,
                "type": "num"
            },
            {
                "label": "40 Photos",
                "value": 40,
                "type": "num"
            },
            {
                "label": "50 Photos",
                "value": 50,
                "type": "num"
            },
            {
                "label": "100 Photos",
                "value": 100,
                "type": "num"
            },
            {
                "label": "200 Photos",
                "value": 150,
                "type": "num"
            },
            {
                "label": "300 Photos",
                "value": 200,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 190,
        "y": 400,
        "wires": [
            [
                "3a9769d9.41eb06"
            ]
        ]
    },
    {
        "id": "3a9769d9.41eb06",
        "type": "change",
        "z": "a6098217.f379a",
        "g": "77ae0818.c9dc48",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "numberofphotos1",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 450,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "2f5b5fbb.ef085",
        "type": "ui_button",
        "z": "a6098217.f379a",
        "g": "f5f62925.b192f8",
        "name": "",
        "group": "4cc9cd95.16ff14",
        "order": 7,
        "width": 4,
        "height": 2,
        "passthru": false,
        "label": "nach Hause",
        "tooltip": "",
        "color": "",
        "bgcolor": "",
        "className": "",
        "icon": "",
        "payload": "",
        "payloadType": "str",
        "topic": "topic",
        "topicType": "msg",
        "x": 150,
        "y": 720,
        "wires": [
            [
                "f0ff2aee.c30f58"
            ]
        ]
    },
    {
        "id": "464cad24.43dff4",
        "type": "change",
        "z": "a6098217.f379a",
        "g": "3241690b.e2fcf6",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "Photos",
                "pt": "msg",
                "to": "numberofphotos1",
                "tot": "global"
            },
            {
                "t": "set",
                "p": "Ebenen",
                "pt": "msg",
                "to": "numberoflevel",
                "tot": "global"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 560,
        "wires": [
            [
                "e9c00d10.7b867"
            ]
        ]
    },
    {
        "id": "f0ff2aee.c30f58",
        "type": "python3-function",
        "z": "a6098217.f379a",
        "g": "f5f62925.b192f8",
        "name": "Turn Table Home",
        "func": "import time\nfrom time import sleep\nimport RPi.GPIO as GPIO\n\nGPIO.setmode(GPIO.BCM)\nGPIO.setwarnings(False)\n\n\ndef write(parameter,value):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"w\") as file:\n        file.write(str(value))\n\ndef load(parameter):\n    with open(\"/home/pi/shared/log/\"+parameter+\".log\", \"r\") as file:\n        parameter=file.read()\n    return parameter\n\n\n#Motor-Pins\n\ncontrol_pins = [26,19,13,6]\n\nhomecounter = int(load(\"homeTT\")) \nhalfstep_seq = []\n \n      \n    \nif homecounter > 0: \n    halfstep_seq = [\n    [1,0,0,1],\n    [0,0,0,1],\n    [0,0,1,1],\n    [0,0,1,0],\n    [0,1,1,0],\n    [0,1,0,0],\n    [1,1,0,0],\n    [1,0,0,0]\n    ] \n          \n    \n    \n          \n    \n    \nelse: \n    halfstep_seq = [\n    [1,0,0,0],\n    [1,1,0,0],\n    [0,1,0,0],\n    [0,1,1,0],\n    [0,0,1,0],\n    [0,0,1,1],\n    [0,0,0,1],\n    [1,0,0,1]\n    ] \n    homecounter = homecounter *-1\n\n\nfor pin in control_pins:\n    \n  GPIO.setup(pin, GPIO.OUT)\n  GPIO.output(pin, 0)\n  \n  \nfor i in range(homecounter):\n  for halfstep in range(8):\n\n    for pin in range(4):\n      GPIO.output(control_pins[pin], halfstep_seq[halfstep][pin])\n    time.sleep(0.001)\n \nGPIO.cleanup()\n\n\nwrite(\"homeTT\", 0)\n\nmsg['payload'] = \"0,0,0\"\n\nreturn msg\n\n\n\n",
        "outputs": 1,
        "x": 370,
        "y": 720,
        "wires": [
            []
        ]
    },
    {
        "id": "78e72bd8.ec0b74",
        "type": "change",
        "z": "a6098217.f379a",
        "g": "77ae0818.c9dc48",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "numberoflevel",
                "pt": "global",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 440,
        "y": 340,
        "wires": [
            []
        ]
    },
    {
        "id": "4a811291.104e2c",
        "type": "ui_dropdown",
        "z": "a6098217.f379a",
        "g": "77ae0818.c9dc48",
        "name": "Number of Level",
        "label": "",
        "tooltip": "",
        "place": "Number of Levels",
        "group": "4cc9cd95.16ff14",
        "order": 3,
        "width": 6,
        "height": 4,
        "passthru": true,
        "multiple": false,
        "options": [
            {
                "label": "2 Level",
                "value": 2,
                "type": "num"
            },
            {
                "label": "4 Level",
                "value": 4,
                "type": "num"
            },
            {
                "label": "6 Level",
                "value": 6,
                "type": "num"
            },
            {
                "label": "8 Level",
                "value": 8,
                "type": "num"
            },
            {
                "label": "10 Level",
                "value": 10,
                "type": "num"
            },
            {
                "label": "12 Level",
                "value": 12,
                "type": "num"
            },
            {
                "label": "14 Level",
                "value": 14,
                "type": "num"
            }
        ],
        "payload": "",
        "topic": "",
        "topicType": "str",
        "className": "",
        "x": 180,
        "y": 340,
        "wires": [
            [
                "78e72bd8.ec0b74"
            ]
        ]
    },
    {
        "id": "cc7bed05.bbd98",
        "type": "ui_template",
        "z": "a6098217.f379a",
        "g": "54e0acc4.d07814",
        "group": "4cc9cd95.16ff14",
        "name": "Virtual Keyboard",
        "order": 19,
        "width": 1,
        "height": 1,
        "format": "<script> \n    \n// the semi-colon before function invocation is a safety net against concatenated\n// scripts and/or other plugins which may not be closed properly.\n; (function ($, window, document, undefined) {\n\n    // undefined is used here as the undefined global variable in ECMAScript 3 is\n    // mutable (ie. it can be changed by someone else). undefined isn't really being\n    // passed in so we can ensure the value of it is truly undefined. In ES5, undefined\n    // can no longer be modified.\n\n    // window and document are passed through as local variable rather than global\n    // as this (slightly) quickens the resolution process and can be more efficiently\n    // minified (especially when both are regularly referenced in your plugin).\n\n    // Create the defaults once\n    var pluginName = \"jkeyboard\",\n        defaults = {\n            layout: \"english\",\n            input: $('#input'),\n            customLayouts: {\n                selectable: []\n            },\n        };\n\n\n    var function_keys = {\n        backspace: {\n            text: 'DEL',\n        },\n        return: {\n            text: 'Enter'\n        },\n        shift: {\n            text: 'Shift'\n        },\n        space: {\n            text: 'Space'\n        },\n        numeric_switch: {\n            text: '123',\n            command: function () {\n                this.createKeyboard('numeric');\n                this.events();\n            }\n        },\n        layout_switch: {\n            text: '<i class=\"fa fa-keyboard-o\" aria-hidden=\"true\"></i>',\n            command: function () {\n                var l = this.toggleLayout();\n                this.createKeyboard(l);\n                this.events();\n            }\n        },\n        character_switch: {\n            text: 'ABC',\n            command: function () {\n                this.createKeyboard(layout);\n                this.events();\n            }\n        },\n        symbol_switch: {\n            text: '#+=',\n            command: function () {\n                this.createKeyboard('symbolic');\n                this.events();\n            }\n        }\n    };\n\n\n    var layouts = {\n        selectable: ['azeri', 'english', 'russian','french', 'emoji'],\n        azeri: [\n            ['q', 'ü', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p', 'ö', 'ğ'],\n            ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l', 'ı', 'ə'],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm', 'ç', 'ş', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        english: [\n            ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p',],\n            ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l',],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        russian: [\n            ['й', 'ц', 'у', 'к', 'е', 'н', 'г', 'ш', 'щ', 'з', 'х'],\n            ['ф', 'ы', 'в', 'а', 'п', 'р', 'о', 'л', 'д', 'ж', 'э'],\n            ['shift', 'я', 'ч', 'с', 'м', 'и', 'т', 'ь', 'б', 'ю', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        french: [\n            ['q', 'w', 'e', 'r', 't', 'y', 'u', 'i', 'o', 'p',],\n            ['a', 's', 'd', 'f', 'g', 'h', 'j', 'k', 'l','à','ç'],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm','é','è', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],\n        emoji: [\n            ['😀', '😁', '😂', '🤣', '😃', '😄', '😅', '😆', '😉', '😊',],\n            ['😋', '😎', '😍', '😘', 'g', 'h', 'j', 'k', 'l','à','ç'],\n            ['shift', 'z', 'x', 'c', 'v', 'b', 'n', 'm','é','è', 'backspace'],\n            ['numeric_switch', 'layout_switch', 'space', 'return']\n        ],            \n        numeric: [\n            ['1', '2', '3', '4', '5', '6', '7', '8', '9', '0'],\n            ['-', '/', ':', ';', '(', ')', '$', '&', '@', '\"'],\n            ['symbol_switch', '.', ',', '?', '!', \"'\", 'backspace'],\n            ['character_switch', 'layout_switch', 'space', 'return'],\n        ],\n        numbers_only: [\n            ['1', '2', '3',],\n            ['4', '5', '6',],\n            ['7', '8', '9',],\n            ['0', 'backspace'],\n        ],\n        symbolic: [\n            ['[', ']', '{', '}', '#', '%', '^', '*', '+', '='],\n            ['_', '\\\\', '|', '~', '<', '>'],\n            ['numeric_switch', '.', ',', '?', '!', \"'\", 'backspace'],\n            ['character_switch', 'layout_switch', 'space', 'return'],\n\n        ]\n    }\n\n    var shift = false, capslock = false, layout = 'english', layout_id = 0;\n\n    // The actual plugin constructor\n    function Plugin(element, options) {\n        this.element = element;\n        // jQuery has an extend method which merges the contents of two or\n        // more objects, storing the result in the first object. The first object\n        // is generally empty as we don't want to alter the default options for\n        // future instances of the plugin\n        this.settings = $.extend({}, defaults, options);\n        // Extend & Merge the cusom layouts\n        layouts = $.extend(true, {}, this.settings.customLayouts, layouts);\n        if (Array.isArray(this.settings.customLayouts.selectable)) {\n            $.merge(layouts.selectable, this.settings.customLayouts.selectable);\n        }\n        this._defaults = defaults;\n        this._name = pluginName;\n        this.init();\n    }\n\n    Plugin.prototype = {\n        init: function () {\n            layout = this.settings.layout;\n            this.createKeyboard(layout);\n            this.events();\n        },\n\n        setInput: function (newInputField) {\n            this.settings.input = newInputField;\n        },\n\n        createKeyboard: function (layout) {\n            shift = false;\n            capslock = false;\n\n            var keyboard_container = $('<ul/>').addClass('jkeyboard'),\n                me = this;\n\n            layouts[layout].forEach(function (line, index) {\n                var line_container = $('<li/>').addClass('jline');\n                line_container.append(me.createLine(line));\n                keyboard_container.append(line_container);\n            });\n\n            $(this.element).html('').append(keyboard_container);\n        },\n\n        createLine: function (line) {\n            var line_container = $('<ul/>');\n\n            line.forEach(function (key, index) {\n                var key_container = $('<li/>').addClass('jkey').data('command', key);\n\n                if (function_keys[key]) {\n                    key_container.addClass(key).html(function_keys[key].text);\n                }\n                else {\n                    key_container.addClass('letter').html(key);\n                }\n\n                line_container.append(key_container);\n            })\n\n            return line_container;\n        },\n\n        events: function () {\n            var letters = $(this.element).find('.letter'),\n                shift_key = $(this.element).find('.shift'),\n                space_key = $(this.element).find('.space'),\n                backspace_key = $(this.element).find('.backspace'),\n                return_key = $(this.element).find('.return'),\n\n                me = this,\n                fkeys = Object.keys(function_keys).map(function (k) {\n                    return '.' + k;\n                }).join(',');\n\n            letters.on('click', function () {\n                me.type((shift || capslock) ? $(this).text().toUpperCase() : $(this).text());\n            });\n\n            space_key.on('click', function () {\n                me.type(' ');\n            });\n\n            return_key.on('click', function () {\n                me.type(\"\\n\");\n                me.settings.input.parents('form').submit();\n            });\n\n            backspace_key.on('click', function () {\n                me.backspace();\n            });\n\n            shift_key.on('click', function () {\n                if (capslock) {\n                    me.toggleShiftOff();\n                    capslock = false;\n                } else {\n                    me.toggleShiftOn();\n                }\n            }).on('dblclick', function () {\n                capslock = true;\n            });\n\n\n            $(fkeys).on('click', function () {\n                var command = function_keys[$(this).data('command')].command;\n                if (!command) return;\n\n                command.call(me);\n            });\n        },\n\n        type: function (key) {\n            var input = this.settings.input,\n                val = input.val(),\n                input_node = input.get(0),\n                start = input_node.selectionStart,\n                end = input_node.selectionEnd;\n\n            var max_length = $(input).attr(\"maxlength\");\n            if (start == end && end == val.length) {\n                if (!max_length || val.length < max_length) {\n                    input.val(val + key);\n                    input.change()\n                    $('#vkeyname').text(val + key)\n                }\n            } else {\n                if (input_node.type == \"text\"){\n                    var new_string = this.insertToString(start, end, val, key);\n                    input.val(new_string);\n                    start++;\n                    end = start;\n                    input_node.setSelectionRange(start, end);\n                }else{\n                    input.val(val + key);\n                }\n                input.change()\n                $('#vkeyname').text(val + key)\n                \n            }\n            input.trigger('focus');\n\n            if (shift && !capslock) {\n                this.toggleShiftOff();\n            }\n        },\n\n        backspace: function () {\n            var input = this.settings.input,\n                val = input.val();\n                input_node = input.get(0),\n                start = input_node.selectionStart,\n                end = input_node.selectionEnd;\n            if (input.type == \"text\"){\n                input.val(val.slice(0, start-1) + val.slice(start))\n                input_node.setSelectionRange(start-1, start-1);\n                console.log(val)\n                $('#vkeyname').text(val)\n            }else{\n                input.val(val.slice(0,-1))\n                $('#vkeyname').text(val.slice(0,-1))\n            }\n            input.change()\n            input.focus()\n        },\n\n        toggleShiftOn: function () {\n            var letters = $(this.element).find('.letter'),\n                shift_key = $(this.element).find('.shift');\n\n            letters.addClass('uppercase');\n            shift_key.addClass('active')\n            shift = true;\n        },\n\n        toggleShiftOff: function () {\n            var letters = $(this.element).find('.letter'),\n                shift_key = $(this.element).find('.shift');\n\n            letters.removeClass('uppercase');\n            shift_key.removeClass('active');\n            shift = false;\n        },\n\n        toggleLayout: function () {\n            layout_id = layout_id || 0;\n            var plain_layouts = layouts.selectable;\n            layout_id++;\n\n            var current_id = layout_id % plain_layouts.length;\n            var SelectedLayoutName = plain_layouts[current_id];\n            $('#vkeyname').text('V-Keyboard ' + SelectedLayoutName )\n            return plain_layouts[current_id];\n        },\n\n        insertToString: function (start, end, string, insert_string) {\n            return string.substring(0, start) + insert_string + string.substring(end, string.length);\n        }\n    };\n\n        /*\n\t\t// A really lightweight plugin wrapper around the constructor,\n\t\t// preventing against multiple instantiations\n\t\t$.fn[ pluginName ] = function ( options ) {\n\t\t\t\treturn this.each(function() {\n\t\t\t\t\t\tif ( !$.data( this, \"plugin_\" + pluginName ) ) {\n\t\t\t\t\t\t\t\t$.data( this, \"plugin_\" + pluginName, new Plugin( this, options ) );\n\t\t\t\t\t\t}\n\t\t\t\t});\n\t\t};\n        */\n        var methods = {\n            init: function(options) {\n                if (!this.data(\"plugin_\" + pluginName)) {\n                    this.data(\"plugin_\" + pluginName, new Plugin(this, options));\n                }\n            },\n\t\t\tsetInput: function(content) {\n\t\t\t\tthis.data(\"plugin_\" + pluginName).setInput($(content));\n            },\n            setLayout: function(layoutname) {\n                // change layout if it is not match current\n                object = this.data(\"plugin_\" + pluginName);\n                if (typeof(layouts[layoutname]) !== 'undefined' && object.settings.layout != layoutname) {\n                    object.settings.layout = layoutname;\n                    object.createKeyboard(layoutname);\n                    object.events();\n                };\n            },\n        };\n\n\t\t$.fn[pluginName] = function (methodOrOptions) {\n            if (methods[methodOrOptions]) {\n                return methods[methodOrOptions].apply(this.first(), Array.prototype.slice.call( arguments, 1));\n            } else if (typeof methodOrOptions === 'object' || ! methodOrOptions) {\n                // Default to \"init\"\n                return methods.init.apply(this.first(), arguments);\n            } else {\n                $.error('Method ' +  methodOrOptions + ' does not exist on jQuery.tooltip');\n            }\n        };\n\n})(jQuery, window, document);\n</script>\n<style>\n    .jkeyboard {\n  display: inline-block;\n}\n.jkeyboard, .jkeyboard .jline, .jkeyboard .jline ul {\n  display: block;\n  margin: 0;\n  padding: 0;\n}\n.jkeyboard .jline {\n  text-align: center;\n  margin-left: -14px;\n}\n.jkeyboard .jline ul li {\n  font-family: arial, sans-serif;\n  font-size: 20px;\n  display: inline-block;\n  border: 1px solid #468db3;\n  -webkit-box-shadow: 0 0 3px #468db3;\n  -webkit-box-shadow: inset 0 0 3px #468db3;\n  margin: 5px 0 1px 6px;\n  color: #000000;\n  border-radius: 5px;\n  width: 52px;\n  height: 52px;\n  box-sizing: border-box;\n  text-align: center;\n  line-height: 52px;\n  overflow: hidden;\n  cursor: pointer;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: -moz-none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.jkeyboard .jline ul li.uppercase {\n  text-transform: uppercase;\n}\n.jkeyboard .jline ul li:hover, .jkeyboard .jline ul li:active {\n  background-color: #185a82;\n}\n.jkeyboard .jline .return {\n  width: 80px;\n}\n.jkeyboard .jline .space {\n  width: 366px;\n}\n.jkeyboard .jline .numeric_switch {\n  width: 65px;\n}\n.jkeyboard .jline .layout_switch {\n}\n.jkeyboard .jline .shift {\n  width: 60px;\n}\n.jkeyboard .jline .backspace {\n  width: 69px;\n}\n</style>\n\n\n\n\n<style>\nbody {font-family: Arial, Helvetica, sans-serif;}\n\n.nr-dashboard-theme .nr-dashboard-template .md-button:not(:first-of-type) {\n    margin-top: 0px;\n}\n\n/* The Modal (background) */\n.modal {\n    display: none; /* Hidden by default */\n    position: fixed; /* Stay in place */\n    opacity:0.99;\n    z-index: 100; /* Sit on top */\n    left: 0;\n    top: 0;\n    width: 100%; /* Full width */\n    height: 100%; /* Full height */\n    overflow: auto; /* Enable scroll if needed */\n    background-color: rgb(0,0,0); /* Fallback color */\n    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */\n}\n\n/* Modal Content */\n.modal-content {\n    position: fixed;\n    background-color: #fefefe;\n    margin: auto;\n    padding: 0;\n    bottom: 0%;\n    left: 50%;\n    transform: translate(-50%, 0%);\n    border: 1px solid #888;\n    width: fit-content;\n    max-width: 100%;\n    max-height: 100%;\n    box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);\n    -webkit-animation-name: animate;\n    -webkit-animation-duration: 0.4s;\n    animation-name: animate;\n    animation-duration: 0.4s\n}\n\n/* Add Animation */\n@-webkit-keyframes animate {\n    from {bottom:100%; opacity:0} \n    to {bottom:0%; opacity:1}\n}\n\n@keyframes animate {\n    from {bottom:100%; opacity:0}\n    to {bottom:0%; opacity:1}\n}\n\n/* The Close Button */\n.close {\n    color: black;\n    float: right;\n    font-size: 28px;\n    font-weight: bold;\n}\n\n.close:hover,\n.close:focus {\n    color: #000;\n    text-decoration: none;\n    cursor: pointer;\n}\n\n.modal-header {\n    padding: 2px 16px;\n    background-color: aliceblue;\n    color: white;\n}\n\n.modal-body {padding: 2px 16px;}\n\n.modal-footer {\n    padding: 2px 16px;\n    background-color: #5cb85c;\n    color: white;\n}\n</style>\n\n<!-- The Modal -->\n<div id=\"myModal\" class=\"modal\">\n\n  <!-- Modal content -->\n  <div class=\"modal-content\">\n      <div class=\"modal-header\">\n      <span class=\"close\" onclick=\"closeModal()\">&times;</span>\n      <h2 id=\"vkeyname\" style=\"background-color: aliceblue !important; color: black !important; text-align: center; min-height: 30px;\">V-Keyboard</h2>\n    </div>\n    <div class=\"modal-body\">\n        <div id=\"keyboard\"></div>\n        <div>\n        </div>\n    </div>\n  </div>\n</div>\n\n\n<script>\n    // Get the modal\nvar modal = document.getElementById('myModal');\n\n/*\n$('input[type=text]').click(function () {\n    $('#keyboard').unbind().removeData();\n        $('#keyboard').jkeyboard({\n            layout: \"english\",\n            input: $('#'+$(this).attr('id'))\n    });\n});\n\n$('input[type=number]').click(function () {\n    $('#keyboard').unbind().removeData();\n        $('#keyboard').jkeyboard({\n            layout: \"numbers_only\",\n            input: $('#'+$(this).attr('id'))\n    });\n});\n*/\n\nvar inputTags;\nvar inputType;\n\nvar getinputs = function() {\n    inputTags = document.getElementsByTagName(\"input\");\n    console.log(inputTags)\n    for (var i = 0; i < inputTags.length; i++) {\n        inputTags[i].addEventListener('click', openModal, false)\n    }\n}\n\nsetTimeout(function(){ getinputs(); }, 1000);\n\nvar inputTarget;\n\nvar openModal = function() {\n    inputType = event.target.type\n    inputTarget = event.target\n    var layoutName;\n    if (inputType == \"number\"){\n        //inputTarget.type = \"number\" //hack because chrome doesn't allow setselection in number inputs\n        //inputTarget.value = \"\"\n        layoutName = \"numbers_only\"\n    }else{\n        layoutName = \"english\"\n    }\n    $('#vkeyname').text(event.target.value)\n    $('#keyboard').unbind().removeData();\n    modal.style.display = \"block\";\n    $('#keyboard').jkeyboard({\n        layout: layoutName,\n        input: $('#'+$(this).attr('id'))\n    });\n}\n\n\n// Get the <span> element that closes the modal\nvar span = document.getElementsByClassName(\"close\")[0];\n\n// When the user clicks on <span> (x), close the modal\n//span.onclick = function(event) {\n  //closeModal()\n//}\n\n// When the user clicks anywhere outside of the modal, close it\nwindow.onclick = function(event) {\n    var source = event.target;\n    if (source == modal || source == span) {\n        closeModal(source)\n    }\n};\n\nvar closeModal = function(source){\n    //console.log(\"closing\")\n    modal.style.display = \"none\";\n   \n    if (inputType == \"number\"){\n        inputTarget.type = \"number\" //hack because chrome doesn't allow selectionstart on number inputs\n    }\n}\n\n</script>\n<script>\n\nvar clickState = 1;\nvar btn = document.querySelector('.VK');\n\nbtn.addEventListener('click', function(){\n\n  if (clickState == 0) {\n    this.textContent = 'V-KeyBoard On';\n    modal = document.getElementById('myModal');\n    clickState = 1;\n  } else {\n    this.textContent = 'V-KeyBoard Off';\n    modal = document.getElementById('empty');\n    clickState = 0;\n  }\n\n});\n</script>\n\n<style>\n.VK{\n    position: fixed;\n    top: 60px;\n    right: 20px;\n    height: 30px;\n}\n</style>\n\n<div id=\"empty\"></div>\n<button class=\"VK\">V-KeyBoard On</button> ",
        "storeOutMessages": false,
        "fwdInMessages": false,
        "resendOnRefresh": false,
        "templateScope": "local",
        "className": "",
        "x": 240,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "3abe5dce.856282",
        "type": "comment",
        "z": "a6098217.f379a",
        "g": "54e0acc4.d07814",
        "name": "Home & Template",
        "info": "",
        "x": 170,
        "y": 60,
        "wires": []
    },
    {
        "id": "a2b8192b.cde238",
        "type": "comment",
        "z": "a6098217.f379a",
        "g": "54e0acc4.d07814",
        "name": "CHECK",
        "info": "",
        "x": 390,
        "y": 60,
        "wires": []
    },
    {
        "id": "67ceb623.164d18",
        "type": "comment",
        "z": "a6098217.f379a",
        "g": "77ae0818.c9dc48",
        "name": "Routine Settings",
        "info": "",
        "x": 160,
        "y": 280,
        "wires": []
    },
    {
        "id": "7d4e3174.de9e7",
        "type": "comment",
        "z": "a6098217.f379a",
        "g": "77ae0818.c9dc48",
        "name": "CHECK",
        "info": "",
        "x": 530,
        "y": 280,
        "wires": []
    }
]